[{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/App.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/AuthModal.test.tsx","messages":[{"ruleId":"no-restricted-imports","severity":2,"message":"'../services/authService' import is restricted from being used by a pattern. 游뛂 Dumb components must not call services directly. Receive data via props.","line":3,"column":1,"nodeType":"ImportDeclaration","messageId":"patternWithCustomMessage","endLine":3,"endColumn":55},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":23,"column":5,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":23,"endColumn":18,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[641,654],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":25,"column":5,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":25,"endColumn":18,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[687,700],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":30,"column":5,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":30,"endColumn":18,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[794,807],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { render, screen, fireEvent, waitFor } from '../test-utils';\nimport AuthModal from './AuthModal';\nimport { authService } from '../services/authService';\nimport { describe, it, expect, vi, beforeEach, afterEach, Mock } from 'vitest';\n\n// Mock authService\nvi.mock('../services/authService', () => ({\n    authService: {\n        login: vi.fn(),\n        register: vi.fn(),\n        verify: vi.fn(),\n        googleLogin: vi.fn(),\n    },\n}));\n\nvi.mock('../context/ToastContext', () => ({\n    useToast: vi.fn(() => ({ showToast: vi.fn() }))\n}));\n\n// Mock window.location.reload\nconst originalLocation = window.location;\nbeforeEach(() => {\n    // @ts-ignore\n    delete window.location;\n    // @ts-ignore\n    window.location = { reload: vi.fn() };\n    vi.clearAllMocks();\n});\nafterEach(() => {\n    // @ts-ignore\n    window.location = originalLocation;\n});\n\ndescribe('AuthModal Component', () => {\n    it('should not render when isOpen is false', () => {\n        const handleClose = vi.fn();\n        render(<AuthModal isOpen={false} onClose={handleClose} />);\n        expect(screen.queryByText('Bem-vindo')).toBeNull();\n    });\n\n    it('should render login view by default', () => {\n        const handleClose = vi.fn();\n        render(<AuthModal isOpen={true} onClose={handleClose} />);\n        expect(screen.getByText('Bem-vindo')).toBeInTheDocument();\n        expect(screen.getByPlaceholderText('E-mail')).toBeInTheDocument();\n        expect(screen.getByPlaceholderText('Senha')).toBeInTheDocument();\n        expect(screen.getByText('Entrar')).toBeInTheDocument();\n    });\n\n    it('should switch to register view', () => {\n        const handleClose = vi.fn();\n        render(<AuthModal isOpen={true} onClose={handleClose} />);\n\n        const registerLink = screen.getByText('Cadastre-se');\n        fireEvent.click(registerLink);\n\n        expect(screen.getByRole('heading', { name: 'Criar Conta' })).toBeInTheDocument();\n        expect(screen.getByPlaceholderText('Nome Completo')).toBeInTheDocument();\n        expect(screen.getByRole('button', { name: 'Criar Conta' })).toBeInTheDocument();\n    });\n\n    it('should call login service on form submission', async () => {\n        const handleClose = vi.fn();\n        (authService.login as Mock).mockResolvedValue({ token: 'fake-token' });\n\n        render(<AuthModal isOpen={true} onClose={handleClose} />);\n\n        fireEvent.change(screen.getByPlaceholderText('E-mail'), { target: { value: 'test@example.com' } });\n        fireEvent.change(screen.getByPlaceholderText('Senha'), { target: { value: 'password123' } });\n\n        // Use getByText to avoid issues with icon inside button affecting accessible name\n        const loginButton = screen.getByText('Entrar');\n        fireEvent.click(loginButton);\n\n        await waitFor(() => {\n            expect(authService.login).toHaveBeenCalledWith('test@example.com', 'password123');\n        });\n    });\n\n    it('should display error message on login failure', async () => {\n        const handleClose = vi.fn();\n        (authService.login as Mock).mockRejectedValue(new Error('Invalid credentials'));\n\n        render(<AuthModal isOpen={true} onClose={handleClose} />);\n\n        fireEvent.change(screen.getByPlaceholderText('E-mail'), { target: { value: 'wrong@example.com' } });\n        fireEvent.change(screen.getByPlaceholderText('Senha'), { target: { value: 'wrongpass' } });\n\n        fireEvent.click(screen.getByText('Entrar'));\n\n        await waitFor(() => {\n            expect(screen.getByText('Credenciais inv치lidas.')).toBeInTheDocument();\n        });\n    });\n});\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/AuthModal.tsx","messages":[{"ruleId":"no-restricted-imports","severity":2,"message":"'../services/authService' import is restricted from being used by a pattern. 游뛂 Dumb components must not call services directly. Receive data via props.","line":4,"column":1,"nodeType":"ImportDeclaration","messageId":"patternWithCustomMessage","endLine":4,"endColumn":55},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[466,469],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[466,469],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":98,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":98,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4854,4857],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4854,4857],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":128,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":128,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":143,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":143,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":157,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":157,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":171,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":171,"endColumn":21}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, FormEvent, ChangeEvent } from \"react\";\nimport { X, Mail, Lock, User, Key, Eye, EyeOff, Loader2 } from \"lucide-react\";\nimport { useGoogleLogin, TokenResponse } from \"@react-oauth/google\";\nimport { authService } from \"../services/authService\";\nimport Button from \"./ui/Button\";\nimport { useToast } from \"../context/ToastContext\";\n\ninterface GoogleLoginButtonProps {\n    onSuccess: (tokenResponse: TokenResponse) => void;\n    onError: (error: any) => void;\n    disabled: boolean;\n}\n\n// Componente separado para usar o hook useGoogleLogin com seguran칞a.\nconst GoogleLoginButton: React.FC<GoogleLoginButtonProps> = ({ onSuccess, onError, disabled }) => {\n    const googleLogin = useGoogleLogin({\n        onSuccess,\n        onError,\n    });\n\n    return (\n        <button\n            type=\"button\"\n            onClick={() => googleLogin()}\n            disabled={disabled}\n            className=\"w-full bg-white border border-gray-300 text-gray-700 py-3 font-lato text-xs uppercase tracking-[0.1em] hover:bg-gray-50 transition-all flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed\"\n        >\n            <svg className=\"w-4 h-4 shrink-0\" viewBox=\"0 0 24 24\">\n                <path d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\" fill=\"#4285F4\" />\n                <path d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\" fill=\"#34A853\" />\n                <path d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\" fill=\"#FBBC05\" />\n                <path d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\" fill=\"#EA4335\" />\n            </svg>\n            Entrar com Google\n        </button>\n    );\n};\n\n// Bot칚o fallback quando o Google Client ID n칚o est치 configurado\nconst GoogleLoginButtonDisabled: React.FC = () => (\n    <button\n        type=\"button\"\n        disabled\n        title=\"Configure VITE_GOOGLE_CLIENT_ID no .env para ativar\"\n        className=\"w-full bg-white border border-gray-200 text-gray-400 py-3 font-lato text-xs uppercase tracking-[0.1em] flex items-center justify-center gap-3 cursor-not-allowed opacity-50\"\n    >\n        <svg className=\"w-4 h-4 shrink-0\" viewBox=\"0 0 24 24\">\n            <path d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\" fill=\"#9CA3AF\" />\n            <path d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\" fill=\"#9CA3AF\" />\n            <path d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\" fill=\"#9CA3AF\" />\n            <path d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\" fill=\"#9CA3AF\" />\n        </svg>\n        Google (n칚o configurado)\n    </button>\n);\n\ninterface AuthModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n}\n\ntype AuthView = \"LOGIN\" | \"REGISTER\" | \"VERIFY\" | \"RECOVERY\";\n\nconst GOOGLE_CLIENT_ID = import.meta.env.VITE_GOOGLE_CLIENT_ID || \"\";\n\nconst AuthModal: React.FC<AuthModalProps> = ({ isOpen, onClose }) => {\n    const [view, setView] = useState<AuthView>(\"LOGIN\");\n    const [email, setEmail] = useState<string>(\"\");\n    const [password, setPassword] = useState<string>(\"\");\n    const [name, setName] = useState<string>(\"\");\n    const [code, setCode] = useState<string>(\"\");\n    const [loading, setLoading] = useState<boolean>(false);\n    const [error, setError] = useState<string | null>(null);\n    const [showPassword, setShowPassword] = useState<boolean>(false);\n    const { addToast } = useToast();\n\n    if (!isOpen) return null;\n\n    const handleGoogleSuccess = async (tokenResponse: TokenResponse) => {\n        setLoading(true);\n        try {\n            const res = await fetch(\"https://www.googleapis.com/oauth2/v3/userinfo\", {\n                headers: { Authorization: `Bearer ${tokenResponse.access_token}` },\n            });\n            const userInfo = await res.json();\n            await authService.googleLoginWithUserInfo(userInfo, tokenResponse.access_token);\n            addToast(\"Login realizado com sucesso!\", \"success\");\n            onClose();\n            window.location.reload();\n        } catch (err) {\n            console.error(\"[Google Login] Erro:\", err);\n            addToast(\"Falha ao entrar com Google. Tente novamente.\", \"error\");\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleGoogleError = (err: any) => {\n        console.error(\"[Google Login] Erro OAuth:\", err);\n        addToast(\"Falha ao autenticar com Google. Tente novamente.\", \"error\");\n    };\n\n    const resetState = () => {\n        setView(\"LOGIN\");\n        setEmail(\"\");\n        setPassword(\"\");\n        setName(\"\");\n        setCode(\"\");\n        setLoading(false);\n        setError(null);\n        setShowPassword(false);\n    };\n\n    const handleClose = () => {\n        resetState();\n        onClose();\n    };\n\n    const handleLogin = async (e: FormEvent) => {\n        e.preventDefault();\n        setLoading(true);\n        try {\n            setError(null);\n            await authService.login(email, password);\n            addToast(\"Bem-vindo de volta!\", \"success\");\n            handleClose();\n            window.location.reload();\n        } catch (err) {\n            setError(\"E-mail ou senha incorretos.\");\n            addToast(\"E-mail ou senha incorretos.\", \"error\");\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleRegister = async (e: FormEvent) => {\n        e.preventDefault();\n        setLoading(true);\n        try {\n            await authService.register({ name, email, password });\n            addToast(\"C칩digo de verifica칞칚o enviado para seu e-mail.\", \"success\");\n            setView(\"VERIFY\");\n        } catch (err) {\n            addToast(\"Erro ao cadastrar. Verifique os dados ou tente outro e-mail.\", \"error\");\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleVerify = async (e: FormEvent) => {\n        e.preventDefault();\n        setLoading(true);\n        try {\n            await authService.verify(email, code);\n            addToast(\"Conta verificada com sucesso! Fa칞a login para continuar.\", \"success\");\n            setView(\"LOGIN\");\n        } catch (err) {\n            addToast(\"C칩digo de verifica칞칚o inv치lido ou expirado.\", \"error\");\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleRequestReset = async (e: FormEvent) => {\n        e.preventDefault();\n        setLoading(true);\n        try {\n            await authService.requestPasswordReset(email);\n            addToast(\"Instru칞칫es enviadas para seu e-mail.\", \"success\");\n            setView(\"LOGIN\");\n        } catch (err) {\n            addToast(\"N칚o encontramos uma conta com este e-mail.\", \"error\");\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <div className=\"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-[#0f2A44]/60 backdrop-blur-sm\">\n            <div className=\"bg-[#F7F7F4] w-full max-w-md overflow-hidden relative shadow-2xl rounded-sm\">\n                <button\n                    onClick={handleClose}\n                    className=\"absolute top-4 right-4 text-[#0f2A44]/40 hover:text-[#0f2A44] transition-colors\"\n                >\n                    <X size={20} />\n                </button>\n\n                <div className=\"p-8 md:p-10\">\n                    <div className=\"text-center mb-8\">\n                        <h2 className=\"font-playfair text-3xl text-[#0f2A44] mb-2\">\n                            {view === \"LOGIN\" && \"Bem-vindo\"}\n                            {view === \"REGISTER\" && \"Criar Conta\"}\n                            {view === \"VERIFY\" && \"Verifica칞칚o\"}\n                            {view === \"RECOVERY\" && \"Recupera칞칚o\"}\n                        </h2>\n                        <p className=\"font-lato text-[10px] uppercase tracking-[0.2em] text-[#C9A24D]\">\n                            {view === \"LOGIN\" && \"Entre na sua conta para continuar\"}\n                            {view === \"REGISTER\" && \"Cadastre-se para aproveitar ofertas\"}\n                            {view === \"VERIFY\" && `C칩digo enviado para ${email}`}\n                            {view === \"RECOVERY\" && \"Informe seu e-mail para recuperar o acesso\"}\n                        </p>\n                    </div>\n\n                    {/* VIEW: LOGIN */}\n                    {view === \"LOGIN\" && (\n                        <form onSubmit={handleLogin} className=\"space-y-5\">\n                            <div>\n                                <div className=\"relative\">\n                                    <Mail className=\"absolute left-3 top-1/2 -translate-y-1/2 text-[#0f2A44]/30\" size={16} />\n                                    <input\n                                        type=\"email\"\n                                        required\n                                        value={email}\n                                        onChange={(e: ChangeEvent<HTMLInputElement>) => setEmail(e.target.value)}\n                                        className=\"w-full bg-white border border-[#0f2A44]/10 py-3 pl-10 pr-4 text-sm focus:border-[#C9A24D] outline-none transition-colors\"\n                                        placeholder=\"E-mail\"\n                                    />\n                                </div>\n                            </div>\n                            <div>\n                                <div className=\"relative\">\n                                    <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 text-[#0f2A44]/30\" size={16} />\n                                    <input\n                                        type={showPassword ? \"text\" : \"password\"}\n                                        required\n                                        value={password}\n                                        onChange={(e: ChangeEvent<HTMLInputElement>) => setPassword(e.target.value)}\n                                        className=\"w-full bg-white border border-[#0f2A44]/10 py-3 pl-10 pr-12 text-sm focus:border-[#C9A24D] outline-none transition-colors\"\n                                        placeholder=\"Senha\"\n                                    />\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => setShowPassword(!showPassword)}\n                                        className=\"absolute right-3 top-1/2 -translate-y-1/2 text-[#0f2A44]/30 hover:text-[#C9A24D] transition-colors\"\n                                    >\n                                        {showPassword ? <EyeOff size={16} /> : <Eye size={16} />}\n                                    </button>\n                                </div>\n                            </div>\n\n                            <div className=\"flex justify-end\">\n                                <span onClick={() => { setView(\"RECOVERY\"); setError(null); }} className=\"text-[11px] text-[#C9A24D] cursor-pointer hover:underline font-lato\">Esqueci minha senha</span>\n                            </div>\n\n                            {error && <p className=\"text-red-600 text-[11px] font-lato italic\">{error}</p>}\n\n                            <Button\n                                type=\"submit\"\n                                isLoading={loading}\n                                className=\"w-full py-4\"\n                            >\n                                Entrar\n                            </Button>\n\n                            <div className=\"relative flex py-2 items-center\">\n                                <div className=\"flex-grow border-t border-gray-200\"></div>\n                                <span className=\"flex-shrink-0 mx-4 text-gray-400 text-xs\">OU</span>\n                                <div className=\"flex-grow border-t border-gray-200\"></div>\n                            </div>\n\n                            {GOOGLE_CLIENT_ID ? (\n                                <GoogleLoginButton\n                                    onSuccess={handleGoogleSuccess}\n                                    onError={handleGoogleError}\n                                    disabled={loading}\n                                />\n                            ) : (\n                                <GoogleLoginButtonDisabled />\n                            )}\n\n                            <div className=\"mt-4 text-center\">\n                                <p className=\"font-lato text-[11px] text-[#0f2A44]/40\">\n                                    Ainda n칚o tem conta?{\" \"}\n                                    <span onClick={() => { setView(\"REGISTER\"); setError(null); }} className=\"text-[#C9A24D] cursor-pointer hover:underline\">\n                                        Cadastre-se\n                                    </span>\n                                </p>\n                            </div>\n                        </form>\n                    )}\n\n                    {/* VIEW: REGISTER */}\n                    {view === \"REGISTER\" && (\n                        <form onSubmit={handleRegister} className=\"space-y-5\">\n                            <div>\n                                <div className=\"relative\">\n                                    <User className=\"absolute left-3 top-1/2 -translate-y-1/2 text-[#0f2A44]/30\" size={16} />\n                                    <input\n                                        type=\"text\"\n                                        required\n                                        value={name}\n                                        onChange={(e: ChangeEvent<HTMLInputElement>) => setName(e.target.value)}\n                                        className=\"w-full bg-white border border-[#0f2A44]/10 py-3 pl-10 pr-4 text-sm focus:border-[#C9A24D] outline-none transition-colors\"\n                                        placeholder=\"Nome Completo\"\n                                    />\n                                </div>\n                            </div>\n                            <div>\n                                <div className=\"relative\">\n                                    <Mail className=\"absolute left-3 top-1/2 -translate-y-1/2 text-[#0f2A44]/30\" size={16} />\n                                    <input\n                                        type=\"email\"\n                                        required\n                                        value={email}\n                                        onChange={(e: ChangeEvent<HTMLInputElement>) => setEmail(e.target.value)}\n                                        className=\"w-full bg-white border border-[#0f2A44]/10 py-3 pl-10 pr-4 text-sm focus:border-[#C9A24D] outline-none transition-colors\"\n                                        placeholder=\"E-mail\"\n                                    />\n                                </div>\n                            </div>\n                            <div>\n                                <div className=\"relative\">\n                                    <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 text-[#0f2A44]/30\" size={16} />\n                                    <input\n                                        type={showPassword ? \"text\" : \"password\"}\n                                        required\n                                        value={password}\n                                        onChange={(e: ChangeEvent<HTMLInputElement>) => setPassword(e.target.value)}\n                                        className=\"w-full bg-white border border-[#0f2A44]/10 py-3 pl-10 pr-12 text-sm focus:border-[#C9A24D] outline-none transition-colors\"\n                                        placeholder=\"Senha\"\n                                    />\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => setShowPassword(!showPassword)}\n                                        className=\"absolute right-3 top-1/2 -translate-y-1/2 text-[#0f2A44]/30 hover:text-[#C9A24D] transition-colors\"\n                                    >\n                                        {showPassword ? <EyeOff size={16} /> : <Eye size={16} />}\n                                    </button>\n                                </div>\n                            </div>\n\n                            {error && <p className=\"text-red-600 text-[11px] font-lato italic\">{error}</p>}\n\n                            <button\n                                type=\"submit\"\n                                disabled={loading}\n                                className=\"w-full bg-[#0f2A44] text-white py-4 font-lato text-xs uppercase tracking-[0.2em] hover:bg-[#C9A24D] transition-all flex items-center justify-center gap-2\"\n                            >\n                                {loading ? <Loader2 size={16} className=\"animate-spin\" /> : \"Criar Conta\"}\n                            </button>\n\n                            <div className=\"mt-4 text-center\">\n                                <p className=\"font-lato text-[11px] text-[#0f2A44]/40\">\n                                    J치 tem conta?{\" \"}\n                                    <span onClick={() => setView(\"LOGIN\")} className=\"text-[#C9A24D] cursor-pointer hover:underline\">\n                                        Fazer Login\n                                    </span>\n                                </p>\n                            </div>\n                        </form>\n                    )}\n\n                    {/* VIEW: VERIFY */}\n                    {view === \"VERIFY\" && (\n                        <form onSubmit={handleVerify} className=\"space-y-5\">\n                            <div className=\"text-center mb-4\">\n                                <p className=\"text-sm text-gray-600 mb-2\">Digite o c칩digo de 6 d칤gitos:</p>\n                            </div>\n                            <div>\n                                <div className=\"relative\">\n                                    <Key className=\"absolute left-3 top-1/2 -translate-y-1/2 text-[#0f2A44]/30\" size={16} />\n                                    <input\n                                        type=\"text\"\n                                        required\n                                        maxLength={6}\n                                        value={code}\n                                        onChange={(e: ChangeEvent<HTMLInputElement>) => setCode(e.target.value)}\n                                        className=\"w-full bg-white border border-[#0f2A44]/10 py-3 pl-10 pr-4 text-sm focus:border-[#C9A24D] outline-none transition-colors tracking-widest text-center text-lg\"\n                                        placeholder=\"000000\"\n                                    />\n                                </div>\n                            </div>\n\n                            {error && <p className=\"text-red-600 text-[11px] font-lato italic\">{error}</p>}\n\n                            <button\n                                type=\"submit\"\n                                disabled={loading}\n                                className=\"w-full bg-[#0f2A44] text-white py-4 font-lato text-xs uppercase tracking-[0.2em] hover:bg-[#C9A24D] transition-all flex items-center justify-center gap-2\"\n                            >\n                                {loading ? <Loader2 size={16} className=\"animate-spin\" /> : \"Verificar E-mail\"}\n                            </button>\n                            <div className=\"mt-4 text-center\">\n                                <p\n                                    className=\"font-lato text-[11px] text-[#0f2A44]/40 cursor-pointer hover:underline\"\n                                    onClick={() => setView(\"REGISTER\")}\n                                >\n                                    Voltar\n                                </p>\n                            </div>\n                        </form>\n                    )}\n\n                    {/* VIEW: RECOVERY */}\n                    {view === \"RECOVERY\" && (\n                        <form onSubmit={handleRequestReset} className=\"space-y-5\">\n                            <div className=\"text-center mb-4\">\n                                <p className=\"text-sm text-gray-600 mb-2\">Informe seu e-mail para receber o link de recupera칞칚o:</p>\n                            </div>\n                            <div>\n                                <div className=\"relative\">\n                                    <Mail className=\"absolute left-3 top-1/2 -translate-y-1/2 text-[#0f2A44]/30\" size={16} />\n                                    <input\n                                        type=\"email\"\n                                        required\n                                        value={email}\n                                        onChange={(e: ChangeEvent<HTMLInputElement>) => setEmail(e.target.value)}\n                                        className=\"w-full bg-white border border-[#0f2A44]/10 py-3 pl-10 pr-4 text-sm focus:border-[#C9A24D] outline-none transition-colors\"\n                                        placeholder=\"Seu e-mail cadastrado\"\n                                    />\n                                </div>\n                            </div>\n\n                            {error && <p className=\"text-red-600 text-[11px] font-lato italic\">{error}</p>}\n\n                            <button\n                                type=\"submit\"\n                                disabled={loading}\n                                className=\"w-full bg-[#0f2A44] text-white py-4 font-lato text-xs uppercase tracking-[0.2em] hover:bg-[#C9A24D] transition-all flex items-center justify-center gap-2\"\n                            >\n                                {loading ? <Loader2 size={16} className=\"animate-spin\" /> : \"Enviar Recupera칞칚o\"}\n                            </button>\n                            <div className=\"mt-4 text-center\">\n                                <p\n                                    className=\"font-lato text-[11px] text-[#0f2A44]/40 cursor-pointer hover:underline\"\n                                    onClick={() => setView(\"LOGIN\")}\n                                >\n                                    Voltar para o Login\n                                </p>\n                            </div>\n                        </form>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default AuthModal;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/CartDrawer.tsx","messages":[{"ruleId":"no-restricted-imports","severity":2,"message":"'../services/cartService' import is restricted from being used by a pattern. 游뛂 Dumb components must not call services directly. Receive data via props.","line":4,"column":1,"nodeType":"ImportDeclaration","messageId":"patternWithCustomMessage","endLine":4,"endColumn":55},{"ruleId":"no-restricted-imports","severity":2,"message":"'../services/orderService' import is restricted from being used by a pattern. 游뛂 Dumb components must not call services directly. Receive data via props.","line":5,"column":1,"nodeType":"ImportDeclaration","messageId":"patternWithCustomMessage","endLine":5,"endColumn":57},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[858,861],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[858,861],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":22,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[931,934],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[931,934],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, ChangeEvent } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { X, Trash2, ShoppingBag, ArrowRight } from 'lucide-react';\nimport { cartService } from '../services/cartService';\nimport { orderService } from '../services/orderService';\nimport { getImageUrl } from '../utils/imageUtils';\nimport Button from './ui/Button';\nimport { useToast } from '../context/ToastContext';\nimport { CartItem } from '../types';\n\ninterface CartDrawerProps {\n    isOpen: boolean;\n    onClose: () => void;\n    cartItems: CartItem[];\n    onUpdateCart: (cart: { items: CartItem[] }) => void;\n}\n\nconst CartDrawer: React.FC<CartDrawerProps> = ({ isOpen, onClose, cartItems, onUpdateCart }) => {\n    const navigate = useNavigate();\n    const [cep, setCep] = useState<string>('');\n    const [shippingOptions, setShippingOptions] = useState<any[]>([]);\n    const [shippingSelected, setShippingSelected] = useState<any | null>(null);\n    const { addToast } = useToast();\n    const [calculateLoading, setCalculateLoading] = useState<boolean>(false);\n    const [shippingError, setShippingError] = useState<string | null>(null);\n\n    const subtotal = cartItems.reduce((acc, item) => acc + (item.price * item.quantity), 0);\n\n    const handleCalculateShipping = async () => {\n        if (cep.length < 9) return;\n        setCalculateLoading(true);\n        setShippingError(null);\n        try {\n            const options = await orderService.calculateShipping(cep, cartItems);\n            setShippingOptions(options);\n            if (options.length === 0) {\n                addToast(\"Nenhuma op칞칚o de frete dispon칤vel para este CEP.\", \"info\");\n            }\n        } catch (error) {\n            console.error('Erro ao calcular frete:', error);\n            setShippingError('N칚o foi poss칤vel calcular o frete para este CEP.');\n            setShippingOptions([]);\n            addToast(\"Erro ao calcular frete. Tente novamente.\", \"error\");\n        } finally {\n            setCalculateLoading(false);\n        }\n    };\n\n    const removeItem = async (id: string) => {\n        const updatedCart = await cartService.remove(id);\n        onUpdateCart({ items: updatedCart });\n    };\n\n    const updateQuantity = async (id: string, newQty: number) => {\n        if (newQty < 1) return;\n        const updatedCart = await cartService.updateQuantity(id, newQty);\n        onUpdateCart({ items: updatedCart });\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <div className=\"fixed inset-0 z-[150] overflow-hidden\">\n            <div className=\"absolute inset-0 bg-[#0f2A44]/40 backdrop-blur-sm transition-opacity\" onClick={onClose} />\n\n            <div className=\"absolute inset-y-0 right-0 max-w-full flex\">\n                <div className=\"w-screen max-w-md bg-[#F7F7F4] shadow-2xl flex flex-col\">\n                    <div className=\"px-6 py-8 border-b border-[#0f2A44]/5 flex items-center justify-between\">\n                        <h2 className=\"font-playfair text-2xl text-[#0f2A44]\">Sua Sacola</h2>\n                        <button onClick={onClose} className=\"text-[#0f2A44]/40 hover:text-[#0f2A44]\">\n                            <X size={24} />\n                        </button>\n                    </div>\n\n                    <div className=\"flex-1 overflow-y-auto px-6 py-4\">\n                        {cartItems.length === 0 ? (\n                            <div className=\"h-full flex flex-col items-center justify-center text-center\">\n                                <ShoppingBag size={48} className=\"text-[#0f2A44]/10 mb-4\" />\n                                <p className=\"font-lato text-sm text-[#0f2A44]/50 uppercase tracking-widest\">Sua sacola est치 vazia</p>\n                            </div>\n                        ) : (\n                            <div className=\"space-y-6\">\n                                {cartItems.map((item) => (\n                                    <div key={item.id} className=\"flex gap-4 group\">\n                                        <div className=\"w-20 h-24 bg-white flex-shrink-0 overflow-hidden\">\n                                            <img\n                                                src={getImageUrl(item.image || '')}\n                                                alt={item.name}\n                                                className=\"w-full h-full object-cover\"\n                                                onError={(e: React.SyntheticEvent<HTMLImageElement, Event>) => { e.currentTarget.src = '/images/default.png'; }}\n                                            />\n                                        </div>\n                                        <div className=\"flex-1 flex flex-col\">\n                                            <h3 className=\"font-playfair text-[#0f2A44] text-sm mb-1\">{item.name}</h3>\n                                            <p className=\"font-lato text-xs text-[#C9A24D] mb-3\">\n                                                {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(item.price)}\n                                            </p>\n                                            <div className=\"flex items-center justify-between mt-auto\">\n                                                <div className=\"flex items-center border border-[#0f2A44]/10 bg-white\">\n                                                    <button onClick={() => updateQuantity(item.id, item.quantity - 1)} className=\"px-2 py-1 text-[#0f2A44]\">-</button>\n                                                    <span className=\"px-2 text-xs font-lato\">{item.quantity}</span>\n                                                    <button onClick={() => updateQuantity(item.id, item.quantity + 1)} className=\"px-2 py-1 text-[#0f2A44]\">+</button>\n                                                </div>\n                                                <button onClick={() => removeItem(item.id)} className=\"text-[#0f2A44]/30 hover:text-red-800 transition-colors\">\n                                                    <Trash2 size={16} />\n                                                </button>\n                                            </div>\n                                        </div>\n                                    </div>\n                                ))}\n                            </div>\n                        )}\n                    </div>\n\n                    {cartItems.length > 0 && (\n                        <div className=\"px-6 py-6 bg-white border-t border-[#0f2A44]/5 space-y-6\">\n                            {/* C치lculo de Frete */}\n                            <div className=\"space-y-3\">\n                                <div className=\"flex items-center justify-between\">\n                                    <span className=\"font-lato text-[10px] uppercase tracking-[0.2em] text-[#0f2A44]/60\">Calcular Frete</span>\n                                    {shippingOptions.length > 0 && (\n                                        <button onClick={() => { setCep(''); setShippingOptions([]); setShippingSelected(null); }} className=\"text-[9px] uppercase text-[#C9A24D]\">Limpar</button>\n                                    )}\n                                </div>\n                                <div className=\"flex gap-2\">\n                                    <input\n                                        type=\"text\"\n                                        placeholder=\"00000-000\"\n                                        value={cep}\n                                        onChange={(e: ChangeEvent<HTMLInputElement>) => setCep(e.target.value.replace(/\\D/g, '').replace(/(\\d{5})(\\d)/, '$1-$2').substring(0, 9))}\n                                        className=\"flex-1 border border-[#0f2A44]/10 px-3 py-2 font-lato text-xs focus:border-[#C9A24D] outline-none\"\n                                    />\n                                    <Button\n                                        onClick={handleCalculateShipping}\n                                        isLoading={calculateLoading}\n                                        disabled={cep.length < 9}\n                                        className=\"px-4 py-2\"\n                                    >\n                                        Calcular\n                                    </Button>\n                                </div>\n\n                                {shippingError && <p className=\"text-red-500 text-[10px] font-lato\">{shippingError}</p>}\n\n                                {shippingOptions.length > 0 && (\n                                    <div className=\"space-y-2 pt-2\">\n                                        {shippingOptions.map((opt, i) => (\n                                            <label key={i} className={`flex items-center justify-between p-3 border cursor-pointer transition-all ${shippingSelected?.provider === opt.provider ? 'border-[#C9A24D] bg-[#C9A24D]/5' : 'border-[#0f2A44]/5'}`}>\n                                                <div className=\"flex items-center gap-3\">\n                                                    <input\n                                                        type=\"radio\"\n                                                        name=\"shipping\"\n                                                        className=\"hidden\"\n                                                        checked={shippingSelected?.provider === opt.provider}\n                                                        onChange={() => setShippingSelected(opt)}\n                                                    />\n                                                    <div className=\"flex flex-col\">\n                                                        <span className=\"font-lato text-[10px] font-bold uppercase\">{opt.provider}</span>\n                                                        <span className=\"font-lato text-[9px] text-[#0f2A44]/40\">{opt.days} dias 칰teis</span>\n                                                    </div>\n                                                </div>\n                                                <span className=\"font-lato text-xs font-bold text-[#0f2A44]\">\n                                                    {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(opt.price)}\n                                                </span>\n                                            </label>\n                                        ))}\n                                    </div>\n                                )}\n                            </div>\n\n                            <div className=\"border-t border-[#0f2A44]/5 pt-6 space-y-2\">\n                                <div className=\"flex justify-between\">\n                                    <span className=\"font-lato text-[10px] uppercase tracking-[0.2em] text-[#0f2A44]/60\">Subtotal</span>\n                                    <span className=\"font-lato text-xs text-[#0f2A44]\">\n                                        {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(subtotal)}\n                                    </span>\n                                </div>\n                                {shippingSelected && (\n                                    <div className=\"flex justify-between\">\n                                        <span className=\"font-lato text-[10px] uppercase tracking-[0.2em] text-[#0f2A44]/60\">Frete ({shippingSelected.provider})</span>\n                                        <span className=\"font-lato text-xs text-[#0f2A44]\">\n                                            {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(shippingSelected.price)}\n                                        </span>\n                                    </div>\n                                )}\n                                <div className=\"flex justify-between pt-2\">\n                                    <span className=\"font-lato text-[10px] uppercase tracking-[0.2em] font-bold text-[#0f2A44]\">Total</span>\n                                    <span className=\"font-lato font-bold text-[#0f2A44] text-lg\">\n                                        {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(subtotal + (shippingSelected?.price || 0))}\n                                    </span>\n                                </div>\n                            </div>\n\n                            <Button\n                                onClick={() => {\n                                    onClose();\n                                    navigate('/checkout', { state: { shippingSelected, cep } });\n                                }}\n                                className=\"w-full py-4 group\"\n                            >\n                                Finalizar Compra\n                                <ArrowRight size={16} className=\"group-hover:translate-x-1 transition-transform\" />\n                            </Button>\n                        </div>\n                    )}\n\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default CartDrawer;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/FilterSidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/Footer.tsx","messages":[{"ruleId":"no-restricted-imports","severity":2,"message":"'../services/marketingService' import is restricted from being used by a pattern. 游뛂 Dumb components must not call services directly. Receive data via props.","line":4,"column":1,"nodeType":"ImportDeclaration","messageId":"patternWithCustomMessage","endLine":4,"endColumn":61},{"ruleId":"no-restricted-imports","severity":2,"message":"'../services/authService' import is restricted from being used by a pattern. 游뛂 Dumb components must not call services directly. Receive data via props.","line":5,"column":1,"nodeType":"ImportDeclaration","messageId":"patternWithCustomMessage","endLine":5,"endColumn":55},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":42,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1789,1792],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1789,1792],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Phone, Mail, Instagram, Video, Youtube, ShoppingBag, Heart, Send, Loader2 } from 'lucide-react';\nimport marketingService from '../services/marketingService';\nimport { authService } from '../services/authService';\nimport { User } from '../types';\n\nconst Footer: React.FC = () => {\n    const currentYear = new Date().getFullYear();\n    const [loading, setLoading] = useState<boolean>(false);\n    const [subscribed, setSubscribed] = useState<boolean>(false);\n    const [message, setMessage] = useState<string>('');\n    const [user, setUser] = useState<User | null>(null);\n\n    useEffect(() => {\n        const initUser = () => setUser(authService.getUser());\n        initUser();\n        window.addEventListener('auth-changed', initUser);\n        return () => window.removeEventListener('auth-changed', initUser);\n    }, []);\n\n    const handleSubscribe = async (e: React.MouseEvent | React.FormEvent) => {\n        e.preventDefault();\n        if (!user) {\n            window.dispatchEvent(new CustomEvent('show-alert', {\n                detail: \"Voc칡 precisa estar logado para receber cupons exclusivos e novidades!\"\n            }));\n            window.dispatchEvent(new Event('open-auth-modal'));\n            return;\n        }\n\n        setLoading(true);\n        try {\n            const response = await marketingService.subscribeNewsletter();\n            setMessage(response.message || \"Bem-vindo(a)  nossa Newsletter!\");\n            setSubscribed(true);\n\n            // Feedback visual adicional para premium feel\n            window.dispatchEvent(new CustomEvent('show-alert', {\n                detail: \"Sucesso! Verifique seu e-mail para novidades.\"\n            }));\n        } catch (err: any) {\n            console.error(\"Erro ao assinar:\", err);\n            window.dispatchEvent(new CustomEvent('show-alert', {\n                detail: err.message || \"Erro ao assinar newsletter\"\n            }));\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <footer className=\"bg-[var(--azul-profundo)] text-[var(--branco-off-white)] pt-16 pb-8 border-t border-[var(--dourado-suave)]/20\">\n            <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n                <div className=\"grid grid-cols-1 md:grid-cols-4 gap-12 mb-16\">\n\n                    {/* Coluna 1: Branding & Miss칚o */}\n                    <div className=\"space-y-6\">\n                        <h2 className=\"font-playfair text-2xl leading-tight\">\n                            Ateli칡 <br />\n                            <span className=\"text-[var(--dourado-suave)] text-sm font-lato uppercase tracking-[0.2em]\">Filhos de Aruanda</span>\n                        </h2>\n                        <p className=\"font-lato text-sm text-[var(--branco-off-white)]/70 leading-relaxed\">\n                            Espiritualidade com ax칠, cuidado e prop칩sito. Produtos artesanais feitos com f칠 e consci칡ncia para iluminar o seu caminhar.\n                        </p>\n\n                        {/* Newsletter Integrada - Vers칚o Chamativa */}\n                        <div className=\"pt-2 bg-[var(--azul-profundo)]/40 p-4 rounded-lg border border-[var(--dourado-suave)]/10\">\n                            <p className=\"font-playfair text-sm text-[var(--dourado-suave)] mb-1 italic\">Quer ganhar descontos?</p>\n                            <p className=\"font-lato text-[11px] uppercase tracking-widest text-[var(--branco-off-white)]/80 mb-4\">Receba novidades & cupons!</p>\n\n                            {subscribed ? (\n                                <div className=\"flex items-center gap-2 text-green-400 font-lato text-xs animate-in fade-in slide-in-from-bottom-2 duration-500\">\n                                    <div className=\"w-6 h-6 rounded-full bg-green-400/10 flex items-center justify-center\">\n                                        <Send size={12} />\n                                    </div>\n                                    {message}\n                                </div>\n                            ) : (\n                                <button\n                                    onClick={handleSubscribe}\n                                    disabled={loading}\n                                    className=\"w-full group relative overflow-hidden bg-gradient-to-r from-[var(--dourado-suave)] to-[#b8860b] hover:from-[#b8860b] hover:to-[var(--dourado-suave)] text-[var(--azul-profundo)] py-3 px-4 text-[10px] font-bold uppercase tracking-[0.2em] transition-all duration-300 shadow-[0_4px_15px_rgba(212,175,55,0.2)] hover:shadow-[0_6px_20px_rgba(212,175,55,0.4)] hover:-translate-y-0.5\"\n                                >\n                                    <div className=\"absolute inset-0 bg-white/20 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700 ease-in-out\"></div>\n                                    <div className=\"flex items-center justify-center gap-2 relative z-10\">\n                                        {loading ? (\n                                            <Loader2 size={16} className=\"animate-spin\" />\n                                        ) : (\n                                            <Mail size={16} className=\"group-hover:scale-110 transition-transform\" />\n                                        )}\n                                        <span className=\"font-lato\">Quero Novidades e Cupons</span>\n                                    </div>\n                                </button>\n                            )}\n                            {!user && !subscribed && (\n                                <p className=\"text-[9px] font-lato text-[var(--branco-off-white)]/40 mt-2 text-center italic\">* Exclusivo para membros logados</p>\n                            )}\n                        </div>\n                    </div>\n\n                    {/* Coluna 2: Navega칞칚o R치pida (Ajustada para rotas do site) */}\n                    <div>\n                        <h3 className=\"font-playfair text-lg mb-6 border-b border-[var(--dourado-suave)]/30 pb-2 inline-block\">Navega칞칚o</h3>\n                        <ul className=\"space-y-3 font-lato text-sm text-[var(--branco-off-white)]/70\">\n                            <li><Link to=\"/store?categoria=velas\" className=\"hover:text-[var(--dourado-suave)] transition-colors\">Velas Artesanais</Link></li>\n                            <li><Link to=\"/store?categoria=guias\" className=\"hover:text-[var(--dourado-suave)] transition-colors\">Guias e Braj치s</Link></li>\n                            <li><Link to=\"/store?categoria=ervas\" className=\"hover:text-[var(--dourado-suave)] transition-colors\">Ervas & Defuma칞칚o</Link></li>\n                            <li><Link to=\"/about\" className=\"hover:text-[var(--dourado-suave)] transition-colors\">Nossa Hist칩ria</Link></li>\n                            <li><Link to=\"/contato\" className=\"hover:text-[var(--dourado-suave)] transition-colors\">Fale Conosco</Link></li>\n                        </ul>\n                    </div>\n\n                    {/* Coluna 3: Suporte */}\n                    <div>\n                        <h3 className=\"font-playfair text-lg mb-6 border-b border-[var(--dourado-suave)]/30 pb-2 inline-block\">Suporte</h3>\n                        <ul className=\"space-y-3 font-lato text-sm text-[var(--branco-off-white)]/70\">\n                            <li><Link to=\"/ethics\" className=\"hover:text-[var(--dourado-suave)] transition-colors\">칄tica & Valores</Link></li>\n                            <li><Link to=\"/politicas-de-envio\" className=\"hover:text-[var(--dourado-suave)] transition-colors\">Pol칤ticas de Envio</Link></li>\n                            <li><Link to=\"/trocas-e-devolucoes\" className=\"hover:text-[var(--dourado-suave)] transition-colors\">Trocas e Devolu칞칫es</Link></li>\n                            <li><Link to=\"/faq\" className=\"hover:text-[var(--dourado-suave)] transition-colors\">Perguntas Frequentes</Link></li>\n                            <li><Link to=\"/termos\" className=\"hover:text-[var(--dourado-suave)] transition-colors\">Termos de Uso</Link></li>\n                        </ul>\n                    </div>\n\n                    {/* Coluna 4: Contato */}\n                    <div className=\"space-y-6\">\n                        <div>\n                            <h3 className=\"font-playfair text-lg mb-6 border-b border-[var(--dourado-suave)]/30 pb-2 inline-block\">Contato</h3>\n                            <ul className=\"space-y-4 font-lato text-sm text-[var(--branco-off-white)]/70\">\n                                <li className=\"flex items-center gap-4\">\n                                    <Phone size={18} className=\"text-[var(--dourado-suave)] shrink-0 mt-0.5\" />\n                                    <div className=\"flex flex-col space-y-1\">\n                                        <span>(11) 96321-2172</span>\n                                        <span>(11) 95348-2232</span>\n                                    </div>\n                                </li>\n                                <li className=\"flex items-center gap-4\">\n                                    <Mail size={18} className=\"text-[var(--dourado-suave)] shrink-0\" />\n                                    <span>mundodearuanda@gmail.com</span>\n                                </li>\n                            </ul>\n                        </div>\n\n                        {/* Redes Sociais com Hover */}\n                        <div>\n                            <p className=\"font-lato text-[10px] uppercase tracking-widest text-[var(--dourado-suave)] mb-4\">REDES SOCIAIS</p>\n                            <div className=\"flex gap-4\">\n                                <a href=\"https://www.instagram.com/atelie_filhosdearuanda/\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"w-10 h-10 rounded-full border border-white/10 flex items-center justify-center hover:bg-[var(--dourado-suave)] hover:border-[var(--dourado-suave)] transition-all duration-300 group\">\n                                    <Instagram size={18} className=\"group-hover:text-[var(--azul-profundo)]\" />\n                                </a>\n                                <a href=\"https://www.tiktok.com/@atelie_filhos_de_aruanda\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"w-10 h-10 rounded-full border border-white/10 flex items-center justify-center hover:bg-[var(--dourado-suave)] hover:border-[var(--dourado-suave)] transition-all duration-300 group\">\n                                    <Video size={18} className=\"group-hover:text-[var(--azul-profundo)]\" />\n                                </a>\n                                <a href=\"https://www.youtube.com/@MundodeAruanda\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"w-10 h-10 rounded-full border border-white/10 flex items-center justify-center hover:bg-[var(--dourado-suave)] hover:border-[var(--dourado-suave)] transition-all duration-300 group\">\n                                    <Youtube size={18} className=\"group-hover:text-[var(--azul-profundo)]\" />\n                                </a>\n                                <a href=\"https://www.mercadolivre.com.br/pagina/umbandaaxe777\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"w-10 h-10 rounded-full border border-white/10 flex items-center justify-center hover:bg-[var(--dourado-suave)] hover:border-[var(--dourado-suave)] transition-all duration-300 group\">\n                                    <ShoppingBag size={18} className=\"group-hover:text-[var(--azul-profundo)]\" />\n                                </a>\n                            </div>\n                        </div>\n                    </div>\n\n                </div>\n\n                {/* Rodap칠 Inferior */}\n                <div className=\"border-t border-[var(--branco-off-white)]/10 pt-8 flex flex-col md:flex-row justify-between items-center gap-6\">\n                    <p className=\"font-lato text-[11px] text-[var(--branco-off-white)]/30 tracking-[0.1em] text-center md:text-left\">\n                        춸 {currentYear} ATELI칅 FILHOS DE ARUANDA. CNPJ: 36.720.385/0001-09\n                    </p>\n\n                    <div className=\"flex items-center gap-1 font-lato text-[10px] text-[var(--branco-off-white)]/30 uppercase tracking-widest\">\n                        Feito com <Heart size={12} className=\"text-[var(--dourado-suave)] fill-[var(--dourado-suave)] animate-pulse\" /> para iluminar caminhos.\n                    </div>\n\n                    {/* Selos de Pagamento */}\n                    <div className=\"flex gap-4 items-center grayscale opacity-40 hover:opacity-100 hover:grayscale-0 transition-all duration-500\">\n                        <img src=\"/images/visa.svg\" alt=\"Visa\" className=\"h-3\" />\n                        <img src=\"/images/mastercard.svg\" alt=\"Mastercard\" className=\"h-6\" />\n                        <img src=\"/images/pix.svg\" alt=\"Pix\" className=\"h-4\" />\n                        <img src=\"/images/mercadopago.svg\" alt=\"Mercado Pago\" className=\"h-10\" />\n                    </div>\n                </div>\n            </div>\n        </footer>\n    );\n};\n\nexport default Footer;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/GlobalAlertModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/Header.tsx","messages":[{"ruleId":"no-restricted-imports","severity":2,"message":"'../services/authService' import is restricted from being used by a pattern. 游뛂 Dumb components must not call services directly. Receive data via props.","line":4,"column":1,"nodeType":"ImportDeclaration","messageId":"patternWithCustomMessage","endLine":4,"endColumn":55},{"ruleId":"no-restricted-imports","severity":2,"message":"'../services/cartService' import is restricted from being used by a pattern. 游뛂 Dumb components must not call services directly. Receive data via props.","line":5,"column":1,"nodeType":"ImportDeclaration","messageId":"patternWithCustomMessage","endLine":5,"endColumn":55},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/Header.tsx:32:9\n  30 |\n  31 |     useEffect(() => {\n> 32 |         initHeader();\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  33 |         const handleOpenAuth = () => setIsAuthOpen(true);\n  34 |\n  35 |         window.addEventListener('cart-updated', initHeader);","line":32,"column":9,"nodeType":null,"endLine":32,"endColumn":19}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, FormEvent } from 'react';\nimport { ShoppingCart, User, Menu, X, LogOut, ChevronDown, ChevronRight } from 'lucide-react';\nimport { Link, useNavigate, useLocation } from 'react-router-dom';\nimport { authService } from '../services/authService';\nimport { cartService } from '../services/cartService';\nimport CartDrawer from './CartDrawer';\nimport SearchBar from './SearchBar';\nimport NavMenu from './NavMenu';\nimport AuthModal from './AuthModal';\nimport { User as UserType, Cart } from '../types';\n\nconst Header: React.FC = () => {\n    const [isMenuOpen, setIsMenuOpen] = useState(false);\n    const [isCartOpen, setIsCartOpen] = useState(false);\n    const [isAuthOpen, setIsAuthOpen] = useState(false);\n\n    const [user, setUser] = useState<UserType | null>(null);\n    const [cart, setCart] = useState<Cart>({ items: [] });\n    const [searchTerm, setSearchTerm] = useState('');\n\n    const navigate = useNavigate();\n    const location = useLocation();\n\n    const initHeader = async () => {\n        const user = authService.getUser();\n        setUser(user);\n        const cartItems = await cartService.get();\n        setCart({ items: cartItems || [] });\n    };\n\n    useEffect(() => {\n        initHeader();\n        const handleOpenAuth = () => setIsAuthOpen(true);\n\n        window.addEventListener('cart-updated', initHeader);\n        window.addEventListener('open-auth-modal', handleOpenAuth);\n        window.addEventListener('auth-changed', initHeader); // Re-sincroniza ao logar/deslogar\n\n        return () => {\n            window.removeEventListener('cart-updated', initHeader);\n            window.removeEventListener('open-auth-modal', handleOpenAuth);\n            window.removeEventListener('auth-changed', initHeader);\n        };\n    }, [location.pathname]);\n\n    const cartQuantity = cart?.items?.reduce((acc, item) => acc + (item.quantity || 0), 0) || 0;\n\n    const handleSearch = (e: FormEvent) => {\n        e.preventDefault();\n        if (searchTerm.trim()) {\n            navigate(`/search?q=${encodeURIComponent(searchTerm.trim())}`);\n            setIsMenuOpen(false);\n            setSearchTerm('');\n        }\n    };\n\n    const handleLogout = () => {\n        authService.logout();\n    };\n\n    useEffect(() => {\n        document.body.style.overflow = (isCartOpen || isMenuOpen || isAuthOpen) ? 'hidden' : 'unset';\n    }, [isCartOpen, isMenuOpen, isAuthOpen]);\n\n    return (\n        <header className=\"w-full bg-[var(--branco-off-white)] border-b border-[var(--azul-profundo)]/10 sticky top-0 z-[100]\">\n            <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n                <div className=\"flex justify-between items-center py-4 md:py-6 gap-4\">\n\n                    <button className=\"md:hidden text-[var(--azul-profundo)] p-2 -ml-2\" onClick={() => setIsMenuOpen(!isMenuOpen)}>\n                        {isMenuOpen ? <X size={24} /> : <Menu size={24} />}\n                    </button>\n\n                    <Link to=\"/\" className=\"text-center md:text-left md:w-1/3 group\">\n                        <h1 className=\"font-playfair text-xl md:text-2xl text-[var(--azul-profundo)] leading-tight\">\n                            Ateli칡\n                            <span className=\"block text-[10px] md:text-sm font-lato tracking-[0.2em] uppercase text-[var(--dourado-suave)] group-hover:tracking-[0.3em] transition-all duration-300\">\n                                Filhos de Aruanda\n                            </span>\n                        </h1>\n                    </Link>\n\n                    <div className=\"hidden md:flex flex-1 max-w-md justify-center\">\n                        <SearchBar\n                            searchTerm={searchTerm}\n                            setSearchTerm={setSearchTerm}\n                            onSearch={handleSearch}\n                            isMobile={false}\n                        />\n                    </div>\n\n                    <div className=\"flex items-center justify-end gap-2 md:gap-6 md:w-1/3\">\n                        <div className=\"hidden md:flex items-center gap-5 text-[var(--azul-profundo)]\">\n                            {user ? (\n                                <div className=\"relative group border-r pr-5 border-[var(--azul-profundo)]/10 flex items-center h-full\">\n                                    <div className=\"flex items-center gap-3 cursor-pointer py-4\">\n                                        <div className=\"text-right\">\n                                            <p className=\"font-lato text-[9px] uppercase tracking-widest text-[var(--dourado-suave)] group-hover:text-[var(--azul-profundo)] transition-colors\">Ax칠</p>\n                                            <p className=\"font-playfair text-xs font-bold leading-none group-hover:text-[#C9A24D] transition-colors line-clamp-1 max-w-[100px] flex items-center gap-1\">\n                                                {user.name || 'Membro'} <ChevronDown size={14} className=\"opacity-50\" />\n                                            </p>\n                                        </div>\n                                        {user.photoUrl ? (\n                                            <img src={user.photoUrl} alt={user.name} className=\"w-8 h-8 rounded-full object-cover border border-[var(--dourado-suave)] shadow-sm\" />\n                                        ) : (\n                                            <div className=\"w-8 h-8 rounded-full bg-[var(--azul-profundo)] text-[var(--dourado-suave)] flex items-center justify-center font-playfair font-bold text-sm shadow-sm border border-[var(--dourado-suave)]\">\n                                                {user.name ? user.name.charAt(0).toUpperCase() : 'M'}\n                                            </div>\n                                        )}\n                                    </div>\n\n                                    {/* Dropdown Menu Meli Style */}\n                                    <div className=\"absolute top-full right-5 mt-[-8px] w-72 bg-white rounded-md shadow-xl border border-gray-100 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-[60]\">\n                                        <div className=\"p-4 border-b border-gray-100 flex items-center gap-3\">\n                                            {user.photoUrl ? (\n                                                <img src={user.photoUrl} alt={user.name} className=\"w-12 h-12 rounded-full object-cover border border-gray-200\" />\n                                            ) : (\n                                                <div className=\"w-12 h-12 rounded-full bg-gray-100 text-gray-400 flex items-center justify-center font-bold text-xl\">\n                                                    {user.name ? user.name.charAt(0).toUpperCase() : 'M'}\n                                                </div>\n                                            )}\n                                            <div>\n                                                <p className=\"font-bold text-gray-800 text-base\">{user.name}</p>\n                                                <Link to=\"/perfil\" className=\"text-sm text-blue-500 hover:text-blue-600 flex items-center\">\n                                                    Meu perfil <ChevronRight size={14} className=\"ml-1\" />\n                                                </Link>\n                                            </div>\n                                        </div>\n\n                                        <Link to=\"/perfil/compras\" className=\"block px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 transition-colors\">Compras</Link>\n                                        <Link to=\"/perfil/historico\" className=\"block px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 transition-colors\">Hist칩rico</Link>\n                                        <Link to=\"/perfil/perguntas\" className=\"block px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 transition-colors\">Perguntas</Link>\n                                        <Link to=\"/perfil/opinioes\" className=\"block px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 transition-colors\">Opini칫es</Link>\n                                        <Link to=\"/perfil/favoritos\" className=\"block px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 transition-colors border-b border-gray-100\">Favoritos</Link>\n\n                                        <Link to=\"/perfil/assinaturas\" className=\"block px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 transition-colors border-b border-gray-100\">Assinaturas</Link>\n\n                                        <button onClick={handleLogout} className=\"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 transition-colors rounded-b-md\">Sair</button>\n                                    </div>\n                                </div>\n                            ) : (\n                                <button onClick={() => setIsAuthOpen(true)} className=\"flex items-center gap-2 hover:text-[var(--dourado-suave)] transition-all\">\n                                    <User size={19} strokeWidth={1.5} />\n                                    <span className=\"text-[10px] uppercase font-lato tracking-[0.2em]\">Entrar</span>\n                                </button>\n                            )}\n                        </div>\n\n\n\n                        <button\n                            onClick={() => setIsCartOpen(true)}\n                            className=\"relative flex items-center gap-2 text-[var(--azul-profundo)] hover:text-[var(--dourado-suave)] transition-all p-2 -mr-2 md:mr-0\"\n                        >\n                            <div className=\"relative\">\n                                <ShoppingCart size={22} strokeWidth={1.5} />\n                                {cartQuantity > 0 && (\n                                    <span className=\"absolute -top-1 -right-1 bg-[var(--dourado-suave)] text-white text-[9px] w-4 h-4 rounded-full flex items-center justify-center font-bold\">\n                                        {cartQuantity}\n                                    </span>\n                                )}\n                            </div>\n                            <span className=\"hidden md:block text-[10px] uppercase font-lato tracking-[0.2em]\">Carrinho</span>\n                        </button>\n                    </div>\n                </div>\n\n                <div className=\"md:hidden pb-4 px-1\">\n                    <SearchBar searchTerm={searchTerm} setSearchTerm={setSearchTerm} onSearch={handleSearch} isMobile={true} />\n                </div>\n            </div>\n\n            <div className=\"hidden md:block border-t border-[#0f2A44]/5\">\n                <NavMenu isMobile={false} />\n            </div>\n\n            <div className={`md:hidden fixed inset-0 z-40 bg-[var(--branco-off-white)] pt-24 px-6 transition-transform duration-300 ${isMenuOpen ? 'translate-x-0' : '-translate-x-full'}`}>\n                <NavMenu isMobile={true} closeMenu={() => setIsMenuOpen(false)} />\n\n                <div className=\"mt-8 pt-8 border-t border-[var(--azul-profundo)]/10\">\n                    {!user ? (\n                        <button onClick={() => { setIsAuthOpen(true); setIsMenuOpen(false); }} className=\"w-full py-3 bg-white border border-[var(--azul-profundo)]/10 rounded flex items-center justify-center gap-2 text-[var(--azul-profundo)]\">\n                            <User size={18} />\n                            <span className=\"text-xs uppercase tracking-widest\">Entrar / Cadastrar</span>\n                        </button>\n                    ) : (\n                        <button onClick={handleLogout} className=\"w-full py-3 bg-red-50 text-red-800 rounded flex items-center justify-center gap-2\">\n                            <LogOut size={18} />\n                            <span className=\"text-xs uppercase tracking-widest\">Sair</span>\n                        </button>\n                    )}\n                </div>\n            </div>\n\n            <CartDrawer isOpen={isCartOpen} onClose={() => setIsCartOpen(false)} cartItems={cart?.items || []} onUpdateCart={setCart} />\n            <AuthModal isOpen={isAuthOpen} onClose={() => setIsAuthOpen(false)} />\n        </header>\n    );\n};\n\nexport default Header;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/Hero.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/NavMenu.tsx","messages":[{"ruleId":"no-restricted-imports","severity":2,"message":"'../services/productService' import is restricted from being used by a pattern. 游뛂 Dumb components must not call services directly. Receive data via props.","line":4,"column":1,"nodeType":"ImportDeclaration","messageId":"patternWithCustomMessage","endLine":4,"endColumn":61}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Link, useLocation } from 'react-router-dom';\nimport { ChevronDown, ChevronUp } from 'lucide-react';\nimport { productService } from '../services/productService';\nimport { Category } from '../types';\n\ninterface NavMenuProps {\n    isMobile: boolean;\n    closeMenu?: () => void;\n}\n\nconst NavMenu: React.FC<NavMenuProps> = ({ isMobile, closeMenu }) => {\n    const location = useLocation();\n    const [categories, setCategories] = useState<Category[]>([]);\n    const [isCategoryOpen, setIsCategoryOpen] = useState<boolean>(false);\n    const [isHovered, setIsHovered] = useState<boolean>(false);\n\n    useEffect(() => {\n        const fetchCategories = async () => {\n            const data = await productService.getCategories();\n            // Filtra apenas ativas e ordena alfabeticamente\n            setCategories(data.filter(c => c.active).sort((a, b) => a.name.localeCompare(b.name)));\n        };\n        fetchCategories();\n    }, []);\n\n    // Fun칞칚o para verificar se o link est치 ativo\n    const isActive = (path: string) => {\n        if (path === '/' && location.pathname !== '/') return false;\n        return location.pathname + location.search === path || location.pathname === path;\n    };\n\n    const isCategoryActive = categories.some(c => isActive(`/store?categoryId=${c.id}`));\n\n    const mainLinks = [\n        { name: 'Home', path: '/' },\n        { name: 'Assinaturas', path: '/assinaturas' },\n        { name: 'Nossa Hist칩ria', path: '/about' },\n        { name: 'Ax칠 & 칄tica', path: '/ethics' }\n    ];\n\n    if (isMobile) {\n        return (\n            <ul className=\"flex flex-col items-center gap-6 py-6 bg-[var(--branco-off-white)]\">\n                <li>\n                    <Link\n                        to=\"/\"\n                        className={`font-lato text-[12px] uppercase tracking-[0.2em] ${isActive('/') ? 'text-[var(--dourado-suave)] font-bold' : 'text-[var(--azul-profundo)]/80'}`}\n                        onClick={closeMenu}\n                    >\n                        Home\n                    </Link>\n                </li>\n\n                {/* Categoria Mobile Dropdown */}\n                <li className=\"w-full flex flex-col items-center\">\n                    <button\n                        onClick={() => setIsCategoryOpen(!isCategoryOpen)}\n                        className={`flex items-center gap-2 font-lato text-[12px] uppercase tracking-[0.2em] transition-colors ${isCategoryActive ? 'text-[var(--dourado-suave)] font-bold' : 'text-[var(--azul-profundo)]/80'}`}\n                    >\n                        Categorias {isCategoryOpen ? <ChevronUp size={14} /> : <ChevronDown size={14} />}\n                    </button>\n\n                    {isCategoryOpen && (\n                        <ul className=\"mt-4 flex flex-col items-center gap-4 w-full bg-black/5 py-4\">\n                            {categories.map((cat) => (\n                                <li key={cat.id}>\n                                    <Link\n                                        to={`/store?categoryId=${cat.id}`}\n                                        className={`font-lato text-[11px] uppercase tracking-[0.1em] ${isActive(`/store?categoryId=${cat.id}`) ? 'text-[var(--dourado-suave)]' : 'text-[var(--azul-profundo)]/60'}`}\n                                        onClick={closeMenu}\n                                    >\n                                        {cat.name}\n                                    </Link>\n                                </li>\n                            ))}\n                        </ul>\n                    )}\n                </li>\n\n                {mainLinks.slice(1).map((item) => (\n                    <li key={item.name}>\n                        <Link\n                            to={item.path}\n                            className={`font-lato text-[12px] uppercase tracking-[0.2em] transition-colors ${isActive(item.path) ? 'text-[var(--dourado-suave)] font-bold' : 'text-[var(--azul-profundo)]/80'}`}\n                            onClick={closeMenu}\n                        >\n                            {item.name}\n                        </Link>\n                    </li>\n                ))}\n            </ul>\n        );\n    }\n\n    return (\n        <nav className=\"hidden md:block border-t border-[var(--azul-profundo)]/5 bg-[var(--branco-off-white)]/80 backdrop-blur-sm relative z-50\">\n            <ul className=\"flex justify-center items-center gap-12 py-4\">\n                <li className=\"h-full flex items-center\">\n                    <Link\n                        to=\"/\"\n                        className={`font-lato text-[10px] uppercase tracking-[0.2em] transition-all duration-300 relative group flex items-center h-6 ${isActive('/') ? 'text-[var(--dourado-suave)]' : 'text-[var(--azul-profundo)]/70 hover:text-[var(--dourado-suave)]'}`}\n                    >\n                        Home\n                        <span className={`absolute -bottom-1 left-1/2 -translate-x-1/2 h-[1px] bg-[var(--dourado-suave)] transition-all duration-300 ${isActive('/') ? 'w-full' : 'w-0 group-hover:w-full'}`}></span>\n                    </Link>\n                </li>\n\n                {/* Categorias Desktop Dropdown */}\n                <li\n                    className=\"relative h-full flex items-center group\"\n                    onMouseEnter={() => setIsHovered(true)}\n                    onMouseLeave={() => setIsHovered(false)}\n                >\n                    <button\n                        className={`flex items-center gap-1 h-6 bg-transparent border-none p-0 focus:outline-none font-lato text-[10px] uppercase tracking-[0.2em] transition-all duration-300 ${isCategoryActive || isHovered ? 'text-[var(--dourado-suave)]' : 'text-[var(--azul-profundo)]/70 hover:text-[var(--dourado-suave)]'}`}\n                    >\n                        Categorias <ChevronDown size={12} className={`transition-transform duration-300 ${isHovered ? 'rotate-180' : ''}`} />\n                        <span className={`absolute -bottom-1 left-1/2 -translate-x-1/2 h-[1px] bg-[var(--dourado-suave)] transition-all duration-300 ${isCategoryActive ? 'w-full' : 'w-0 group-hover:w-full'}`}></span>\n                    </button>\n\n                    {/* Submenu Desktop */}\n                    <div className={`absolute top-full left-1/2 -translate-x-1/2 pt-4 w-56 transition-all duration-300 ${isHovered ? 'opacity-100 visible translate-y-0' : 'opacity-0 invisible -translate-y-2'}`}>\n                        <div className=\"bg-white shadow-xl border border-gray-100 py-2\">\n                            {categories.length === 0 ? (\n                                <div className=\"px-4 py-2 text-[10px] text-gray-400 uppercase tracking-widest text-center\">Carregando...</div>\n                            ) : (\n                                categories.map((cat) => (\n                                    <Link\n                                        key={cat.id}\n                                        to={`/store?categoryId=${cat.id}`}\n                                        className={`block px-6 py-3 text-[10px] uppercase tracking-[0.15em] transition-colors hover:bg-[var(--branco-off-white)] ${isActive(`/store?categoryId=${cat.id}`) ? 'text-[var(--dourado-suave)] bg-[var(--branco-off-white)]' : 'text-[var(--azul-profundo)]/70'}`}\n                                    >\n                                        {cat.name}\n                                    </Link>\n                                ))\n                            )}\n                        </div>\n                    </div>\n                </li>\n\n                {mainLinks.slice(1).map((item) => (\n                    <li key={item.name} className=\"h-full flex items-center\">\n                        <Link\n                            to={item.path}\n                            className={`font-lato text-[10px] uppercase tracking-[0.2em] transition-all duration-300 relative group flex items-center h-6 ${isActive(item.path) ? 'text-[var(--dourado-suave)]' : 'text-[var(--azul-profundo)]/70 hover:text-[var(--dourado-suave)]'}`}\n                        >\n                            {item.name}\n                            <span className={`absolute -bottom-1 left-1/2 -translate-x-1/2 h-[1px] bg-[var(--dourado-suave)] transition-all duration-300 ${isActive(item.path) ? 'w-full' : 'w-0 group-hover:w-full'}`}></span>\n                        </Link>\n                    </li>\n                ))}\n            </ul>\n        </nav>\n    );\n};\n\nexport default NavMenu;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/ProductCard.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/ProductCard.tsx","messages":[{"ruleId":"no-restricted-imports","severity":2,"message":"'../services/cartService' import is restricted from being used by a pattern. 游뛂 Dumb components must not call services directly. Receive data via props.","line":3,"column":1,"nodeType":"ImportDeclaration","messageId":"patternWithCustomMessage","endLine":3,"endColumn":55},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getImageUrl' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":21,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"getImageUrl"},"fix":{"range":[255,306],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { cartService } from '../services/cartService';\nimport { useFavorites } from '../context/FavoritesContext';\nimport { ShoppingBag, Check, Heart } from 'lucide-react';\nimport { getImageUrl } from '../utils/imageUtils';\nimport Button from './ui/Button';\nimport Spinner from './ui/Spinner';\nimport { useToast } from '../context/ToastContext';\nimport { Product } from '../types';\n\ninterface ProductCardProps {\n    product: Product;\n    initialIsFavorite?: boolean;\n}\n\nimport OptimizedImage from './ui/OptimizedImage';\n\nconst ProductCard: React.FC<ProductCardProps> = ({ product }) => {\n    const favoritesContext = useFavorites();\n    const [loading, setLoading] = useState<boolean>(false);\n    const [added, setAdded] = useState<boolean>(false);\n    const { addToast } = useToast();\n\n    if (!favoritesContext) return null;\n\n    const { isFavorite: checkFavorite, toggleFavorite, loading: favLoading } = favoritesContext;\n    const isFavorite = checkFavorite(product.id);\n\n    const handleToggleFavorite = async (e: React.MouseEvent) => {\n        e.preventDefault();\n        e.stopPropagation();\n        await toggleFavorite(product);\n    };\n\n    const handleAddToCart = (e: React.MouseEvent) => {\n        e.preventDefault();\n        e.stopPropagation();\n        setLoading(true);\n\n        setTimeout(() => {\n            cartService.add(product, 1);\n            addToast(`${product.name} adicionado!`, \"success\");\n            setAdded(true);\n            setLoading(false);\n            setTimeout(() => setAdded(false), 2000);\n        }, 300);\n    };\n\n    const isOutOfStock = (product.stockQuantity || 0) <= 0;\n    const imageUrl = product.images?.[0] || '';\n\n    // Calculate discount\n    const originalPrice = product.originalPrice || product.price;\n    const currentPrice = product.price;\n    const hasDiscount = originalPrice > currentPrice;\n    const discountPercentage = product.discountPercentage || (hasDiscount\n        ? Math.round(((originalPrice - currentPrice) / originalPrice) * 100)\n        : 0);\n\n    const priceFormatted = new Intl.NumberFormat('pt-BR', {\n        style: 'currency',\n        currency: 'BRL'\n    }).format(currentPrice || 0);\n\n    const originalPriceFormatted = new Intl.NumberFormat('pt-BR', {\n        style: 'currency',\n        currency: 'BRL'\n    }).format(originalPrice || 0);\n\n    return (\n        <div className=\"group relative flex flex-col bg-white overflow-hidden shadow-sm hover:shadow-md transition-all duration-300 rounded-sm border border-gray-100 max-w-[280px] mx-auto w-full\">\n\n\n            {/* 칈cone de Favorito */}\n            <button\n                onClick={handleToggleFavorite}\n                disabled={favLoading}\n                className={`absolute top-3 right-3 z-10 w-9 h-9 rounded-full flex items-center justify-center bg-white/90 backdrop-blur-sm shadow-sm transition-all duration-300 hover:scale-110 active:scale-95 group/fav ${isFavorite ? 'text-red-500' : 'text-[var(--azul-profundo)]/30 hover:text-red-500'}`}\n                title={isFavorite ? \"Remover dos favoritos\" : \"Adicionar aos favoritos\"}\n            >\n                {favLoading ? (\n                    <Spinner size={14} className=\"text-gray-300\" />\n                ) : (\n                    <Heart size={18} className={`${isFavorite ? 'fill-current' : 'transition-colors'}`} />\n                )}\n            </button>\n\n            <Link to={`/produto/${product.id}`} className=\"relative aspect-square overflow-hidden bg-[var(--branco-off-white)] group-hover:opacity-95 transition-opacity\">\n                <OptimizedImage\n                    src={imageUrl}\n                    alt={product.title || product.name || 'Produto'}\n                    width={280}\n                    height={280}\n                    productContext={{\n                        name: product.name,\n                        category: typeof product.category === 'object' ? product.category.name : undefined\n                    }}\n                    className=\"h-full w-full object-contain object-center transition-transform duration-700 group-hover:scale-110 px-4\"\n                />\n                {isOutOfStock && (\n                    <div className=\"absolute inset-0 bg-white/60 flex items-center justify-center backdrop-blur-[1px]\">\n                        <span className=\"bg-[var(--marron-terra)] text-white text-[9px] font-lato font-bold px-4 py-1.5 uppercase tracking-[0.2em] shadow-lg\">Esgotado</span>\n                    </div>\n                )}\n            </Link>\n\n            <div className=\"p-4 flex flex-col flex-1\">\n                {/* Marca em Dourado */}\n                <span className=\"font-lato text-[9px] font-bold uppercase tracking-[0.2em] text-[var(--dourado-suave)] mb-3 text-center block\">\n                    Ateli칡 Aruanda\n                </span>\n\n                <Link to={`/produto/${product.id}`} className=\"mb-1 block\">\n                    <h3\n                        className=\"font-playfair text-base text-[var(--azul-profundo)] line-clamp-1 h-6 leading-6 text-center group-hover:text-[var(--dourado-suave)] transition-colors duration-300\"\n                        title={product.title || product.name || ''}\n                    >\n                        {product.title || product.name || 'Produto'}\n                    </h3>\n                </Link>\n\n                <div className=\"mt-auto\">\n                    <div className=\"flex flex-col mb-4\">\n                        {hasDiscount && (\n                            <span className=\"text-xs text-gray-400 line-through font-lato mb-0.5\">\n                                {originalPriceFormatted}\n                            </span>\n                        )}\n                        <div className=\"flex items-center gap-3\">\n                            <span className=\"font-lato text-xl font-black text-[var(--azul-profundo)]\">\n                                {priceFormatted}\n                            </span>\n                            {hasDiscount && (\n                                <span className=\"text-[var(--verde-musgo)] font-lato text-xs font-bold tracking-tight\">\n                                    {discountPercentage}% OFF\n                                </span>\n                            )}\n                        </div>\n                    </div>\n\n                    <Button\n                        onClick={handleAddToCart}\n                        isLoading={loading}\n                        disabled={isOutOfStock}\n                        variant=\"primary\"\n                        className={`w-full py-3 px-4 font-lato text-[10px] font-bold uppercase tracking-[0.2em] transition-all duration-300 ${added ? 'bg-[var(--verde-musgo)] border-[var(--verde-musgo)]' : ''}`}\n                    >\n                        {added ? (\n                            <div className=\"flex items-center justify-center gap-2\">\n                                <Check size={14} strokeWidth={3} />\n                                <span>Na Sacola</span>\n                            </div>\n                        ) : isOutOfStock ? (\n                            'Indispon칤vel'\n                        ) : (\n                            <div className=\"flex items-center justify-center gap-2\">\n                                <ShoppingBag size={14} />\n                                <span>Comprar</span>\n                            </div>\n                        )}\n                    </Button>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default ProductCard;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/ReviewForm.tsx","messages":[{"ruleId":"no-restricted-imports","severity":2,"message":"'../services/productService' import is restricted from being used by a pattern. 游뛂 Dumb components must not call services directly. Receive data via props.","line":4,"column":1,"nodeType":"ImportDeclaration","messageId":"patternWithCustomMessage","endLine":4,"endColumn":61},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":113,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3878,3881],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3878,3881],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":121,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":121,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4173,4176],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4173,4176],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef, useEffect, ChangeEvent, FormEvent } from 'react';\nimport { Star, Upload, X, AlertTriangle, Loader2, CheckCircle, Play } from 'lucide-react';\nimport { isSafeImage, fileToImage, loadModel } from '../utils/nsfwModerator';\nimport { productService } from '../services/productService';\nimport { CreateReviewData } from '../types';\n\ninterface ReviewFormProps {\n    productId: string;\n    onReviewSubmitted?: () => void;\n}\n\ninterface MediaItem {\n    file: File;\n    preview: string;\n    type: 'IMAGE' | 'VIDEO';\n}\n\nconst ReviewForm: React.FC<ReviewFormProps> = ({ productId, onReviewSubmitted }) => {\n    const [rating, setRating] = useState<number>(0);\n    const [comment, setComment] = useState<string>('');\n    const [media, setMedia] = useState<MediaItem[]>([]);\n    const [hoverRating, setHoverRating] = useState<number>(0);\n\n    const [isModerating, setIsModerating] = useState<boolean>(false);\n    const [isSubmitting, setIsSubmitting] = useState<boolean>(false);\n    const [error, setError] = useState<string | null>(null);\n    const [success, setSuccess] = useState<boolean>(false);\n    const [isModelLoaded, setIsModelLoaded] = useState<boolean>(false);\n\n    const fileInputRef = useRef<HTMLInputElement>(null);\n\n    useEffect(() => {\n        // Warm up the model\n        loadModel().then(() => setIsModelLoaded(true));\n    }, []);\n\n    const handleFileChange = async (e: ChangeEvent<HTMLInputElement>) => {\n        const files = e.target.files ? Array.from(e.target.files) : [];\n        if (!files.length) return;\n\n        if (media.length + files.length > 5) {\n            setError('M치ximo de 5 m칤dias por avalia칞칚o.');\n            return;\n        }\n\n        setError(null);\n        setIsModerating(true);\n\n        const newMedia: MediaItem[] = [];\n\n        for (const file of files) {\n            try {\n                if (file.type.startsWith('image/')) {\n                    const img = await fileToImage(file);\n                    const result = await isSafeImage(img);\n\n                    if (!result.safe) {\n                        setError(result.reason || 'Imagem inadequada.');\n                        if (fileInputRef.current) fileInputRef.current.value = '';\n                        continue;\n                    }\n\n                    newMedia.push({\n                        file,\n                        preview: URL.createObjectURL(file),\n                        type: 'IMAGE'\n                    });\n                } else if (file.type.startsWith('video/')) {\n                    newMedia.push({\n                        file,\n                        preview: URL.createObjectURL(file),\n                        type: 'VIDEO'\n                    });\n                }\n            } catch (err) {\n                console.error(\"Error moderating image\", err);\n                setError('Ocorreu um erro ao processar a imagem.');\n            }\n        }\n\n        setMedia(prev => [...prev, ...newMedia]);\n        setIsModerating(false);\n        if (fileInputRef.current) fileInputRef.current.value = '';\n    };\n\n    const removeMedia = (index: number) => {\n        const item = media[index];\n        if (item) {\n            URL.revokeObjectURL(item.preview);\n            setMedia(prev => prev.filter((_, i) => i !== index));\n        }\n    };\n\n    const handleSubmit = async (e: FormEvent) => {\n        e.preventDefault();\n        if (rating === 0) {\n            setError('Por favor, selecione uma nota de 1 a 5.');\n            return;\n        }\n\n        setIsSubmitting(true);\n        setError(null);\n\n        try {\n            const reviewData: CreateReviewData = {\n                productId,\n                rating,\n                comment: comment.substring(0, 300),\n                media: media.map(m => ({\n                    url: m.preview, // Mock URL\n                    type: m.type\n                }))\n            } as any; // Cast for compatibility with expected API structure if needed\n\n            await productService.createReview(reviewData);\n\n            setSuccess(true);\n            setTimeout(() => {\n                if (onReviewSubmitted) onReviewSubmitted();\n            }, 2000);\n        } catch (err: any) {\n            setError(err.message || 'Erro ao enviar avalia칞칚o.');\n        } finally {\n            setIsSubmitting(false);\n        }\n    };\n\n    if (success) {\n        return (\n            <div className=\"flex flex-col items-center justify-center py-12 text-center space-y-4\">\n                <CheckCircle size={64} className=\"text-green-500 animate-bounce\" />\n                <h3 className=\"font-playfair text-2xl text-[var(--azul-profundo)]\">Avalia칞칚o Enviada!</h3>\n                <p className=\"font-lato text-gray-500\">Sua opini칚o passar치 por uma r치pida modera칞칚o e em breve estar치 no ar.</p>\n                <p className=\"text-[#C9A24D] font-bold\">Ax칠!</p>\n            </div>\n        );\n    }\n\n    return (\n        <form onSubmit={handleSubmit} className=\"space-y-8\">\n            <div className=\"flex flex-col items-center text-center space-y-4\">\n                <span className=\"font-lato text-xs uppercase tracking-[0.2em] text-gray-400\">Sua nota</span>\n                <div className=\"flex gap-2\">\n                    {[1, 2, 3, 4, 5].map((s) => (\n                        <button\n                            key={s}\n                            type=\"button\"\n                            onMouseEnter={() => setHoverRating(s)}\n                            onMouseLeave={() => setHoverRating(0)}\n                            onClick={() => setRating(s)}\n                            className=\"transition-transform hover:scale-125\"\n                        >\n                            <Star\n                                size={32}\n                                className={`${s <= (hoverRating || rating)\n                                    ? \"fill-[#C9A24D] text-[#C9A24D]\"\n                                    : \"text-gray-200\"\n                                    } transition-colors`}\n                            />\n                        </button>\n                    ))}\n                </div>\n            </div>\n\n            <div className=\"space-y-2\">\n                <label className=\"font-lato text-[10px] uppercase tracking-widest text-gray-500 block\">Seu depoimento (M치x 300 caracteres)</label>\n                <textarea\n                    value={comment}\n                    onChange={(e: ChangeEvent<HTMLTextAreaElement>) => setComment(e.target.value)}\n                    maxLength={300}\n                    rows={4}\n                    className=\"w-full p-4 bg-white border border-gray-200 rounded-sm font-lato text-sm focus:border-[var(--azul-profundo)] focus:ring-0 transition-all outline-none\"\n                    placeholder=\"Conte-nos sua experi칡ncia com este item sagrado...\"\n                />\n                <div className=\"flex justify-end\">\n                    <span className=\"text-[10px] text-gray-400 font-lato\">{comment.length}/300</span>\n                </div>\n            </div>\n\n            <div className=\"space-y-4\">\n                <label className=\"font-lato text-[10px] uppercase tracking-widest text-gray-500 block\">Anexar M칤dias (M치x 5)</label>\n\n                <div className=\"flex flex-wrap gap-4\">\n                    {media.map((item, index) => (\n                        <div key={index} className=\"relative w-24 h-24 bg-white rounded-sm border border-gray-100 overflow-hidden shadow-sm\">\n                            {item.type === 'IMAGE' ? (\n                                <img src={item.preview} alt=\"Preview\" className=\"w-full h-full object-cover\" />\n                            ) : (\n                                <div className=\"w-full h-full flex items-center justify-center bg-gray-900\">\n                                    <Play size={20} className=\"text-white fill-white\" />\n                                </div>\n                            )}\n                            <button\n                                type=\"button\"\n                                onClick={() => removeMedia(index)}\n                                className=\"absolute top-1 right-1 bg-black/60 text-white p-1 rounded-full hover:bg-red-600 transition-colors\"\n                            >\n                                <X size={12} />\n                            </button>\n                        </div>\n                    ))}\n\n                    {media.length < 5 && (\n                        <button\n                            type=\"button\"\n                            onClick={() => fileInputRef.current?.click()}\n                            disabled={isModerating}\n                            className={`w-24 h-24 border-2 border-dashed border-gray-200 rounded-sm flex flex-col items-center justify-center gap-2 hover:border-[var(--dourado-suave)] hover:bg-[var(--dourado-suave)]/5 transition-all\n                ${isModerating ? 'cursor-not-allowed opacity-50' : 'cursor-pointer'}\n              `}\n                        >\n                            {isModerating ? (\n                                <Loader2 size={24} className=\"animate-spin text-[#C9A24D]\" />\n                            ) : (\n                                <>\n                                    <Upload size={20} className=\"text-gray-400\" />\n                                    <span className=\"text-[8px] uppercase tracking-widest text-gray-400\">Upload</span>\n                                </>\n                            )}\n                        </button>\n                    )}\n                </div>\n\n                <input\n                    type=\"file\"\n                    ref={fileInputRef}\n                    onChange={handleFileChange}\n                    multiple\n                    accept=\"image/*,video/*\"\n                    className=\"hidden\"\n                />\n\n                {!isModelLoaded && (\n                    <p className=\"text-[9px] text-amber-600 font-lato uppercase tracking-widest animate-pulse\">\n                        Carregando intelig칡ncia de modera칞칚o...\n                    </p>\n                )}\n            </div>\n\n            {error && (\n                <div className=\"p-4 bg-red-50 border-l-4 border-red-500 flex items-start gap-3 animate-in fade-in slide-in-from-left-2\">\n                    <AlertTriangle size={18} className=\"text-red-500 shrink-0\" />\n                    <p className=\"text-xs text-red-700 font-lato\">{error}</p>\n                </div>\n            )}\n\n            <button\n                type=\"submit\"\n                disabled={isSubmitting || !isModelLoaded || rating === 0}\n                className={`w-full py-4 px-8 bg-[var(--azul-profundo)] text-white font-lato text-xs uppercase tracking-[0.2em] rounded-sm shadow-md transition-all flex items-center justify-center gap-3\n          ${(isSubmitting || !isModelLoaded || rating === 0) ? 'opacity-50 cursor-not-allowed' : 'hover:bg-[#C9A24D] active:scale-[0.98]'}\n        `}\n            >\n                {isSubmitting ? <Loader2 size={16} className=\"animate-spin\" /> : <ArrowRightIcon size={16} />}\n                Finalizar Avalia칞칚o\n            </button>\n\n            <p className=\"text-[9px] text-center text-gray-400 uppercase tracking-widest\">\n                Protegido por Intelig칡ncia Artificial (NSFW Moderation)\n            </p>\n        </form>\n    );\n};\n\nconst ArrowRightIcon: React.FC<{ size: number, className?: string }> = ({ size, className }) => (\n    <svg\n        width={size}\n        height={size}\n        viewBox=\"0 0 24 24\"\n        fill=\"none\"\n        stroke=\"currentColor\"\n        strokeWidth=\"2\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        className={className}\n    >\n        <path d=\"M5 12h14\" />\n        <path d=\"m12 5 7 7-7 7\" />\n    </svg>\n);\n\nexport default ReviewForm;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/ReviewSection.tsx","messages":[{"ruleId":"no-restricted-imports","severity":2,"message":"'../services/productService' import is restricted from being used by a pattern. 游뛂 Dumb components must not call services directly. Receive data via props.","line":4,"column":1,"nodeType":"ImportDeclaration","messageId":"patternWithCustomMessage","endLine":4,"endColumn":61}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Star, MessageSquare, Loader2 } from 'lucide-react';\nimport ReviewSummary from './ReviewSummary';\nimport { productService } from '../services/productService';\nimport { Review } from '../types';\n\ninterface ReviewSectionProps {\n    productId: string;\n    onReviewAdded?: (review: Review) => void;\n    onReviewsLoaded?: (reviews: Review[]) => void;\n}\n\nconst ReviewSection: React.FC<ReviewSectionProps> = ({ productId, onReviewsLoaded }) => {\n    const [reviews, setReviews] = useState<Review[]>([]);\n    const [loading, setLoading] = useState<boolean>(true);\n\n    useEffect(() => {\n        const fetchReviews = async () => {\n            if (!productId) return;\n            setLoading(true);\n            try {\n                const data = await productService.getReviews(productId);\n                setReviews(data || []);\n                onReviewsLoaded?.(data || []);\n            } catch (err) {\n                console.error(\"[ReviewSection] Falha ao carregar reviews:\", err);\n                setReviews([]);\n            } finally {\n                setLoading(false);\n            }\n        };\n        fetchReviews();\n    }, [productId, onReviewsLoaded]);\n\n    if (loading) return (\n        <div className=\"flex justify-center py-12\">\n            <Loader2 className=\"animate-spin text-[#C9A24D]\" />\n        </div>\n    );\n\n    return (\n        <div className=\"space-y-12\">\n            <div className=\"space-y-2\">\n                <h2 className=\"font-playfair text-3xl text-[var(--azul-profundo)] uppercase tracking-widest\">Vozes do Ax칠</h2>\n                <p className=\"font-lato text-xs text-gray-400 uppercase tracking-widest\">O que nossos clientes dizem sobre este item</p>\n            </div>\n\n            {reviews.length > 0 ? (\n                <>\n                    <ReviewSummary reviews={reviews} />\n\n                    {/* Lista de Coment치rios */}\n                    <div className=\"space-y-8\">\n                        <div className=\"flex justify-between items-center border-b border-gray-100 pb-4\">\n                            <h4 className=\"font-playfair text-sm text-[var(--azul-profundo)] uppercase tracking-widest flex items-center gap-2\">\n                                <MessageSquare size={16} className=\"text-[#C9A24D]\" /> Coment치rios\n                            </h4>\n                            <div className=\"flex gap-4 text-[10px] font-lato uppercase tracking-widest text-gray-400\">\n                                <button className=\"text-[var(--azul-profundo)] font-bold border-b border-[var(--azul-profundo)]\">Mais Recentes</button>\n                                <button className=\"hover:text-[var(--azul-profundo)] transition-colors\">Mais Relevantes</button>\n                            </div>\n                        </div>\n\n                        <div className=\"grid gap-8\">\n                            {reviews.map(review => (\n                                <div key={review.id} className=\"flex flex-col md:flex-row gap-6 pb-8 border-b border-gray-50 last:border-0\">\n                                    <div className=\"w-full md:w-48 shrink-0\">\n                                        <div className=\"flex gap-0.5 mb-2\">\n                                            {[1, 2, 3, 4, 5].map(s => (\n                                                <Star key={s} size={12} className={s <= review.rating ? \"fill-[#C9A24D] text-[#C9A24D]\" : \"text-gray-200\"} />\n                                            ))}\n                                        </div>\n                                        <span className=\"font-lato text-sm font-bold text-[var(--azul-profundo)] block\">{review.userName || review.user?.name || 'Cliente'}</span>\n                                        <span className=\"font-lato text-[10px] text-gray-400 uppercase tracking-widest\">Compra Verificada</span>\n                                    </div>\n                                    <div className=\"flex-1 space-y-4\">\n                                        <p className=\"font-lato text-gray-600 leading-relaxed italic\">\"{review.comment}\"</p>\n                                        <span className=\"text-[10px] font-lato text-gray-300 uppercase tracking-widest block\">\n                                            {review.createdAt ? new Date(review.createdAt).toLocaleDateString('pt-BR') : ''}\n                                        </span>\n                                    </div>\n                                </div>\n                            ))}\n                        </div>\n                    </div>\n                </>\n            ) : (\n                <div className=\"py-20 text-center bg-gray-50/50 rounded-sm border border-dashed border-gray-200\">\n                    <Star size={40} className=\"mx-auto text-gray-200 mb-4\" />\n                    <h3 className=\"font-playfair text-xl text-[var(--azul-profundo)] mb-2\">Ainda n칚o h치 avalia칞칫es</h3>\n                    <p className=\"font-lato text-sm text-gray-400 max-w-xs mx-auto\">\n                        Ap칩s realizar uma compra, voc칡 poder치 avaliar este produto no seu perfil.\n                    </p>\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default ReviewSection;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/ReviewSummary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/SEO.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/ScrollToTop.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/SearchBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/ui/Button.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/ui/Button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/ui/MaskedInput.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/ui/OptimizedImage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/components/ui/Spinner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/context/FavoritesContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":39,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1377,1380],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1377,1380],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":96,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":96,"endColumn":23},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":120,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":120,"endColumn":26}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect, useCallback, ReactNode } from 'react';\nimport { authService } from '../services/authService';\nimport { Product } from '../types';\n\ninterface FavoritesContextType {\n    favorites: string[];\n    isFavorite: (productId: string) => boolean;\n    toggleFavorite: (product: Product) => Promise<boolean>;\n    refreshFavorites: () => Promise<void>;\n    loading: boolean;\n    initialized: boolean;\n}\n\nconst FavoritesContext = createContext<FavoritesContextType | null>(null);\n\ninterface FavoritesProviderProps {\n    children: ReactNode;\n}\n\nexport const FavoritesProvider: React.FC<FavoritesProviderProps> = ({ children }) => {\n    const [favorites, setFavorites] = useState<string[]>([]); // IDs dos produtos favoritos\n    const [loading, setLoading] = useState<boolean>(false);\n    const [initialized, setInitialized] = useState<boolean>(false);\n\n    // Busca favoritos do backend\n    const refreshFavorites = useCallback(async () => {\n        const user = authService.getUser();\n        const userId = user?.id;\n\n        if (!userId) {\n            setFavorites([]);\n            setInitialized(true);\n            return;\n        }\n\n        try {\n            const data = await authService.favorites.get(userId);\n            // Armazenamos apenas os IDs para checagem r치pida nos cards\n            setFavorites(data.map((p: any) => p.id));\n        } catch (error) {\n            console.error(\"[FavoritesContext] Erro ao carregar favoritos:\", error);\n        } finally {\n            setInitialized(true);\n        }\n    }, []);\n\n    // Carrega inicialmente\n    useEffect(() => {\n        refreshFavorites();\n\n        // Escuta login/logout para atualizar\n        const handleAuthChange = () => refreshFavorites();\n        window.addEventListener('auth-changed', handleAuthChange);\n        return () => window.removeEventListener('auth-changed', handleAuthChange);\n    }, [refreshFavorites]);\n\n    const isFavorite = useCallback((productId: string) => {\n        return favorites.includes(productId);\n    }, [favorites]);\n\n    const toggleFavorite = async (product: Product): Promise<boolean> => {\n        const user = authService.getUser();\n        const token = localStorage.getItem('auth_token');\n        const userId = user?.id;\n\n        if (!userId || !token) {\n            // Notifica via evento global (alertas legados ou futuros)\n            window.dispatchEvent(new CustomEvent('show-alert', { detail: \"Sua sess칚o expirou ou voc칡 n칚o est치 logado. Fa칞a login para favoritar.\" }));\n\n            if (!token && userId) {\n                localStorage.removeItem('user');\n                window.dispatchEvent(new Event('auth-changed'));\n            }\n            window.dispatchEvent(new Event('open-auth-modal'));\n            return false;\n        }\n\n        setLoading(true);\n        try {\n            const isAdding = !isFavorite(product.id);\n            await authService.favorites.toggle(userId, product.id);\n\n            // Atualiza칞칚o otimista do estado local\n            if (isAdding) {\n                setFavorites(prev => [...prev, product.id]);\n            } else {\n                setFavorites(prev => prev.filter(id => id !== product.id));\n            }\n\n            // Notifica outros componentes\n            window.dispatchEvent(new CustomEvent('favorites-updated', {\n                detail: { productId: product.id, isFavorite: isAdding }\n            }));\n\n            return true;\n        } catch (error) {\n            window.dispatchEvent(new CustomEvent('show-alert', {\n                detail: \"Erro ao atualizar favoritos. Tente novamente.\"\n            }));\n            return false;\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <FavoritesContext.Provider value={{\n            favorites,\n            isFavorite,\n            toggleFavorite,\n            refreshFavorites,\n            loading,\n            initialized\n        }}>\n            {children}\n        </FavoritesContext.Provider>\n    );\n};\n\nexport const useFavorites = (): FavoritesContextType => {\n    const context = useContext(FavoritesContext);\n    if (!context) {\n        throw new Error('useFavorites deve ser usado dentro de um FavoritesProvider');\n    }\n    return context;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/context/ToastContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":64,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":64,"endColumn":22}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useCallback, ReactNode } from 'react';\nimport { X, CheckCircle, AlertCircle, Info } from 'lucide-react';\n\ninterface Toast {\n    id: string;\n    message: string;\n    type: 'success' | 'error' | 'info';\n}\n\ninterface ToastContextType {\n    addToast: (message: string, type?: 'success' | 'error' | 'info') => void;\n}\n\nconst ToastContext = createContext<ToastContextType | null>(null);\n\ninterface ToastProviderProps {\n    children: ReactNode;\n}\n\nexport const ToastProvider: React.FC<ToastProviderProps> = ({ children }) => {\n    const [toasts, setToasts] = useState<Toast[]>([]);\n\n    const addToast = useCallback((message: string, type: 'success' | 'error' | 'info' = 'info') => {\n        const id = Math.random().toString(36).substring(2, 9);\n        setToasts((prev) => [...prev, { id, message, type }]);\n\n        setTimeout(() => {\n            setToasts((prev) => prev.filter((t) => t.id !== id));\n        }, 5000);\n    }, []);\n\n    const removeToast = useCallback((id: string) => {\n        setToasts((prev) => prev.filter((t) => t.id !== id));\n    }, []);\n\n    return (\n        <ToastContext.Provider value={{ addToast }}>\n            {children}\n            <div className=\"fixed bottom-4 right-4 z-[300] flex flex-col gap-2 max-w-md w-full sm:w-auto\">\n                {toasts.map((toast) => (\n                    <div\n                        key={toast.id}\n                        className={`flex items-center gap-3 p-4 rounded-sm shadow-xl animate-fade-in-up transition-all ${toast.type === 'success' ? 'bg-[#0f2A44] text-white' :\n                                toast.type === 'error' ? 'bg-red-600 text-white' :\n                                    'bg-white text-[#0f2A44] border border-gray-200'\n                            }`}\n                    >\n                        {toast.type === 'success' && <CheckCircle size={18} className=\"text-[#C9A24D]\" />}\n                        {toast.type === 'error' && <AlertCircle size={18} />}\n                        {toast.type === 'info' && <Info size={18} className=\"text-[#C9A24D]\" />}\n\n                        <p className=\"font-lato text-xs uppercase tracking-wider flex-grow\">{toast.message}</p>\n\n                        <button onClick={() => removeToast(toast.id)} className=\"opacity-60 hover:opacity-100\">\n                            <X size={16} />\n                        </button>\n                    </div>\n                ))}\n            </div>\n        </ToastContext.Provider>\n    );\n};\n\nexport const useToast = (): ToastContextType => {\n    const context = useContext(ToastContext);\n    if (!context) throw new Error('useToast must be used within a ToastProvider');\n    return context;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/hooks/useMercadoPago.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[204,207],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[204,207],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[212,215],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[212,215],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[292,295],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[292,295],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { configService } from '../services/orderService';\n\n// Tipagem global para o SDK do Mercado Pago\ninterface MercadoPagoInstance {\n    cardForm: (config: any) => any; // Will refine config/return types later or use unknown\n    [key: string]: any;\n}\n\ndeclare global {\n    interface Window {\n        MercadoPago: new (publicKey: string, options: { locale: string }) => MercadoPagoInstance;\n    }\n}\n\ninterface UseMercadoPago {\n    mp: MercadoPagoInstance | null;\n    loading: boolean;\n    isConfigured: boolean;\n    error: string | null;\n}\n\nexport const useMercadoPago = (): UseMercadoPago => {\n    const [mp, setMp] = useState<MercadoPagoInstance | null>(null);\n    const [loading, setLoading] = useState<boolean>(true);\n    const [isConfigured, setIsConfigured] = useState<boolean>(false);\n    const [error, setError] = useState<string | null>(null);\n\n    useEffect(() => {\n        let mounted = true;\n\n        const initMP = async () => {\n            try {\n                const configData = await configService.getMercadoPagoPublicKey();\n                const publicKey = configData?.publicKey;\n\n                if (!publicKey || publicKey === 'YOUR_PUBLIC_KEY') {\n                    if (mounted) {\n                        setIsConfigured(false);\n                        setLoading(false);\n                    }\n                    return;\n                }\n\n                if (!window.MercadoPago) {\n                    // Se o script n칚o carregou, tentamos novamente em 1s\n                    setTimeout(initMP, 1000);\n                    return;\n                }\n\n                const mpInstance = new window.MercadoPago(publicKey, {\n                    locale: 'pt-BR'\n                });\n\n                if (mounted) {\n                    setMp(mpInstance);\n                    setIsConfigured(true);\n                    setLoading(false);\n                }\n            } catch (err: unknown) {\n                console.error('[useMercadoPago] Erro:', err);\n                if (mounted) {\n                    setError('Erro ao carregar Mercado Pago');\n                    setLoading(false);\n                }\n            }\n        };\n\n        initMP();\n\n        return () => {\n            mounted = false;\n        };\n    }, []);\n\n    return { mp, loading, isConfigured, error };\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/main.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[54,57],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[54,57],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":3,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":3,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[98,101],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[98,101],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file has exports. Move your component(s) to a separate file.","line":17,"column":7,"nodeType":"Identifier","messageId":"noExport","endLine":17,"endColumn":14}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Buffer } from 'buffer'\nif (typeof (window as any).global === 'undefined') {\n  (window as any).global = window;\n}\nwindow.Buffer = Buffer;\n\nimport { StrictMode } from 'react'\nimport { createRoot } from 'react-dom/client'\nimport { HelmetProvider } from 'react-helmet-async'\nimport { GoogleOAuthProvider } from '@react-oauth/google'\nimport { ToastProvider } from \"./context/ToastContext\";\nimport './index.css'\nimport App from './App'\n\nconst GOOGLE_CLIENT_ID = import.meta.env.VITE_GOOGLE_CLIENT_ID || '';\n\nconst AppTree = () => (\n  <HelmetProvider>\n    <ToastProvider>\n      <App />\n    </ToastProvider>\n  </HelmetProvider>\n);\n\nconst rootElement = document.getElementById('root');\nif (!rootElement) throw new Error('Failed to find the root element');\n\ncreateRoot(rootElement).render(\n  <StrictMode>\n    {GOOGLE_CLIENT_ID ? (\n      <GoogleOAuthProvider clientId={GOOGLE_CLIENT_ID}>\n        <AppTree />\n      </GoogleOAuthProvider>\n    ) : (\n      <AppTree />\n    )}\n  </StrictMode>,\n)\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/AboutPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/AddressesPage.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchAddresses` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/AddressesPage.tsx:37:13\n  35 |         const userId = user?.id || user?.googleId;\n  36 |         if (userId) {\n> 37 |             fetchAddresses(userId);\n     |             ^^^^^^^^^^^^^^ `fetchAddresses` accessed before it is declared\n  38 |         } else {\n  39 |             setLoading(false);\n  40 |         }\n\n/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/AddressesPage.tsx:43:5\n  41 |     }, [user]);\n  42 |\n> 43 |     const fetchAddresses = (userId: string) => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 44 |         setLoading(true);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 45 |         addressService.list(userId)\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 46 |             .then(data => setAddresses(data))\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 47 |             .catch(() => setAddresses([]))\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 48 |             .finally(() => setLoading(false));\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 49 |     };\n     | ^^^^^^^ `fetchAddresses` is declared here\n  50 |\n  51 |     const handleEdit = (addr: Address) => {\n  52 |         setEditingId(addr.id || null);","line":37,"column":13,"nodeType":null,"endLine":37,"endColumn":27}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, ChangeEvent, FormEvent } from 'react';\nimport { MapPin, Plus, Pencil, Trash2, X, Loader2, Home } from 'lucide-react';\nimport SEO from '../components/SEO';\nimport { useOutletContext } from 'react-router-dom';\nimport addressService from '../services/addressService';\nimport { User, Address } from '../types';\n\ninterface UserContext {\n    user: User | null;\n}\n\nconst emptyAddress: Address = {\n    label: '',\n    street: '',\n    number: '',\n    complement: '',\n    neighborhood: '',\n    city: '',\n    state: '',\n    zipCode: '',\n    isDefault: false\n};\n\nconst AddressesPage: React.FC = () => {\n    const { user } = useOutletContext<UserContext>();\n    const [addresses, setAddresses] = useState<Address[]>([]);\n    const [loading, setLoading] = useState<boolean>(true);\n    const [showForm, setShowForm] = useState<boolean>(false);\n    const [editingId, setEditingId] = useState<string | null>(null);\n    const [formData, setFormData] = useState<Address>({ ...emptyAddress });\n    const [saving, setSaving] = useState<boolean>(false);\n    const [error, setError] = useState<string>('');\n\n    useEffect(() => {\n        const userId = user?.id || user?.googleId;\n        if (userId) {\n            fetchAddresses(userId);\n        } else {\n            setLoading(false);\n        }\n    }, [user]);\n\n    const fetchAddresses = (userId: string) => {\n        setLoading(true);\n        addressService.list(userId)\n            .then(data => setAddresses(data))\n            .catch(() => setAddresses([]))\n            .finally(() => setLoading(false));\n    };\n\n    const handleEdit = (addr: Address) => {\n        setEditingId(addr.id || null);\n        setFormData({\n            label: addr.label || '',\n            street: addr.street || '',\n            number: addr.number || '',\n            complement: addr.complement || '',\n            neighborhood: addr.neighborhood || '',\n            city: addr.city || '',\n            state: addr.state || '',\n            zipCode: addr.zipCode || '',\n            isDefault: addr.isDefault || false\n        });\n        setShowForm(true);\n        setError('');\n    };\n\n    const handleNew = () => {\n        setEditingId(null);\n        setFormData({ ...emptyAddress });\n        setShowForm(true);\n        setError('');\n    };\n\n    const handleDelete = async (id: string) => {\n        const userId = user?.id || user?.googleId;\n        if (!userId || !confirm('Tem certeza que deseja remover este endere칞o?')) return;\n        try {\n            await addressService.delete(userId, id);\n            setAddresses(prev => prev.filter(a => a.id !== id));\n        } catch {\n            setError('Erro ao remover endere칞o.');\n        }\n    };\n\n    const handleSubmit = async (e: FormEvent) => {\n        e.preventDefault();\n        const userId = user?.id || user?.googleId;\n        if (!userId) return;\n\n        if (!formData.street || !formData.city || !formData.state || !formData.zipCode) {\n            setError('Preencha os campos obrigat칩rios.');\n            return;\n        }\n        setSaving(true);\n        setError('');\n        try {\n            if (editingId) {\n                await addressService.update(userId, editingId, formData);\n            } else {\n                await addressService.create(userId, formData);\n            }\n            setShowForm(false);\n            fetchAddresses(userId);\n        } catch {\n            setError('Erro ao salvar endere칞o.');\n        }\n        setSaving(false);\n    };\n\n    const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n        const { name, value, type, checked } = e.target;\n        setFormData(prev => ({ ...prev, [name]: type === 'checkbox' ? checked : value }));\n    };\n\n    if (!user) return null;\n\n    return (\n        <div className=\"w-full pb-12 font-lato\">\n            <SEO title=\"Meus Endere칞os\" description=\"Gerencie seus endere칞os de entrega.\" />\n\n            <div className=\"max-w-4xl mx-auto px-4 pt-8\">\n                <div className=\"mb-6 flex flex-col md:flex-row md:items-center justify-between gap-4\">\n                    <div>\n                        <h1 className=\"text-2xl font-bold text-gray-800\">Endere칞os</h1>\n                        <p className=\"text-gray-500 text-sm mt-1\">Gerencie os endere칞os de entrega da sua conta.</p>\n                    </div>\n                    <button\n                        onClick={handleNew}\n                        className=\"flex items-center gap-2 bg-[var(--azul-profundo)] text-white px-5 py-2.5 rounded text-sm font-semibold hover:bg-[#0a1e33] transition-colors\"\n                    >\n                        <Plus size={18} /> Novo Endere칞o\n                    </button>\n                </div>\n\n                {error && (\n                    <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-4 text-sm\">\n                        {error}\n                    </div>\n                )}\n\n                {/* Formul치rio */}\n                {showForm && (\n                    <div className=\"bg-white rounded-md shadow-sm border border-gray-200 p-6 mb-6\">\n                        <div className=\"flex justify-between items-center mb-4\">\n                            <h3 className=\"text-sm font-bold text-gray-800 flex items-center gap-2\">\n                                <MapPin size={16} /> {editingId ? 'Editar Endere칞o' : 'Novo Endere칞o'}\n                            </h3>\n                            <button onClick={() => setShowForm(false)} className=\"text-gray-400 hover:text-gray-600\">\n                                <X size={18} />\n                            </button>\n                        </div>\n                        <form onSubmit={handleSubmit} className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                            <input name=\"label\" value={formData.label} onChange={handleChange} placeholder=\"Apelido (ex: Casa, Trabalho)\" className=\"col-span-full border border-gray-300 rounded-md px-4 py-2 text-sm focus:outline-none focus:border-blue-500\" />\n                            <input name=\"street\" value={formData.street} onChange={handleChange} placeholder=\"Rua / Avenida *\" required className=\"border border-gray-300 rounded-md px-4 py-2 text-sm focus:outline-none focus:border-blue-500\" />\n                            <input name=\"number\" value={formData.number} onChange={handleChange} placeholder=\"N칰mero *\" required className=\"border border-gray-300 rounded-md px-4 py-2 text-sm focus:outline-none focus:border-blue-500\" />\n                            <input name=\"complement\" value={formData.complement} onChange={handleChange} placeholder=\"Complemento\" className=\"border border-gray-300 rounded-md px-4 py-2 text-sm focus:outline-none focus:border-blue-500\" />\n                            <input name=\"neighborhood\" value={formData.neighborhood} onChange={handleChange} placeholder=\"Bairro\" className=\"border border-gray-300 rounded-md px-4 py-2 text-sm focus:outline-none focus:border-blue-500\" />\n                            <input name=\"city\" value={formData.city} onChange={handleChange} placeholder=\"Cidade *\" required className=\"border border-gray-300 rounded-md px-4 py-2 text-sm focus:outline-none focus:border-blue-500\" />\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <input name=\"state\" value={formData.state} onChange={handleChange} placeholder=\"UF *\" required maxLength={2} className=\"border border-gray-300 rounded-md px-4 py-2 text-sm focus:outline-none focus:border-blue-500\" />\n                                <input name=\"zipCode\" value={formData.zipCode} onChange={handleChange} placeholder=\"CEP *\" required className=\"border border-gray-300 rounded-md px-4 py-2 text-sm focus:outline-none focus:border-blue-500\" />\n                            </div>\n                            <label className=\"col-span-full flex items-center gap-2 text-sm text-gray-600\">\n                                <input type=\"checkbox\" name=\"isDefault\" checked={formData.isDefault} onChange={handleChange} className=\"accent-blue-600\" />\n                                Definir como endere칞o padr칚o\n                            </label>\n                            <div className=\"col-span-full flex justify-end gap-3\">\n                                <button type=\"button\" onClick={() => setShowForm(false)} className=\"px-5 py-2 border border-gray-300 rounded-md text-sm text-gray-600 hover:bg-gray-50\">Cancelar</button>\n                                <button type=\"submit\" disabled={saving} className=\"px-5 py-2 bg-[var(--azul-profundo)] text-white rounded-md text-sm font-semibold hover:bg-[#0a1e33] disabled:opacity-50\">\n                                    {saving ? 'Salvando...' : (editingId ? 'Atualizar' : 'Salvar')}\n                                </button>\n                            </div>\n                        </form>\n                    </div>\n                )}\n\n                {/* Lista de Endere칞os */}\n                {loading ? (\n                    <div className=\"flex justify-center items-center h-40\">\n                        <Loader2 className=\"animate-spin text-blue-500\" size={28} />\n                    </div>\n                ) : addresses.length === 0 ? (\n                    <div className=\"bg-white rounded-md shadow-sm border border-dashed border-gray-300 p-12 text-center\">\n                        <Home size={48} className=\"mx-auto text-gray-300 mb-4\" />\n                        <h3 className=\"text-lg font-medium text-gray-800 mb-2\">Nenhum endere칞o cadastrado</h3>\n                        <p className=\"text-gray-500 text-sm mb-4\">Adicione um endere칞o para agilizar suas compras.</p>\n                        <button onClick={handleNew} className=\"text-sm text-blue-600 font-semibold hover:underline\">\n                            + Adicionar meu primeiro endere칞o\n                        </button>\n                    </div>\n                ) : (\n                    <div className=\"space-y-3\">\n                        {addresses.map(addr => (\n                            <div key={addr.id} className=\"bg-white rounded-md shadow-sm border border-gray-200 p-5 flex items-center justify-between hover:shadow-md transition\">\n                                <div className=\"flex items-center gap-4\">\n                                    <div className=\"w-10 h-10 bg-blue-50 rounded-full flex items-center justify-center text-blue-500\">\n                                        <MapPin size={20} />\n                                    </div>\n                                    <div>\n                                        <p className=\"text-sm font-semibold text-gray-800\">\n                                            {addr.label || 'Endere칞o'} {addr.isDefault && <span className=\"text-[10px] bg-blue-100 text-blue-700 px-2 py-0.5 rounded ml-2 uppercase font-bold\">Padr칚o</span>}\n                                        </p>\n                                        <p className=\"text-xs text-gray-500 mt-0.5\">\n                                            {addr.street}, {addr.number} {addr.complement ? `- ${addr.complement}` : ''} 췅 {addr.neighborhood} 췅 {addr.city}/{addr.state} 췅 CEP: {addr.zipCode}\n                                        </p>\n                                    </div>\n                                </div>\n                                <div className=\"flex items-center gap-2\">\n                                    <button onClick={() => handleEdit(addr)} className=\"p-2 text-gray-400 hover:text-blue-500 hover:bg-blue-50 rounded-md transition\" title=\"Editar\">\n                                        <Pencil size={16} />\n                                    </button>\n                                    <button onClick={() => addr.id && handleDelete(addr.id)} className=\"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-md transition\" title=\"Remover\">\n                                        <Trash2 size={16} />\n                                    </button>\n                                </div>\n                            </div>\n                        ))}\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default AddressesPage;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/AtelieSubscribePage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/BenefitsPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/CategoryPage.tsx","messages":[{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"React.useMemo\" is called conditionally. React Hooks must be called in the exact same order in every component render. Did you accidentally call a React Hook after an early return?","line":72,"column":28,"nodeType":"MemberExpression","endLine":72,"endColumn":41}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from \"react\";\nimport { useParams, Link } from \"react-router-dom\";\nimport ProductCard from \"../components/ProductCard\";\nimport SEO from \"../components/SEO\";\nimport { Loader2, ChevronLeft, Sparkles, Wind } from \"lucide-react\";\nimport { productService } from '../services/productService';\nimport { Product, Category } from \"../types\";\n\nimport OptimizedImage from \"../components/ui/OptimizedImage\";\n\nconst CategoryPage: React.FC = () => {\n    const { slug } = useParams<{ slug: string }>();\n    const [products, setProducts] = useState<Product[]>([]);\n    const [collection, setCollection] = useState<Category | null>(null);\n    const [loading, setLoading] = useState<boolean>(true);\n\n    useEffect(() => {\n        const fetchCategoryData = async () => {\n            if (!slug) return;\n            setLoading(true);\n            try {\n                const categories = await productService.getCategories();\n                const currentCollection = categories.find(\n                    (c) => c.slug === slug || c.id === slug || c.name.toLowerCase() === slug.toLowerCase(),\n                );\n\n                if (currentCollection) {\n                    setCollection(currentCollection);\n                    const allProducts = await productService.getProducts({ category: currentCollection.id });\n                    setProducts(allProducts);\n                } else {\n                    setCollection(null);\n                }\n            } catch (error) {\n                console.error(\"Erro ao carregar categoria:\", error);\n            } finally {\n                setLoading(false);\n            }\n        };\n        fetchCategoryData();\n    }, [slug]);\n\n    if (loading) {\n        return (\n            <div className=\"min-h-[70vh] flex flex-col items-center justify-center bg-[var(--branco-off-white)] gap-4\">\n                <Loader2 className=\"animate-spin text-[var(--dourado-suave)]\" size={32} />\n                <span className=\"font-lato text-[10px] uppercase tracking-[0.3em] text-[var(--azul-profundo)]\">\n                    Sintonizando energias...\n                </span>\n            </div>\n        );\n    }\n\n    if (!collection) {\n        return (\n            <div className=\"min-h-screen flex flex-col items-center justify-center bg-[var(--branco-off-white)] p-4 text-center\">\n                <h2 className=\"font-playfair text-2xl text-[var(--azul-profundo)] mb-4\">\n                    Categoria n칚o encontrada\n                </h2>\n                <Link\n                    to=\"/loja\"\n                    className=\"text-[var(--dourado-suave)] font-lato text-xs uppercase tracking-widest border-b border-[var(--dourado-suave)]\"\n                >\n                    Voltar para a Loja\n                </Link>\n            </div>\n        );\n    }\n\n    const headerImageUrl = collection.imageUrl || collection.media?.mainMedia?.image?.url;\n\n    const categoryJsonLd = React.useMemo(() => {\n        if (!collection) return undefined;\n        const schema = {\n            \"@context\": \"https://schema.org\",\n            \"@type\": \"BreadcrumbList\",\n            \"itemListElement\": [\n                {\n                    \"@type\": \"ListItem\",\n                    \"position\": 1,\n                    \"name\": \"Home\",\n                    \"item\": window.location.origin\n                },\n                {\n                    \"@type\": \"ListItem\",\n                    \"position\": 2,\n                    \"name\": collection.name,\n                    \"item\": window.location.href\n                }\n            ]\n        };\n        return JSON.stringify(schema);\n    }, [collection]);\n\n    return (\n        <div className=\"bg-[var(--branco-off-white)] min-h-screen\">\n            <SEO\n                title={`Artigos para ${collection.name} | Melhores Pre칞os`}\n                description={collection.description || `Confira nossa sele칞칚o exclusiva de artigos para ${collection.name}. Velas, Guias, Ervas e tudo o que voc칡 precisa com a qualidade do Ateli칡.`}\n                image={collection.imageUrl || collection.media?.mainMedia?.image?.url}\n                keywords={`${collection.name}, artigos de umbanda, ateli칡 aruanda, ${collection.name} comprar`}\n                jsonLd={categoryJsonLd}\n            />\n\n            {/* HEADER DIN츽MICO DA CATEGORIA */}\n            <header className=\"relative h-[40vh] md:h-[50vh] flex items-center justify-center overflow-hidden bg-[var(--azul-profundo)]\">\n                {headerImageUrl ? (\n                    <OptimizedImage\n                        src={headerImageUrl}\n                        alt={collection.name}\n                        width={1920}\n                        height={600}\n                        priority={true}\n                        className=\"absolute inset-0 w-full h-full object-cover opacity-40 mix-blend-overlay\"\n                    />\n                ) : (\n                    <div className=\"absolute inset-0 bg-gradient-to-r from-[#0f2A44] to-[#1a4163]\"></div>\n                )}\n\n                <div className=\"relative z-10 text-center px-4 space-y-4\">\n                    <Link\n                        to=\"/loja\"\n                        className=\"inline-flex items-center gap-2 text-[var(--dourado-suave)] hover:text-[var(--branco-off-white)] transition-colors mb-4\"\n                    >\n                        <ChevronLeft size={16} />\n                        <span className=\"font-lato text-[10px] uppercase tracking-widest\">\n                            Todos os Produtos\n                        </span>\n                    </Link>\n                    <h1 className=\"font-playfair text-5xl md:text-7xl text-[var(--branco-off-white)] capitalize italic\">\n                        {collection.name}\n                    </h1>\n                    <div className=\"flex items-center justify-center gap-4\">\n                        <div className=\"h-[1px] w-12 bg-[var(--dourado-suave)]/50\"></div>\n                        <Sparkles size={16} className=\"text-[var(--dourado-suave)]\" />\n                        <div className=\"h-[1px] w-12 bg-[var(--dourado-suave)]/50\"></div>\n                    </div>\n                </div>\n            </header>\n\n            {/* CONTE칔DO */}\n            <section className=\"max-w-7xl mx-auto px-4 py-16 md:py-24\">\n                {/* DESCRI칂츾O DA CATEGORIA */}\n                {collection.description && (\n                    <div className=\"max-w-3xl mx-auto text-center mb-20\">\n                        <p className=\"font-lato text-base md:text-lg text-[var(--azul-profundo)]/70 leading-relaxed italic\">\n                            \"{collection.description}\"\n                        </p>\n                    </div>\n                )}\n\n                {/* GRID DE PRODUTOS */}\n                {products.length > 0 ? (\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-x-8 gap-y-16\">\n                        {products.map((product) => (\n                            <div key={product.id} className=\"animate-fade-in\">\n                                <ProductCard product={product} />\n                            </div>\n                        ))}\n                    </div>\n                ) : (\n                    <div className=\"text-center py-20 bg-white/50 border border-dashed border-[var(--azul-profundo)]/10 rounded-lg\">\n                        <Wind className=\"mx-auto text-[var(--azul-profundo)]/20 mb-4\" size={40} />\n                        <p className=\"font-lato text-[11px] uppercase tracking-widest text-[var(--azul-profundo)]/40\">\n                            Nenhum item dispon칤vel nesta categoria no momento.\n                        </p>\n                    </div>\n                )}\n            </section>\n\n            {/* FOOTER DE NAVEGA칂츾O R츼PIDA */}\n            <div className=\"max-w-7xl mx-auto px-4 pb-20\">\n                <div className=\"border-t border-[var(--azul-profundo)]/5 pt-10 flex flex-col md:flex-row justify-between items-center gap-6\">\n                    <h4 className=\"font-playfair text-[var(--azul-profundo)]/40 text-lg uppercase tracking-widest\">\n                        Explorar Outras Vertentes\n                    </h4>\n                    <div className=\"flex gap-8\">\n                        <Link\n                            to=\"/categoria/velas\"\n                            className=\"font-lato text-[10px] uppercase tracking-[0.2em] text-[var(--azul-profundo)] hover:text-[var(--dourado-suave)] transition-colors\"\n                        >\n                            Velas\n                        </Link>\n                        <Link\n                            to=\"/categoria/guias\"\n                            className=\"font-lato text-[10px] uppercase tracking-[0.2em] text-[var(--azul-profundo)] hover:text-[var(--dourado-suave)] transition-colors\"\n                        >\n                            Guias\n                        </Link>\n                        <Link\n                            to=\"/categoria/ervas\"\n                            className=\"font-lato text-[10px] uppercase tracking-[0.2em] text-[var(--azul-profundo)] hover:text-[var(--dourado-suave)] transition-colors\"\n                        >\n                            Ervas\n                        </Link>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default CategoryPage;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/CheckoutPage.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1006,1009],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1006,1009],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { render, screen, fireEvent, waitFor } from '../test-utils';\nimport CheckoutPage from './CheckoutPage';\nimport { cartService } from '../services/cartService';\nimport { orderService } from '../services/orderService';\nimport { describe, it, expect, vi, beforeEach, Mock } from 'vitest';\nimport { useLocation } from 'react-router-dom';\n\n// Mock services\nvi.mock('../services/cartService', () => ({\n    cartService: {\n        get: vi.fn(),\n        clear: vi.fn(),\n    },\n}));\n\nvi.mock('../services/orderService', () => ({\n    orderService: {\n        calculateShipping: vi.fn(),\n        createOrder: vi.fn(),\n    },\n}));\n\nvi.mock('../context/ToastContext', () => ({\n    useToast: vi.fn(() => ({ showToast: vi.fn() }))\n}));\n\nvi.mock('../context/AuthContext', () => ({\n    useAuth: vi.fn(() => ({ user: { name: 'Test User', email: 'test@example.com' } }))\n}));\n\n// Mock react-router-dom hooks\nconst mockNavigate = vi.fn();\nvi.mock('react-router-dom', async () => {\n    const actual = await vi.importActual<any>('react-router-dom');\n    return {\n        ...actual,\n        useNavigate: () => mockNavigate,\n        useLocation: vi.fn(),\n    };\n});\n\ndescribe('CheckoutPage Component', () => {\n    const mockCart = [\n        { id: '1', name: 'Vela de Arruda', price: 25, quantity: 2, image: '/images/vela.jpg' }\n    ];\n\n    const mockShipping = {\n        price: 15,\n        provider: 'Correios'\n    };\n\n    beforeEach(() => {\n        vi.clearAllMocks();\n        (cartService.get as Mock).mockResolvedValue(mockCart);\n        (useLocation as Mock).mockReturnValue({\n            state: { shippingSelected: mockShipping, cep: '' }\n        });\n    });\n\n    it('should render cart items and totals correctly', async () => {\n        render(<CheckoutPage />);\n\n        await waitFor(() => {\n            expect(screen.getByText('Vela de Arruda')).toBeInTheDocument();\n            expect(screen.getByText('Qtd: 2')).toBeInTheDocument();\n            expect(screen.getAllByText(/50,00/)[0]).toBeInTheDocument(); // Item total and Subtotal\n            expect(screen.getByText(/15,00/)).toBeInTheDocument(); // Frete\n            expect(screen.getByText(/65,00/)).toBeInTheDocument(); // Total\n        });\n    });\n\n    it('should show message when cart is empty', async () => {\n        (cartService.get as Mock).mockResolvedValue([]);\n        render(<CheckoutPage />);\n\n        await waitFor(() => {\n            expect(screen.getByText('Sua sacola est치 vazia.')).toBeInTheDocument();\n        });\n    });\n\n    it('should submit order successfully', async () => {\n        (orderService.createOrder as Mock).mockResolvedValue({ id: 'ORD-123' });\n\n        render(<CheckoutPage />);\n\n        await waitFor(() => {\n            expect(screen.getByPlaceholderText('E-mail para acompanhamento')).toBeInTheDocument();\n        });\n\n        fireEvent.change(screen.getByPlaceholderText('E-mail para acompanhamento'), { target: { value: 'cliente@teste.com' } });\n        fireEvent.change(screen.getByPlaceholderText('Nome'), { target: { value: 'Maria' } });\n        fireEvent.change(screen.getByPlaceholderText('Sobrenome'), { target: { value: 'Silva' } });\n        fireEvent.change(screen.getByPlaceholderText('Endere칞o e N칰mero'), { target: { value: 'Rua das Flores, 123' } });\n        fireEvent.change(screen.getByPlaceholderText('Cidade'), { target: { value: 'S칚o Paulo' } });\n        fireEvent.change(screen.getByPlaceholderText('UF'), { target: { value: 'SP' } });\n\n        const submitButton = screen.getByText('Finalizar Pedido');\n        fireEvent.click(submitButton);\n\n        await waitFor(() => {\n            expect(orderService.createOrder).toHaveBeenCalledWith(expect.objectContaining({\n                email: 'cliente@teste.com',\n                paymentMethod: 'pix' // Assumindo default\n            }));\n            expect(screen.getByText('Que o Ax칠 te acompanhe!')).toBeInTheDocument();\n            expect(screen.getByText(/ORD-123/)).toBeInTheDocument();\n        });\n    });\n});\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/CheckoutPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":71,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3395,3398],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3395,3398],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'cep', 'formData.cep', 'handleCalculateShipping', 'handleSelectAddress', 'user.document', 'user.email', 'user.id', and 'user.name'. Either include them or remove the dependency array.","line":134,"column":8,"nodeType":"ArrayExpression","endLine":134,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [cep, formData.cep, handleCalculateShipping, handleSelectAddress, user.document, user.email, user.id, user.name]","fix":{"range":[6076,6078],"text":"[cep, formData.cep, handleCalculateShipping, handleSelectAddress, user.document, user.email, user.id, user.name]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":165,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":165,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7751,7754],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7751,7754],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":180,"column":49,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":180,"endColumn":109,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[8808,8868],"text":"// @ts-expect-error - Complementando CreateOrderData se necess치rio"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":182,"column":49,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":182,"endColumn":62,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[9047,9060],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":189,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":189,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9504,9507],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9504,9507],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":198,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":198,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10087,10090],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10087,10090],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'total'. Either include it or remove the dependency array.","line":213,"column":8,"nodeType":"ArrayExpression","endLine":213,"endColumn":69,"suggestions":[{"desc":"Update the dependencies array to be: [mp, isConfigured, isAddingNewCard, formData.metodoPagamento, total]","fix":{"range":[10636,10697],"text":"[mp, isConfigured, isAddingNewCard, formData.metodoPagamento, total]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":267,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":267,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12869,12872],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12869,12872],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":327,"column":17,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":327,"endColumn":86,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[15336,15405],"text":"// @ts-expect-error - Estendendo se o backend usar 'shipping' opcionalmente"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":363,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":363,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17061,17064],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17061,17064],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":531,"column":110,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":531,"endColumn":113,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[29628,29631],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[29628,29631],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":614,"column":172,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":614,"endColumn":175,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[36514,36517],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[36514,36517],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":622,"column":174,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":622,"endColumn":177,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[37584,37587],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[37584,37587],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\nimport { useLocation, Link } from 'react-router-dom';\nimport { ChevronLeft, CreditCard, Truck, ShieldCheck, Check, CheckCircle, AlertCircle, Loader2, AlertTriangle } from 'lucide-react';\nimport { cartService } from '../services/cartService';\nimport { authService } from '../services/authService';\nimport { orderService } from '../services/orderService';\nimport marketingService from '../services/marketingService';\nimport { getImageUrl } from '../utils/imageUtils';\nimport SEO from '../components/SEO';\nimport { useMercadoPago } from '../hooks/useMercadoPago';\nimport { User, Address, Card, Coupon, ShippingOption, CartItem, Order, CreateOrderData } from '../types';\nimport { MaskedInput } from '../components/ui/MaskedInput';\nimport { isValidCPF, isValidCNPJ, sanitizeDocument } from '../utils/fiscal';\n\ninterface CheckoutFormData {\n    email: string;\n    nome: string;\n    sobrenome: string;\n    endereco: string;\n    cidade: string;\n    estado: string;\n    cep: string;\n    metodoPagamento: 'pix' | 'card';\n    saveAddress: boolean;\n    saveCard: boolean;\n    document: string;\n}\n\nconst CheckoutPage: React.FC = () => {\n    const location = useLocation();\n    const { shippingSelected, cep } = (location.state as { shippingSelected?: ShippingOption; cep?: string }) || {};\n\n    const [cart, setCart] = useState<CartItem[]>([]);\n    const [loading, setLoading] = useState<boolean>(false);\n    const [successOrder, setSuccessOrder] = useState<Order | null>(null);\n    const [couponCode, setCouponCode] = useState<string>('');\n    const [appliedCoupon, setAppliedCoupon] = useState<Coupon | null>(null);\n    const [couponError, setCouponError] = useState<string>('');\n    const [validatingCoupon, setValidatingCoupon] = useState<boolean>(false);\n\n    // Simplificado para evitar parse repetitivo\n    const user: Partial<User> = JSON.parse(localStorage.getItem('user') || '{}');\n\n    const [formData, setFormData] = useState<CheckoutFormData>({\n        email: user.email || '',\n        nome: user.name?.split(' ')[0] || '',\n        sobrenome: user.name?.split(' ').slice(1).join(' ') || '',\n        endereco: '',\n        cidade: '',\n        estado: '',\n        cep: cep || '',\n        metodoPagamento: 'pix',\n        saveAddress: false,\n        saveCard: false,\n        document: user.document || ''\n    });\n\n    const [savedAddresses, setSavedAddresses] = useState<Address[]>([]);\n    const [selectedAddressId, setSelectedAddressId] = useState<string | null>(null);\n    const [isAddingNewAddress, setIsAddingNewAddress] = useState<boolean>(!cep);\n    const [savedCards, setSavedCards] = useState<Card[]>([]);\n    const [selectedCardId, setSelectedCardId] = useState<string | null>(null);\n    const [isAddingNewCard, setIsAddingNewCard] = useState<boolean>(true);\n    const [shippingOptions, setShippingOptions] = useState<ShippingOption[]>([]);\n    const [shippingLoading, setShippingLoading] = useState<boolean>(false);\n    const [currentShipping, setCurrentShipping] = useState<ShippingOption | null>(shippingSelected || null);\n    const [configMissing, setConfigMissing] = useState<{ mp: boolean; shipping: boolean }>({ mp: false, shipping: false });\n\n    const { mp, loading: mpLoading, isConfigured, error: mpError } = useMercadoPago();\n    const [_cardForm, setCardForm] = useState<unknown>(null);\n    const cardFormRef = useRef<any>(null); // External SDK Ref usually needs any or complex interface\n    const pendingOrderRef = useRef<CreateOrderData | null>(null);\n\n    // C치lculos de pre칞o\n    const subtotal = Array.isArray(cart) ? cart.reduce((acc, item) => acc + (item.price * item.quantity), 0) : 0;\n    const discount = appliedCoupon\n        ? (appliedCoupon.type === 'PERCENTAGE' || appliedCoupon.discountType === 'PERCENTAGE'\n            ? (subtotal * (appliedCoupon.value / 100))\n            : appliedCoupon.value)\n        : 0;\n\n    // Aplicar desconto de 5% no PIX se n칚o houver cupom (ou conforme regra de neg칩cio)\n    const pixDiscount = formData.metodoPagamento === 'pix' ? (subtotal * 0.05) : 0;\n\n    const total = subtotal + (currentShipping?.price || 0) - discount - pixDiscount;\n\n    useEffect(() => {\n        const initCheckout = async () => {\n            const currentCart = await cartService.get();\n            setCart(currentCart);\n\n            if (user.id) {\n                setFormData(prev => ({\n                    ...prev,\n                    email: user.email || prev.email,\n                    nome: user.name?.split(' ')[0] || prev.nome,\n                    sobrenome: user.name?.split(' ').slice(1).join(' ') || prev.sobrenome,\n                    document: user.document || prev.document\n                }));\n\n                try {\n                    const addresses = await authService.address.get(user.id);\n                    setSavedAddresses(addresses);\n                    if (addresses.length > 0 && !cep) {\n                        setIsAddingNewAddress(false);\n                        // Seleciona o padr칚o se existir\n                        const def = addresses.find(a => a.isDefault);\n                        if (def) handleSelectAddress(def);\n                    }\n\n                    const cards = await authService.cards.get();\n                    setSavedCards(cards);\n                    if (cards.length > 0) {\n                        setIsAddingNewCard(false);\n                        setSelectedCardId(cards[0].id);\n                    }\n                } catch (e) {\n                    console.error(\"Erro ao carregar dados do usu치rio\", e);\n                }\n            }\n\n            if (formData.cep && formData.cep.length === 8 && currentCart.length > 0) {\n                handleCalculateShipping(formData.cep);\n            } else if (cep) {\n                handleCalculateShipping(cep);\n            }\n        };\n\n        const handleCartChange = () => initCheckout();\n        window.addEventListener('cart-updated', handleCartChange);\n        initCheckout();\n\n        return () => window.removeEventListener('cart-updated', handleCartChange);\n    }, []);\n\n    // Inicializa/Reseta CardForm\n    useEffect(() => {\n        let mounted = true;\n\n        const initCardForm = () => {\n            if (mp && isConfigured && isAddingNewCard && formData.metodoPagamento === 'card') {\n                if (!cardFormRef.current) {\n                    setTimeout(() => {\n                        if (!mounted) return;\n                        const container = document.getElementById('cardNumber');\n                        if (!container) return;\n\n                        try {\n                            const cf = mp.cardForm({\n                                amount: total.toFixed(2),\n                                iframe: true,\n                                form: {\n                                    id: 'form-checkout',\n                                    cardNumber: { id: 'cardNumber', placeholder: '0000 0000 0000 0000' },\n                                    expirationDate: { id: 'expirationDate', placeholder: 'MM/AA' },\n                                    securityCode: { id: 'securityCode', placeholder: 'CVV' },\n                                    cardholderName: { id: 'cardholderName' },\n                                    identificationType: { id: 'identificationType' },\n                                    identificationNumber: { id: 'identificationNumber' },\n                                    issuer: { id: 'issuer' },\n                                    installments: { id: 'installments' },\n                                    cardholderEmail: { id: 'cardholderEmail' }\n                                },\n                                callbacks: {\n                                    onFormMounted: (error: any) => {\n                                        if (error) console.error('Erro ao montar fields:', error);\n                                    },\n                                    onSubmit: async (event: React.FormEvent) => {\n                                        event.preventDefault();\n                                        setLoading(true);\n                                        try {\n                                            const cf = cardFormRef.current;\n                                            if (!cf) throw new Error(\"CardForm n칚o finalizou.\");\n                                            const cardData = cf.getCardFormData();\n                                            if (!cardData || !cardData.token) throw new Error(\"Erro na tokeniza칞칚o do cart칚o.\");\n\n                                            const order = pendingOrderRef.current;\n                                            if (order) {\n                                                order.paymentToken = cardData.token;\n                                                // @ts-ignore - Complementando CreateOrderData se necess치rio\n                                                order.installments = cardData.installments ? parseInt(cardData.installments) : 1;\n                                                // @ts-ignore\n                                                order.issuerId = cardData.issuer || null;\n\n                                                const result = await orderService.createOrder(order);\n                                                setSuccessOrder(result);\n                                                await cartService.clear();\n                                            }\n                                        } catch (error: any) {\n                                            window.dispatchEvent(new CustomEvent('show-alert', {\n                                                detail: error.message || \"Erro ao processar pagamento.\"\n                                            }));\n                                        } finally {\n                                            setLoading(false);\n                                            pendingOrderRef.current = null;\n                                        }\n                                    },\n                                    onError: (errors: any[]) => console.error('Erros no cardForm:', errors)\n                                }\n                            });\n                            setCardForm(cf);\n                            cardFormRef.current = cf;\n                        } catch (e) {\n                            console.error(\"Erro ao inicializar CardForm\", e);\n                        }\n                    }, 200);\n                }\n            }\n        };\n\n        if (formData.metodoPagamento === 'card') initCardForm();\n        return () => { mounted = false; };\n    }, [mp, isConfigured, isAddingNewCard, formData.metodoPagamento]);\n\n    const handleCalculateShipping = async (targetCep: string) => {\n        if (!targetCep || targetCep.length < 8) return;\n        setShippingLoading(true);\n        try {\n            const items = await cartService.get();\n            const options = await orderService.calculateShipping(targetCep, items);\n            const isMissing = options.some(o => o.provider === 'CONFIG_MISSING');\n            if (isMissing) {\n                setConfigMissing(prev => ({ ...prev, shipping: true }));\n                setShippingOptions([]);\n            } else {\n                setConfigMissing(prev => ({ ...prev, shipping: false }));\n                setShippingOptions(options);\n            }\n\n            if (currentShipping) {\n                const stillAvailable = options.find(o => o.provider === currentShipping.provider);\n                if (stillAvailable) setCurrentShipping(stillAvailable);\n                else setCurrentShipping(null);\n            } else if (options.length > 0) {\n                // Seleciona o primeiro por padr칚o\n                setCurrentShipping(options[0] || null);\n            }\n        } catch (e) {\n            console.error(\"Erro frete\", e);\n        } finally {\n            setShippingLoading(false);\n        }\n    };\n\n    const handleSelectAddress = (addr: Address) => {\n        const normalizedCep = addr.zipCode.replace(/\\D/g, '');\n        setSelectedAddressId(addr.id || null);\n        setIsAddingNewAddress(false);\n        setFormData(prev => ({\n            ...prev,\n            endereco: addr.street + (addr.number ? `, ${addr.number}` : '') + (addr.complement ? ` - ${addr.complement}` : ''),\n            cidade: addr.city,\n            estado: addr.state,\n            cep: normalizedCep,\n            document: addr.document || prev.document\n        }));\n        handleCalculateShipping(normalizedCep);\n    };\n\n    const handleApplyCoupon = async () => {\n        if (!couponCode || !user.id) return;\n        setValidatingCoupon(true);\n        setCouponError('');\n        try {\n            const result = await marketingService.validateCoupon(couponCode, user.id, subtotal);\n            setAppliedCoupon(result);\n        } catch (err: any) {\n            setCouponError(err.message || 'Erro ao validar cupom');\n            setAppliedCoupon(null);\n        } finally {\n            setValidatingCoupon(false);\n        }\n    };\n\n    const handleInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n        const { name, value } = e.target;\n        setFormData(prev => ({ ...prev, [name]: value }));\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n\n        // Valida칞칚o rigorosa de documento\n        const cleanDoc = sanitizeDocument(formData.document);\n        const isDocValid = cleanDoc.length === 11 ? isValidCPF(cleanDoc) : (cleanDoc.length === 14 ? isValidCNPJ(cleanDoc) : false);\n\n        if (!isDocValid) {\n            window.dispatchEvent(new CustomEvent('show-alert', {\n                detail: \"Por favor, insira um CPF ou CNPJ v치lido para a emiss칚o da Nota Fiscal.\"\n            }));\n            return;\n        }\n\n        setLoading(true);\n        try {\n            const userId = user.id || user.googleId;\n            // 1. Salvar endere칞o se solicitado\n            if (formData.saveAddress && isAddingNewAddress && userId) {\n                const parts = formData.endereco.split(',');\n                const addrData: Address = {\n                    label: 'Principal',\n                    street: parts[0]?.trim() || '',\n                    number: parts[1]?.trim() || 'S/N',\n                    neighborhood: 'Centro',\n                    city: formData.cidade,\n                    state: formData.estado,\n                    zipCode: formData.cep,\n                    complement: ''\n                };\n                await authService.address.create(userId, addrData);\n            }\n\n            // 2. Preparar dados do pedido\n            const parts = formData.endereco.split(',');\n            const order: CreateOrderData = {\n                items: cart.map(i => ({ productId: i.id, quantity: i.quantity, variantId: i.variantId })),\n                email: formData.email,\n                customerName: `${formData.nome} ${formData.sobrenome}`,\n                shippingAddress: {\n                    street: parts[0]?.trim() || '',\n                    number: parts[1]?.trim() || 'S/N',\n                    city: formData.cidade,\n                    state: formData.estado,\n                    zipCode: formData.cep,\n                    neighborhood: 'Centro' // Default or extracted\n                },\n                // @ts-ignore - Estendendo se o backend usar 'shipping' opcionalmente\n                shipping: {\n                    service: currentShipping?.provider,\n                    price: currentShipping?.price\n                },\n                paymentMethod: formData.metodoPagamento,\n                couponCode: appliedCoupon?.code,\n                customerDocument: sanitizeDocument(formData.document),\n                saveAddress: formData.saveAddress,\n                saveCard: formData.saveCard\n            };\n\n            // 3. L칩gica de Pagamento\n            if (formData.metodoPagamento === 'card') {\n                if (!isAddingNewCard && selectedCardId) {\n                    order.cardId = selectedCardId;\n                    const result = await orderService.createOrder(order);\n                    setSuccessOrder(result);\n                    await cartService.clear();\n                } else {\n                    const cf = cardFormRef.current;\n                    if (!cf) throw new Error(\"Sistema de pagamento n칚o inicializado. Aguarde.\");\n                    pendingOrderRef.current = order;\n                    const form = document.getElementById('form-checkout') as HTMLFormElement;\n                    if (form) {\n                        form.dispatchEvent(new Event('submit', { cancelable: true, bubbles: true }));\n                    } else {\n                        throw new Error(\"Formul치rio de cart칚o n칚o encontrado.\");\n                    }\n                    return;\n                }\n            } else {\n                const result = await orderService.createOrder(order);\n                setSuccessOrder(result);\n                await cartService.clear();\n            }\n        } catch (error: any) {\n            window.dispatchEvent(new CustomEvent('show-alert', {\n                detail: error.message || \"Erro ao processar o pedido. Tente novamente.\"\n            }));\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    if (successOrder) {\n        return (\n            <div className=\"min-h-screen bg-[var(--branco-off-white)] flex flex-col items-center justify-center p-4 text-center\">\n                <SEO title=\"Pedido Confirmado\" />\n                <div className=\"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center text-green-600 mb-8 animate-bounce\">\n                    <CheckCircle size={40} />\n                </div>\n                <h1 className=\"font-playfair text-4xl text-[var(--azul-profundo)] mb-4\">Que o Ax칠 te acompanhe!</h1>\n                <p className=\"font-lato text-base text-[var(--azul-profundo)]/60 mb-8 max-w-md\">\n                    Seu pedido <strong>#{successOrder.id}</strong> foi recebido com sucesso.\n                    Voc칡 receber치 um e-mail com os detalhes e o c칩digo de rastreio em breve.\n                </p>\n                <Link to=\"/\" className=\"bg-[var(--azul-profundo)] text-white px-10 py-4 font-lato text-xs uppercase tracking-widest hover:bg-[var(--dourado-suave)] transition-all\">\n                    Voltar para o In칤cio\n                </Link>\n            </div>\n        );\n    }\n\n    if (cart.length === 0 && !successOrder) {\n        return (\n            <div className=\"min-h-screen bg-[var(--branco-off-white)] flex flex-col items-center justify-center p-4\">\n                <SEO title=\"Checkout\" />\n                <p className=\"font-playfair text-xl text-[var(--azul-profundo)] mb-8\">Sua sacola est치 vazia.</p>\n                <Link to=\"/store\" className=\"text-[var(--dourado-suave)] font-lato text-xs uppercase tracking-widest border-b border-[var(--dourado-suave)]\">Ir para a Loja</Link>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"min-h-screen bg-[var(--branco-off-white)] pt-12 pb-24 px-4\">\n            <SEO title=\"Checkout\" description=\"Finalize sua compra com seguran칞a no Ateli칡 Filhos de Aruanda.\" />\n\n            {(configMissing.mp || configMissing.shipping || mpError) && (\n                <div className=\"max-w-6xl mx-auto mb-12 p-6 border border-amber-200 bg-amber-50 flex items-start gap-4 animate-in fade-in slide-in-from-top-4\">\n                    <AlertCircle className=\"text-amber-600 shrink-0\" size={20} />\n                    <div>\n                        <h3 className=\"font-lato text-xs font-bold uppercase tracking-widest text-amber-900 mb-1\">Aviso do Sistema</h3>\n                        <p className=\"font-lato text-xs text-amber-800/80 leading-relaxed\">\n                            Estamos finalizando os 칰ltimos ajustes t칠cnicos em nosso checkout.\n                            {(configMissing.mp || mpError) && \" Os m칠todos de pagamento via Cart칚o e Mercado Pago est칚o temporariamente indispon칤veis.\"}\n                            {configMissing.shipping && \" O c치lculo de frete autom치tico est치 em manuten칞칚o.\"}\n                            <br />Pedimos desculpas pelo transtorno. Por favor, tente novamente em alguns instantes ou entre em contato com nosso suporte.\n                        </p>\n                    </div>\n                </div>\n            )}\n\n            <div className=\"max-w-7xl mx-auto\">\n                <Link to=\"/\" className=\"inline-flex items-center gap-2 text-[var(--azul-profundo)]/40 hover:text-[var(--azul-profundo)] transition-colors mb-12\">\n                    <ChevronLeft size={16} />\n                    <span className=\"font-lato text-[10px] uppercase tracking-widest\">Voltar</span>\n                </Link>\n\n                <div className=\"flex flex-col lg:flex-row gap-16\">\n                    {/* Formul치rio */}\n                    <div className=\"flex-[1.5] space-y-12\">\n                        <section className=\"space-y-8\">\n                            <div className=\"flex items-center gap-4\">\n                                <span className=\"w-8 h-8 rounded-full bg-[var(--azul-profundo)] text-white flex items-center justify-center font-playfair text-sm\">1</span>\n                                <h2 className=\"font-playfair text-2xl text-[var(--azul-profundo)]\">Informa칞칫es de Contato</h2>\n                            </div>\n                            <div className=\"grid grid-cols-1 gap-6\">\n                                <input\n                                    type=\"email\" name=\"email\" required placeholder=\"E-mail para acompanhamento\"\n                                    value={formData.email} onChange={handleInputChange}\n                                    className=\"w-full border border-[var(--azul-profundo)]/10 bg-white px-6 py-4 font-lato text-sm outline-none focus:border-[var(--dourado-suave)]\"\n                                />\n                            </div>\n                        </section>\n\n                        <section className=\"space-y-8\">\n                            <div className=\"flex items-center gap-4\">\n                                <span className=\"w-8 h-8 rounded-full bg-[var(--azul-profundo)] text-white flex items-center justify-center font-playfair text-sm\">2</span>\n                                <h2 className=\"font-playfair text-2xl text-[var(--azul-profundo)]\">Identifica칞칚o Fiscal</h2>\n                            </div>\n                            <div className=\"grid grid-cols-1 gap-6\">\n                                <MaskedInput\n                                    mask=\"cpf-cnpj\"\n                                    required\n                                    label=\"CPF ou CNPJ (para Nota Fiscal)\"\n                                    placeholder=\"000.000.000-00 ou 00.000.000/0000-00\"\n                                    value={formData.document}\n                                    onChange={(val) => setFormData(prev => ({ ...prev, document: val }))}\n                                    className=\"border-[var(--azul-profundo)]/10\"\n                                />\n                                <p className=\"font-lato text-[10px] text-[var(--azul-profundo)]/40 uppercase tracking-widest leading-relaxed\">\n                                    Necess치rio para a emiss칚o da Nota Fiscal Eletr칪nica (NF-e).\n                                </p>\n                            </div>\n                        </section>\n\n                        <section className=\"space-y-8\">\n                            <div className=\"flex items-center gap-4\">\n                                <span className=\"w-8 h-8 rounded-full bg-[var(--azul-profundo)] text-white flex items-center justify-center font-playfair text-sm\">3</span>\n                                <h2 className=\"font-playfair text-2xl text-[var(--azul-profundo)]\">Endere칞o de Entrega</h2>\n                            </div>\n\n                            {savedAddresses.length > 0 && (\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8\">\n                                    {savedAddresses.map(addr => (\n                                        <div\n                                            key={addr.id}\n                                            onClick={() => handleSelectAddress(addr)}\n                                            className={`p-4 border cursor-pointer transition-all ${selectedAddressId === addr.id && !isAddingNewAddress ? 'border-[var(--dourado-suave)] bg-[var(--dourado-suave)]/5' : 'border-[var(--azul-profundo)]/10 bg-white hover:border-[var(--dourado-suave)]/30'}`}\n                                        >\n                                            <div className=\"flex justify-between items-start mb-2\">\n                                                <span className=\"font-lato text-[10px] font-bold uppercase tracking-widest text-[var(--azul-profundo)]\">{addr.street}, {addr.number}</span>\n                                                {selectedAddressId === addr.id && !isAddingNewAddress && <Check size={14} className=\"text-[var(--dourado-suave)]\" />}\n                                            </div>\n                                            <p className=\"font-lato text-xs text-[var(--azul-profundo)]/60 line-clamp-1\">{addr.city} - {addr.state}</p>\n                                            <p className=\"font-lato text-[10px] text-[var(--azul-profundo)]/40 mt-1\">{addr.zipCode}</p>\n                                        </div>\n                                    ))}\n                                    <button\n                                        onClick={() => {\n                                            setIsAddingNewAddress(true);\n                                            setSelectedAddressId(null);\n                                            setFormData(prev => ({ ...prev, endereco: '', cidade: '', estado: '', cep: '' }));\n                                        }}\n                                        className={`p-4 border border-dashed flex items-center justify-center gap-2 font-lato text-[10px] uppercase tracking-widest transition-all ${isAddingNewAddress ? 'border-[var(--dourado-suave)] text-[var(--dourado-suave)] bg-[var(--dourado-suave)]/5' : 'border-[var(--azul-profundo)]/20 text-[var(--azul-profundo)]/40 hover:border-[var(--azul-profundo)]/40 hover:text-[var(--azul-profundo)]/60'}`}\n                                    >\n                                        + Novo Endere칞o\n                                    </button>\n                                </div>\n                            )}\n\n                            {isAddingNewAddress && (\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 animate-in fade-in slide-in-from-top-4\">\n                                    <input\n                                        type=\"text\" name=\"nome\" required placeholder=\"Nome\"\n                                        value={formData.nome} onChange={handleInputChange}\n                                        className=\"w-full border border-[var(--azul-profundo)]/10 bg-white px-6 py-4 font-lato text-sm outline-none focus:border-[var(--dourado-suave)]\"\n                                    />\n                                    <input\n                                        type=\"text\" name=\"sobrenome\" required placeholder=\"Sobrenome\"\n                                        value={formData.sobrenome} onChange={handleInputChange}\n                                        className=\"w-full border border-[var(--azul-profundo)]/10 bg-white px-6 py-4 font-lato text-sm outline-none focus:border-[var(--dourado-suave)]\"\n                                    />\n                                    <input\n                                        type=\"text\" name=\"endereco\" required placeholder=\"Endere칞o e N칰mero\"\n                                        value={formData.endereco} onChange={handleInputChange}\n                                        className=\"md:col-span-2 w-full border border-[var(--azul-profundo)]/10 bg-white px-6 py-4 font-lato text-sm outline-none focus:border-[var(--dourado-suave)]\"\n                                    />\n                                    <input\n                                        type=\"text\" name=\"cidade\" required placeholder=\"Cidade\"\n                                        value={formData.cidade} onChange={handleInputChange}\n                                        className=\"w-full border border-[var(--azul-profundo)]/10 bg-white px-6 py-4 font-lato text-sm outline-none focus:border-[var(--dourado-suave)]\"\n                                    />\n                                    <div className=\"grid grid-cols-2 gap-6\">\n                                        <input\n                                            type=\"text\" name=\"estado\" required placeholder=\"UF\"\n                                            value={formData.estado} onChange={handleInputChange}\n                                            className=\"w-full border border-[var(--azul-profundo)]/10 bg-white px-6 py-4 font-lato text-sm outline-none focus:border-[var(--dourado-suave)]\"\n                                        />\n                                        <input\n                                            type=\"text\" name=\"cep\" required placeholder=\"CEP\"\n                                            value={formData.cep} onChange={(e) => {\n                                                const val = e.target.value.replace(/\\D/g, '').substring(0, 8);\n                                                handleInputChange({ target: { name: 'cep', value: val } } as any);\n                                                if (val.length === 8) handleCalculateShipping(val);\n                                            }}\n                                            className=\"w-full border border-[var(--azul-profundo)]/10 bg-white px-6 py-4 font-lato text-sm outline-none focus:border-[var(--dourado-suave)]\"\n                                        />\n                                    </div>\n                                    {user.id && (\n                                        <label className=\"md:col-span-2 flex items-center gap-2 cursor-pointer\">\n                                            <input\n                                                type=\"checkbox\"\n                                                checked={formData.saveAddress}\n                                                onChange={(e) => setFormData(prev => ({ ...prev, saveAddress: e.target.checked }))}\n                                                className=\"accent-[var(--azul-profundo)]\"\n                                            />\n                                            <span className=\"font-lato text-[10px] uppercase tracking-widest text-[var(--azul-profundo)]/60\">Salvar este endere칞o para futuras compras</span>\n                                        </label>\n                                    )}\n                                </div>\n                            )}\n                        </section>\n\n                        <section className=\"space-y-8\">\n                            <div className=\"flex items-center gap-4\">\n                                <span className=\"w-8 h-8 rounded-full bg-[var(--azul-profundo)] text-white flex items-center justify-center font-playfair text-sm\">4</span>\n                                <h2 className=\"font-playfair text-2xl text-[var(--azul-profundo)]\">Escolha o Frete</h2>\n                            </div>\n\n                            {shippingLoading ? (\n                                <div className=\"flex items-center gap-3 text-[var(--azul-profundo)]/40 p-8 border border-dashed border-[var(--azul-profundo)]/10\">\n                                    <Loader2 size={16} className=\"animate-spin\" />\n                                    <span className=\"font-lato text-xs uppercase tracking-widest\">Calculando op칞칫es de frete...</span>\n                                </div>\n                            ) : shippingOptions.length > 0 ? (\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                                    {shippingOptions.map((opt, i) => (\n                                        <label\n                                            key={i}\n                                            className={`flex items-center justify-between p-6 border cursor-pointer transition-colors ${currentShipping?.provider === opt.provider ? 'border-[var(--dourado-suave)] bg-[var(--dourado-suave)]/5' : 'border-[var(--azul-profundo)]/10 bg-white hover:border-[var(--dourado-suave)]/30'}`}\n                                        >\n                                            <div className=\"flex items-center gap-4\">\n                                                <input\n                                                    type=\"radio\"\n                                                    name=\"shipping\"\n                                                    checked={currentShipping?.provider === opt.provider}\n                                                    onChange={() => setCurrentShipping(opt)}\n                                                    className=\"accent-[var(--azul-profundo)]\"\n                                                />\n                                                <div className=\"flex flex-col\">\n                                                    <span className=\"font-lato text-sm font-bold uppercase tracking-widest text-[var(--azul-profundo)]\">{opt.provider}</span>\n                                                    <span className=\"font-lato text-[10px] text-[var(--azul-profundo)]/40\">{opt.days} dias 칰teis</span>\n                                                </div>\n                                            </div>\n                                            <span className=\"font-lato text-sm font-bold text-[var(--azul-profundo)]\">\n                                                {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(opt.price)}\n                                            </span>\n                                        </label>\n                                    ))}\n                                </div>\n                            ) : (\n                                <div className=\"bg-gray-50 p-8 border border-[var(--azul-profundo)]/5 flex flex-col items-center gap-4 text-center\">\n                                    <Truck size={32} className=\"text-[var(--azul-profundo)]/10\" />\n                                    <p className=\"font-lato text-xs text-[var(--azul-profundo)]/40 uppercase tracking-widest max-w-[200px]\">\n                                        {configMissing.shipping\n                                            ? \"C치lculo de frete em manuten칞칚o. Por favor, tente novamente mais tarde.\"\n                                            : (formData.cep.length === 8 ? \"Nenhuma op칞칚o de frete dispon칤vel para este CEP.\" : \"Insira um CEP v치lido para ver as op칞칫es de frete.\")\n                                        }\n                                    </p>\n                                </div>\n                            )}\n                        </section>\n\n                        <section className=\"space-y-8\">\n                            <div className=\"flex items-center gap-4\">\n                                <span className=\"w-8 h-8 rounded-full bg-[var(--azul-profundo)] text-white flex items-center justify-center font-playfair text-sm\">5</span>\n                                <h2 className=\"font-playfair text-2xl text-[var(--azul-profundo)]\">Pagamento</h2>\n                            </div>\n                            {mpLoading ? (\n                                <div className=\"p-8 flex justify-center\">\n                                    <Loader2 size={32} className=\"animate-spin text-[var(--dourado-suave)]\" />\n                                </div>\n                            ) : (\n                                <div className=\"space-y-4\">\n                                    <label className={`flex items-center gap-4 p-6 border cursor-pointer transition-colors ${formData.metodoPagamento === 'pix' ? 'border-[var(--dourado-suave)] bg-[var(--dourado-suave)]/5' : 'border-[var(--azul-profundo)]/10 bg-white hover:border-[var(--dourado-suave)]/50'}`}>\n                                        <input type=\"radio\" name=\"metodoPagamento\" value=\"pix\" checked={formData.metodoPagamento === 'pix'} onChange={handleInputChange as any} className=\"accent-[var(--azul-profundo)]\" />\n                                        <div className=\"flex items-center gap-3\">\n                                            <div className=\"w-10 h-10 bg-white rounded flex items-center justify-center text-[var(--azul-profundo)] shadow-sm italic font-bold\">PIX</div>\n                                            <span className=\"font-lato text-sm font-bold uppercase tracking-widest text-[var(--azul-profundo)]\">Pix com 5% de desconto</span>\n                                        </div>\n                                    </label>\n\n                                    <label className={`flex items-center gap-4 p-6 border cursor-pointer transition-colors ${formData.metodoPagamento === 'card' ? 'border-[var(--dourado-suave)] bg-[var(--dourado-suave)]/5' : 'border-[var(--azul-profundo)]/10 bg-white hover:border-[var(--dourado-suave)]/50'}`}>\n                                        <input type=\"radio\" name=\"metodoPagamento\" value=\"card\" checked={formData.metodoPagamento === 'card'} onChange={handleInputChange as any} className=\"accent-[var(--azul-profundo)]\" />\n                                        <div className=\"flex items-center gap-3\">\n                                            <div className=\"w-10 h-10 bg-white rounded flex items-center justify-center text-[var(--azul-profundo)] shadow-sm\">\n                                                <CreditCard size={20} />\n                                            </div>\n                                            <span className=\"font-lato text-sm font-bold uppercase tracking-widest text-[var(--azul-profundo)]\">Cart칚o de Cr칠dito / D칠bito</span>\n                                        </div>\n                                    </label>\n\n                                    {formData.metodoPagamento === 'card' && (\n                                        <div className=\"space-y-4 animate-in fade-in slide-in-from-top-4\">\n                                            {savedCards.length > 0 && (\n                                                <div className=\"grid grid-cols-1 gap-3\">\n                                                    {savedCards.map(card => (\n                                                        <div\n                                                            key={card.id}\n                                                            onClick={() => { setSelectedCardId(card.id); setIsAddingNewCard(false); }}\n                                                            className={`p-4 border flex items-center justify-between cursor-pointer transition-all ${selectedCardId === card.id && !isAddingNewCard ? 'border-[var(--dourado-suave)] bg-[var(--dourado-suave)]/5' : 'border-[var(--azul-profundo)]/10 bg-white'}`}\n                                                        >\n                                                            <div className=\"flex items-center gap-4\">\n                                                                <div className=\"w-10 h-6 bg-gray-100 rounded flex items-center justify-center font-bold text-[8px] uppercase\">{card.payment_method?.id || 'CARD'}</div>\n                                                                <div>\n                                                                    <p className=\"font-lato text-xs font-bold text-[var(--azul-profundo)]\">**** **** **** {card.last_four_digits}</p>\n                                                                    <p className=\"font-lato text-[10px] text-[var(--azul-profundo)]/40\">Expira em {card.expiration_month}/{card.expiration_year}</p>\n                                                                </div>\n                                                            </div>\n                                                            {selectedCardId === card.id && !isAddingNewCard && <Check size={14} className=\"text-[var(--dourado-suave)]\" />}\n                                                        </div>\n                                                    ))}\n                                                    <button\n                                                        onClick={() => { setIsAddingNewCard(true); setSelectedCardId(null); }}\n                                                        className={`p-4 border border-dashed flex items-center justify-center gap-2 font-lato text-[10px] uppercase tracking-widest transition-all ${isAddingNewCard ? 'border-[var(--dourado-suave)] text-[var(--dourado-suave)] bg-[var(--dourado-suave)]/5' : 'border-[var(--azul-profundo)]/20 text-[var(--azul-profundo)]/40 hover:border-[var(--azul-profundo)]/40 hover:text-[var(--azul-profundo)]/60'}`}\n                                                    >\n                                                        + Novo Cart칚o\n                                                    </button>\n                                                </div>\n                                            )}\n\n                                            {isAddingNewCard && (\n                                                <div className=\"p-6 border border-[var(--azul-profundo)]/10 bg-white\">\n                                                    <h3 className=\"font-lato text-xs font-bold uppercase tracking-widest text-[var(--azul-profundo)] mb-6 flex items-center gap-2\">\n                                                        <ShieldCheck size={16} className=\"text-green-600\" /> Novo Cart칚o via Mercado Pago\n                                                    </h3>\n                                                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                                                        {!isConfigured && !mpLoading ? (\n                                                            <div className=\"md:col-span-2 bg-amber-50 border border-amber-200 p-4 rounded text-amber-800 text-xs flex items-start gap-3\">\n                                                                <AlertTriangle size={18} className=\"shrink-0\" />\n                                                                <div>\n                                                                    <p className=\"font-bold uppercase tracking-widest mb-1\">Pagamento com Cart칚o Indispon칤vel</p>\n                                                                    <p className=\"opacity-80\">A configura칞칚o do Mercado Pago est치 pendente. Por favor, utilize PIX ou aguarde a ativa칞칚o pelo administrador.</p>\n                                                                </div>\n                                                            </div>\n                                                        ) : (\n                                                            <form id=\"form-checkout\" className=\"contents\">\n                                                                <input type=\"hidden\" id=\"cardholderEmail\" value={formData.email} />\n                                                                <div className=\"md:col-span-2\">\n                                                                    <label className=\"block text-xs text-gray-500 mb-1\">N칰mero do Cart칚o</label>\n                                                                    <div id=\"cardNumber\" className=\"h-12 border border-[var(--azul-profundo)]/10 bg-gray-50 px-4 py-3 shadow-inner\"></div>\n                                                                </div>\n                                                                <div className=\"md:col-span-2\">\n                                                                    <label className=\"block text-xs text-gray-500 mb-1\">Nome Impresso no Cart칚o</label>\n                                                                    <input type=\"text\" id=\"cardholderName\" placeholder=\"JOAO M SILVA\" className=\"w-full border border-[var(--azul-profundo)]/10 bg-gray-50 px-4 py-3 font-lato text-sm outline-none focus:border-[var(--dourado-suave)] uppercase shadow-inner\" />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-xs text-gray-500 mb-1\">Validade</label>\n                                                                    <div id=\"expirationDate\" className=\"h-12 border border-[var(--azul-profundo)]/10 bg-gray-50 px-4 py-3 shadow-inner\"></div>\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-xs text-gray-500 mb-1\">CVV</label>\n                                                                    <div id=\"securityCode\" className=\"h-12 border border-[var(--azul-profundo)]/10 bg-gray-50 px-4 py-3 shadow-inner\"></div>\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-xs text-gray-500 mb-1\">Tipo de Doc.</label>\n                                                                    <select id=\"identificationType\" className=\"w-full h-12 border border-[var(--azul-profundo)]/10 bg-gray-50 px-4 py-3 font-lato text-sm outline-none focus:border-[var(--dourado-suave)] shadow-inner\"></select>\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-xs text-gray-500 mb-1\">N칰mero do Doc.</label>\n                                                                    <input type=\"text\" id=\"identificationNumber\" placeholder=\"CPF/CNPJ\" className=\"w-full border border-[var(--azul-profundo)]/10 bg-gray-50 px-4 py-3 font-lato text-sm outline-none focus:border-[var(--dourado-suave)] shadow-inner\" />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-xs text-gray-500 mb-1\">Banco Emissor</label>\n                                                                    <select id=\"issuer\" className=\"w-full h-12 border border-[var(--azul-profundo)]/10 bg-gray-50 px-4 py-3 font-lato text-sm outline-none focus:border-[var(--dourado-suave)] shadow-inner\"></select>\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-xs text-gray-500 mb-1\">Parcelamento</label>\n                                                                    <select id=\"installments\" className=\"w-full h-12 border border-[var(--azul-profundo)]/10 bg-gray-50 px-4 py-3 font-lato text-sm outline-none focus:border-[var(--dourado-suave)] shadow-inner\"></select>\n                                                                </div>\n                                                            </form>\n                                                        )}\n\n                                                        {user.id && (\n                                                            <label className=\"md:col-span-2 flex items-center gap-2 cursor-pointer mt-2\">\n                                                                <input\n                                                                    type=\"checkbox\"\n                                                                    checked={formData.saveCard}\n                                                                    onChange={(e) => setFormData(prev => ({ ...prev, saveCard: e.target.checked }))}\n                                                                    className=\"accent-[var(--azul-profundo)]\"\n                                                                />\n                                                                <span className=\"font-lato text-[10px] uppercase tracking-widest text-[var(--azul-profundo)]/60\">Salvar este cart칚o para futuras compras</span>\n                                                            </label>\n                                                        )}\n                                                    </div>\n                                                </div>\n                                            )}\n                                        </div>\n                                    )}\n                                </div>\n                            )}\n                        </section>\n                    </div>\n\n                    {/* Resumo */}\n                    <div className=\"flex-1\">\n                        <div className=\"sticky top-32 space-y-8\">\n                            <div className=\"bg-white p-8 border border-[#0f2A44]/5 shadow-sm space-y-8\">\n                                <h2 className=\"font-playfair text-2xl text-[#0f2A44]\">Resumo do Pedido</h2>\n\n                                <div className=\"space-y-6\">\n                                    {cart.map((item, idx) => (\n                                        <div key={idx} className=\"flex justify-between items-start gap-4\">\n                                            <div className=\"flex gap-4\">\n                                                <div className=\"w-12 h-16 bg-[#F7F7F4] overflow-hidden flex-shrink-0\">\n                                                    <img\n                                                        src={getImageUrl(item.image || '')}\n                                                        alt={item.name}\n                                                        onError={(e: React.SyntheticEvent<HTMLImageElement, Event>) => { (e.target as HTMLImageElement).src = '/images/default.png'; }}\n                                                        className=\"w-full h-full object-cover\"\n                                                    />\n                                                </div>\n                                                <div>\n                                                    <p className=\"font-lato text-[11px] font-bold text-[#0f2A44] uppercase line-clamp-2\">{item.name}</p>\n                                                    <p className=\"font-lato text-[10px] text-[#0f2A44]/40\">Qtd: {item.quantity}</p>\n                                                </div>\n                                            </div>\n                                            <span className=\"font-lato text-xs text-[#0f2A44] whitespace-nowrap\">\n                                                {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(item.price * item.quantity)}\n                                            </span>\n                                        </div>\n                                    ))}\n                                </div>\n\n                                <div className=\"border-t border-[#0f2A44]/5 pt-6 space-y-3\">\n                                    <div className=\"flex justify-between text-[#0f2A44]/60 font-lato text-xs\">\n                                        <span>Subtotal</span>\n                                        <span>{new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(subtotal)}</span>\n                                    </div>\n                                    <div className=\"flex justify-between text-[#0f2A44]/60 font-lato text-xs\">\n                                        <div className=\"flex items-center gap-2\">\n                                            <Truck size={14} className=\"text-[#C9A24D]\" />\n                                            <span>Frete ({currentShipping?.provider || 'A calcular'})</span>\n                                        </div>\n                                        <span>{currentShipping ? new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(currentShipping.price) : ''}</span>\n                                    </div>\n\n                                    {appliedCoupon && (\n                                        <div className=\"flex justify-between text-green-600 font-lato text-xs font-bold\">\n                                            <span>Desconto ({appliedCoupon.code})</span>\n                                            <span>-{new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(discount)}</span>\n                                        </div>\n                                    )}\n\n                                    {pixDiscount > 0 && (\n                                        <div className=\"flex justify-between text-green-600 font-lato text-xs font-bold\">\n                                            <span>Desconto Pix (5%)</span>\n                                            <span>-{new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(pixDiscount)}</span>\n                                        </div>\n                                    )}\n\n                                    <div className=\"flex justify-between text-[#0f2A44] font-lato text-lg font-bold pt-4 border-t border-[#0f2A44]/5\">\n                                        <span>Total</span>\n                                        <span>{new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(total)}</span>\n                                    </div>\n                                </div>\n\n                                {/* Cupom */}\n                                <div className=\"pt-4 border-t border-[#0f2A44]/5\">\n                                    <div className=\"flex gap-2\">\n                                        <input\n                                            type=\"text\"\n                                            placeholder=\"CUPOM DE DESCONTO\"\n                                            value={couponCode}\n                                            onChange={(e) => setCouponCode(e.target.value.toUpperCase())}\n                                            className=\"flex-1 border border-[var(--azul-profundo)]/10 bg-gray-50 px-4 py-3 font-lato text-[10px] outline-none focus:border-[var(--dourado-suave)]\"\n                                        />\n                                        <button\n                                            onClick={handleApplyCoupon}\n                                            disabled={validatingCoupon || !couponCode}\n                                            className=\"bg-[var(--azul-profundo)] text-white px-4 py-3 font-lato text-[10px] uppercase tracking-widest hover:bg-[var(--dourado-suave)] transition-all disabled:opacity-30\"\n                                        >\n                                            {validatingCoupon ? <Loader2 size={14} className=\"animate-spin\" /> : 'Aplicar'}\n                                        </button>\n                                    </div>\n                                    {couponError && <p className=\"text-[10px] text-red-500 mt-2 font-bold\">{couponError}</p>}\n                                    {appliedCoupon && <p className=\"text-[10px] text-green-600 mt-2 font-bold\">九 Cupom aplicado!</p>}\n                                </div>\n\n                                <button\n                                    onClick={handleSubmit}\n                                    disabled={loading || !currentShipping || !formData.email || !formData.nome || !formData.document || (formData.metodoPagamento === 'card' && isAddingNewCard && !isConfigured)}\n                                    className=\"w-full bg-[var(--azul-profundo)] text-white py-5 font-lato text-xs uppercase tracking-[0.3em] hover:bg-[var(--dourado-suave)] transition-all disabled:opacity-30 flex items-center justify-center gap-3 shadow-lg\"\n                                >\n                                    {loading ? <Loader2 size={20} className=\"animate-spin\" /> : 'Finalizar Pedido'}\n                                </button>\n                            </div>\n\n                            <div className=\"flex flex-col items-center gap-4 opacity-40\">\n                                <div className=\"flex items-center gap-4\">\n                                    <div className=\"w-8 h-8 rounded bg-gray-200\" />\n                                    <div className=\"w-8 h-8 rounded bg-gray-200\" />\n                                    <div className=\"w-8 h-8 rounded bg-gray-200\" />\n                                </div>\n                                <p className=\"font-lato text-[10px] uppercase tracking-widest\">Pagamento 100% Seguro</p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default CheckoutPage;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/ContactPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/EthicsPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/FAQPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/FavoritesPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/HistoryPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/Home.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/OrderDetailPage.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/OrderDetailPage.tsx:37:13\n  35 |     useEffect(() => {\n  36 |         if (id) {\n> 37 |             setLoading(true);\n     |             ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  38 |             orderService.getOrderById(id)\n  39 |                 .then(data => setOrder(data))\n  40 |                 .catch(() => setError('Pedido n칚o encontrado.'))","line":37,"column":13,"nodeType":null,"endLine":37,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useParams, Link, useOutletContext } from 'react-router-dom';\nimport { ChevronLeft, Package, Truck, CreditCard, MapPin, Clock, CheckCircle, Loader2, AlertCircle, LucideIcon } from 'lucide-react';\nimport SEO from '../components/SEO';\nimport { orderService } from '../services/orderService';\nimport { getImageUrl } from '../utils/imageUtils';\nimport { User, Order } from '../types';\n\ninterface UserContext {\n    user: User | null;\n}\n\ninterface StatusConfig {\n    label: string;\n    color: string;\n    icon: LucideIcon;\n}\n\nconst statusMap: Record<string, StatusConfig> = {\n    PENDING: { label: 'Pendente', color: 'bg-yellow-100 text-yellow-700', icon: Clock },\n    PAID: { label: 'Pago', color: 'bg-blue-100 text-blue-700', icon: CreditCard },\n    READY_FOR_SHIPPING: { label: 'Pronto p/ Envio', color: 'bg-orange-100 text-orange-700', icon: Package },\n    SHIPPED: { label: 'Enviado', color: 'bg-indigo-100 text-indigo-700', icon: Truck },\n    DELIVERED: { label: 'Entregue', color: 'bg-green-100 text-green-700', icon: CheckCircle },\n    CANCELLED: { label: 'Cancelado', color: 'bg-red-100 text-red-700', icon: AlertCircle },\n};\n\nconst OrderDetailPage: React.FC = () => {\n    const { id } = useParams<{ id: string }>();\n    const { user } = useOutletContext<UserContext>();\n    const [order, setOrder] = useState<Order | null>(null);\n    const [loading, setLoading] = useState<boolean>(true);\n    const [error, setError] = useState<string>('');\n\n    useEffect(() => {\n        if (id) {\n            setLoading(true);\n            orderService.getOrderById(id)\n                .then(data => setOrder(data))\n                .catch(() => setError('Pedido n칚o encontrado.'))\n                .finally(() => setLoading(false));\n        }\n    }, [id]);\n\n    if (!user) return null;\n\n    if (loading) return (\n        <div className=\"flex justify-center items-center h-64\">\n            <Loader2 className=\"animate-spin text-blue-500\" size={28} />\n        </div>\n    );\n\n    if (error || !order) return (\n        <div className=\"max-w-4xl mx-auto px-4 pt-8 text-center\">\n            <AlertCircle size={48} className=\"mx-auto text-gray-300 mb-4\" />\n            <h2 className=\"text-lg font-semibold text-gray-700 mb-2\">{error || 'Pedido n칚o encontrado'}</h2>\n            <Link to=\"/perfil/compras\" className=\"text-blue-500 text-sm hover:underline\"> Voltar para compras</Link>\n        </div>\n    );\n\n    const status = (order.status && statusMap[order.status]) || statusMap.PENDING;\n    const StatusIcon = status?.icon || Package;\n    const total = order.totalAmount || order.total || 0;\n    const createdAt = order.createdAt ? new Date(order.createdAt).toLocaleDateString('pt-BR', { day: 'numeric', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit' }) : '';\n\n    return (\n        <div className=\"w-full pb-12 font-lato\">\n            <SEO title={`Pedido #${order.id?.slice(0, 8) || ''}`} />\n\n            <div className=\"max-w-4xl mx-auto px-4 pt-8\">\n                {/* Breadcrumb */}\n                <Link to=\"/perfil/compras\" className=\"inline-flex items-center gap-1 text-sm text-gray-500 hover:text-blue-500 transition-colors mb-6\">\n                    <ChevronLeft size={16} /> Voltar para Compras\n                </Link>\n\n                {/* Header */}\n                <div className=\"bg-white rounded-md shadow-sm border border-gray-200 p-6 mb-6\">\n                    <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\n                        <div>\n                            <h1 className=\"text-xl font-bold text-gray-800 mb-1\">\n                                Pedido #{order.id?.slice(0, 8).toUpperCase() || order.externalId || ''}\n                            </h1>\n                            <p className=\"text-sm text-gray-500\">{createdAt}</p>\n                        </div>\n                        <span className={`px-3 py-1.5 text-xs uppercase font-bold tracking-wider rounded flex items-center gap-1.5 w-fit ${status?.color || ''}`}>\n                            {StatusIcon && <StatusIcon size={14} />}\n                            {status?.label}\n                        </span>\n                    </div>\n                </div>\n\n                <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n                    {/* Itens do Pedido */}\n                    <div className=\"lg:col-span-2 bg-white rounded-md shadow-sm border border-gray-200 overflow-hidden\">\n                        <div className=\"px-6 py-4 bg-gray-50 border-b border-gray-200\">\n                            <h2 className=\"text-sm font-bold text-gray-800 flex items-center gap-2\">\n                                <Package size={16} /> Itens do Pedido\n                            </h2>\n                        </div>\n                        <div className=\"divide-y divide-gray-100\">\n                            {(order.items || []).map((item, idx) => (\n                                <div key={idx} className=\"p-6 flex items-center gap-4\">\n                                    <div className=\"w-16 h-16 shrink-0 border border-gray-200 rounded p-1 flex items-center justify-center overflow-hidden bg-gray-50\">\n                                        <img\n                                            src={getImageUrl(item.productImage || item.product?.images?.[0] || '')}\n                                            alt={item.productName || item.product?.name || item.product?.title}\n                                            onError={(e: React.SyntheticEvent<HTMLImageElement, Event>) => {\n                                                const target = e.target as HTMLImageElement;\n                                                target.src = '/images/default.png';\n                                            }}\n                                            className=\"max-w-full max-h-full object-contain\"\n                                        />\n                                    </div>\n                                    <div className=\"flex-1\">\n                                        <p className=\"text-sm font-semibold text-gray-800\">\n                                            {item.productName || item.product?.name || item.product?.title || 'Produto'}\n                                        </p>\n                                        <p className=\"text-xs text-gray-400 mt-1\">Qtd: {item.quantity}</p>\n                                    </div>\n                                    <div className=\"text-sm font-bold text-gray-800\">\n                                        {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(item.subtotal || ((item.unitPrice || item.price || 0) * item.quantity) || 0)}\n                                    </div>\n                                </div>\n                            ))}\n                        </div>\n                    </div>\n\n                    {/* Painel Lateral */}\n                    <div className=\"space-y-4\">\n                        {/* Resumo Financeiro */}\n                        <div className=\"bg-white rounded-md shadow-sm border border-gray-200 p-6\">\n                            <h3 className=\"text-sm font-bold text-gray-800 mb-4\">Resumo</h3>\n                            <div className=\"space-y-2 text-sm\">\n                                <div className=\"flex justify-between text-gray-600\">\n                                    <span>Subtotal</span>\n                                    <span>{new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(total)}</span>\n                                </div>\n                                {order.shippingCost !== undefined && (\n                                    <div className=\"flex justify-between text-gray-600\">\n                                        <span>Frete</span>\n                                        <span>{new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(order.shippingCost || 0)}</span>\n                                    </div>\n                                )}\n                                {(order.discount || 0) > 0 && (\n                                    <div className=\"flex justify-between text-green-600 font-bold\">\n                                        <span>Desconto</span>\n                                        <span>-{new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(order.discount || 0)}</span>\n                                    </div>\n                                )}\n                                <div className=\"flex justify-between text-gray-800 font-bold text-base pt-2 border-t border-gray-100\">\n                                    <span>Total</span>\n                                    <span>{new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(total + (order.shippingCost || 0) - (order.discount || 0))}</span>\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Endere칞o */}\n                        {order.shippingAddress && (\n                            <div className=\"bg-white rounded-md shadow-sm border border-gray-200 p-6\">\n                                <h3 className=\"text-sm font-bold text-gray-800 mb-3 flex items-center gap-2\">\n                                    <MapPin size={14} /> Endere칞o de Entrega\n                                </h3>\n                                <p className=\"text-sm text-gray-600 leading-relaxed\">\n                                    {typeof order.shippingAddress === 'string'\n                                        ? order.shippingAddress\n                                        : `${order.shippingAddress.street}, ${order.shippingAddress.number} - ${order.shippingAddress.neighborhood}, ${order.shippingAddress.city} - ${order.shippingAddress.state}`}\n                                </p>\n                            </div>\n                        )}\n\n                        {/* Pagamento */}\n                        <div className=\"bg-white rounded-md shadow-sm border border-gray-200 p-6\">\n                            <h3 className=\"text-sm font-bold text-gray-800 mb-3 flex items-center gap-2\">\n                                <CreditCard size={14} /> Pagamento\n                            </h3>\n                            <p className=\"text-sm text-gray-600\">\n                                {order.paymentMethod === 'pix' ? '游눑 PIX' : '游눱 Cart칚o de Cr칠dito'}\n                            </p>\n                            {order.paymentStatus && (\n                                <p className=\"text-xs text-gray-400 mt-1\">\n                                    Status: {order.paymentStatus === 'APPROVED' ? 'Aprovado' : order.paymentStatus}\n                                </p>\n                            )}\n                        </div>\n\n                        {/* Rastreio */}\n                        {order.trackingCode && (\n                            <div className=\"bg-white rounded-md shadow-sm border border-gray-200 p-6\">\n                                <h3 className=\"text-sm font-bold text-gray-800 mb-3 flex items-center gap-2\">\n                                    <Truck size={14} /> Rastreio\n                                </h3>\n                                <p className=\"text-sm text-gray-600 font-mono bg-gray-50 px-3 py-2 rounded\">{order.trackingCode}</p>\n                            </div>\n                        )}\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default OrderDetailPage;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/OrdersPage.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/OrdersPage.tsx:45:13\n  43 |         const userId = user?.id || user?.googleId;\n  44 |         if (userId) {\n> 45 |             fetchOrders(userId);\n     |             ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  46 |         } else {\n  47 |             setLoading(false);\n  48 |         }","line":45,"column":13,"nodeType":null,"endLine":45,"endColumn":24}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Link, useNavigate, useOutletContext } from 'react-router-dom';\nimport { Search, Package } from 'lucide-react';\nimport SEO from '../components/SEO';\nimport ReviewForm from '../components/ReviewForm';\nimport api from '../services/api';\nimport { cartService } from '../services/cartService';\nimport { getImageUrl } from '../utils/imageUtils';\nimport { User, Order } from '../types';\n\ninterface UserContext {\n    user: User | null;\n}\n\ninterface ReviewItem {\n    productId: string;\n    productName: string;\n}\n\nconst OrdersPage: React.FC = () => {\n    const navigate = useNavigate();\n    const { user } = useOutletContext<UserContext>();\n    const [orders, setOrders] = useState<Order[]>([]);\n    const [loading, setLoading] = useState<boolean>(true);\n    const [reviewItem, setReviewItem] = useState<ReviewItem | null>(null);\n    const [reviewedItems, setReviewedItems] = useState<Set<string>>(new Set());\n    const [searchTerm, setSearchTerm] = useState<string>('');\n\n    const fetchOrders = (userId: string) => {\n        setLoading(true);\n        api.get(`/orders/user/${userId}`)\n            .then(res => {\n                setOrders(res.data);\n                setLoading(false);\n            })\n            .catch(err => {\n                console.error(\"Error fetching orders:\", err);\n                setLoading(false);\n            });\n    };\n\n    useEffect(() => {\n        const userId = user?.id || user?.googleId;\n        if (userId) {\n            fetchOrders(userId);\n        } else {\n            setLoading(false);\n        }\n    }, [user]);\n\n    const handleReviewSubmitted = (itemId: string) => {\n        setReviewedItems(prev => new Set([...prev, itemId]));\n        setReviewItem(null);\n    };\n\n    const handleAddAllToCart = (dateOrders: Order[]) => {\n        dateOrders.forEach(order => {\n            (order.items || []).forEach(item => {\n                const productId = item.productId || item.product?.id;\n                const productName = item.productName || item.product?.name || item.name;\n                const price = item.unitPrice || item.price || item.product?.price;\n                const images = item.product?.images || [];\n\n                if (productId && productName && price !== undefined) {\n                    cartService.add({\n                        id: productId,\n                        name: productName,\n                        price: price,\n                        images: images\n                    }, 1);\n                }\n            });\n        });\n        window.dispatchEvent(new CustomEvent('show-alert', { detail: 'Produtos adicionados ao carrinho!' }));\n    };\n\n    if (!user) return null;\n\n    // Filtrar pedidos pela busca\n    const filteredOrders = orders.filter(order =>\n        !searchTerm || (order.items || []).some(item =>\n            (item.productName || item.product?.name || item.name || '').toLowerCase().includes(searchTerm.toLowerCase())\n        )\n    );\n\n    // Agrupar pedidos por data\n    const groupedOrders = filteredOrders.reduce((acc: Record<string, Order[]>, order) => {\n        const dateKey = new Date(order.createdAt).toLocaleDateString('pt-BR', { day: 'numeric', month: 'long', year: 'numeric' });\n        if (!acc[dateKey]) {\n            acc[dateKey] = [];\n        }\n        acc[dateKey].push(order);\n        return acc;\n    }, {});\n\n    return (\n        <div className=\"w-full pb-12\">\n            <SEO title=\"Minhas Compras\" description=\"Hist칩rico de compras e avalia칞칫es.\" />\n\n            {/* Review Modal */}\n            {reviewItem && (\n                <div className=\"fixed inset-0 z-50 bg-black/60 flex items-center justify-center p-4 backdrop-blur-sm\">\n                    <div className=\"bg-white w-full max-w-xl rounded-sm shadow-2xl p-8 relative max-h-[90vh] overflow-y-auto\">\n                        <button\n                            onClick={() => setReviewItem(null)}\n                            className=\"absolute top-4 right-4 text-gray-400 hover:text-[var(--azul-profundo)] transition-colors\"\n                        >\n                            九뎊n                        </button>\n                        <div className=\"mb-6\">\n                            <h3 className=\"font-playfair text-xl text-[var(--azul-profundo)] mb-1\">Avaliar Produto</h3>\n                            <p className=\"font-lato text-sm text-gray-500\">{reviewItem.productName}</p>\n                        </div>\n                        <ReviewForm\n                            productId={reviewItem.productId}\n                            onReviewSubmitted={() => handleReviewSubmitted(reviewItem.productId)}\n                        />\n                    </div>\n                </div>\n            )}\n\n            <div className=\"max-w-5xl mx-auto px-4 pt-8\">\n                <h1 className=\"text-2xl font-bold text-gray-800 mb-6\">Compras</h1>\n\n                {/* Busca */}\n                <div className=\"flex flex-col md:flex-row items-start md:items-center justify-between gap-4 mb-6\">\n                    <div className=\"relative w-full md:w-1/2 lg:w-1/3\">\n                        <input\n                            type=\"text\"\n                            placeholder=\"Busque por produto...\"\n                            value={searchTerm}\n                            onChange={(e) => setSearchTerm(e.target.value)}\n                            className=\"w-full pl-10 pr-4 py-2 bg-white border border-gray-300 rounded-full text-sm focus:outline-none focus:border-blue-500 shadow-sm\"\n                        />\n                        <Search className=\"absolute left-3 top-2.5 text-gray-400\" size={18} />\n                    </div>\n                    <span className=\"text-gray-400 text-sm\">{filteredOrders.length} compras</span>\n                </div>\n\n                {loading ? (\n                    <div className=\"flex justify-center py-20\">\n                        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500\"></div>\n                    </div>\n                ) : filteredOrders.length === 0 ? (\n                    <div className=\"text-center py-20 bg-white rounded-md border border-gray-200 shadow-sm mt-4\">\n                        <Package className=\"mx-auto text-gray-300 mb-4\" size={48} strokeWidth={1.5} />\n                        <h3 className=\"text-lg font-semibold text-gray-700 mb-2\">\n                            {searchTerm ? 'Nenhuma compra encontrada' : 'Voc칡 ainda n칚o fez compras'}\n                        </h3>\n                        <p className=\"text-gray-500 text-sm mb-6\">\n                            {searchTerm ? 'Tente buscar com outros termos.' : 'Seus pedidos aparecer칚o aqui assim que voc칡 concluir uma compra.'}\n                        </p>\n                        <Link to=\"/store\" className=\"bg-blue-500 text-white px-6 py-2.5 rounded text-sm font-semibold hover:bg-blue-600 transition-colors\">\n                            Ir para a loja\n                        </Link>\n                    </div>\n                ) : (\n                    <div className=\"space-y-6\">\n                        {Object.entries(groupedOrders).map(([date, dateOrders]) => (\n                            <div key={date} className=\"bg-white rounded-md shadow-sm border border-gray-200 overflow-hidden\">\n                                <div className=\"flex items-center justify-between px-6 py-4 bg-gray-50 border-b border-gray-200\">\n                                    <h2 className=\"text-sm font-semibold text-gray-800\">{date}</h2>\n                                    <button\n                                        onClick={() => handleAddAllToCart(dateOrders)}\n                                        className=\"text-xs text-blue-500 hover:text-blue-600 font-semibold\"\n                                    >\n                                        Adicionar tudo ao carrinho\n                                    </button>\n                                </div>\n\n                                <div className=\"divide-y divide-gray-100\">\n                                    {dateOrders.map(order => (\n                                        <div key={order.id} className=\"p-6\">\n                                            {(order.items || []).map((item, idx) => (\n                                                <div key={idx} className=\"flex flex-col md:flex-row md:items-start justify-between gap-6\">\n                                                    <div className=\"flex flex-1 gap-4\">\n                                                        <div className=\"w-20 h-20 shrink-0 border border-gray-200 rounded p-1 flex items-center justify-center overflow-hidden\">\n                                                            <img\n                                                                src={getImageUrl(item.productImage || (item.product?.images?.[0]) || '')}\n                                                                alt={item.productName || item.product?.name || item.name || 'Produto'}\n                                                                onError={(e: React.SyntheticEvent<HTMLImageElement, Event>) => {\n                                                                    const target = e.target as HTMLImageElement;\n                                                                    target.src = '/images/default.png';\n                                                                }}\n                                                                className=\"max-w-full max-h-full object-contain\"\n                                                            />\n                                                        </div>\n                                                        <div>\n                                                            <div className=\"flex items-center gap-2 mb-1\">\n                                                                <span className=\"text-sm font-bold text-green-600\">\n                                                                    {order.status === 'DELIVERED' ? 'Entregue' :\n                                                                        order.status === 'SHIPPED' ? 'Enviado' :\n                                                                            order.status === 'PAID' ? 'Pago' : 'Pendente'}\n                                                                </span>\n                                                            </div>\n                                                            <p className=\"text-sm text-gray-800 line-clamp-2 leading-tight max-w-md\">\n                                                                {item.productName || item.product?.name || item.name}\n                                                            </p>\n                                                            <p className=\"text-xs text-gray-400 mt-1\">\n                                                                {item.quantity} un.\n                                                            </p>\n                                                        </div>\n                                                    </div>\n\n                                                    <div className=\"w-full md:w-48 flex flex-col gap-2 shrink-0\">\n                                                        <button\n                                                            onClick={() => navigate(`/perfil/compras/${order.id}`)}\n                                                            className=\"w-full py-2 bg-blue-500 text-white text-sm font-semibold rounded hover:bg-blue-600 transition-colors\"\n                                                        >\n                                                            Ver compra\n                                                        </button>\n\n                                                        {order.status === 'DELIVERED' && !reviewedItems.has(item.productId || item.product?.id || '') && (\n                                                            <button\n                                                                onClick={() => {\n                                                                    const pid = item.productId || item.product?.id;\n                                                                    const pName = item.productName || item.product?.name || item.name;\n                                                                    if (pid && pName) {\n                                                                        setReviewItem({\n                                                                            productId: pid,\n                                                                            productName: pName\n                                                                        });\n                                                                    }\n                                                                }}\n                                                                className=\"text-xs text-center text-gray-500 hover:text-blue-500 transition-colors mt-2\"\n                                                            >\n                                                                Avaliar Produto\n                                                            </button>\n                                                        )}\n                                                    </div>\n                                                </div>\n                                            ))}\n                                        </div>\n                                    ))}\n                                </div>\n                            </div>\n                        ))}\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default OrdersPage;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/PasswordResetPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1602,1605],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1602,1605],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useSearchParams, useNavigate } from 'react-router-dom';\nimport { Lock, CheckCircle, AlertCircle, Loader2, ArrowLeft } from 'lucide-react';\nimport { authService } from '../services/authService';\n\nconst PasswordResetPage: React.FC = () => {\n    const [searchParams] = useSearchParams();\n    const navigate = useNavigate();\n    const token = searchParams.get('token');\n\n    const [password, setPassword] = useState<string>('');\n    const [confirmPassword, setConfirmPassword] = useState<string>('');\n    const [loading, setLoading] = useState<boolean>(false);\n    const [status, setStatus] = useState<'IDLE' | 'SUCCESS' | 'ERROR'>('IDLE');\n    const [message, setMessage] = useState<string>('');\n\n    useEffect(() => {\n        if (!token) {\n            setStatus('ERROR');\n            setMessage('Token de recupera칞칚o inv치lido ou ausente.');\n        }\n    }, [token]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!token) return;\n\n        if (password !== confirmPassword) {\n            setMessage('As senhas n칚o coincidem.');\n            return;\n        }\n\n        setLoading(true);\n        setStatus('IDLE');\n        setMessage('');\n\n        try {\n            await authService.resetPassword(token, password);\n            setStatus('SUCCESS');\n            setMessage('Sua senha foi redefinida com sucesso!');\n            setTimeout(() => {\n                window.dispatchEvent(new CustomEvent('open-auth-modal'));\n                navigate('/');\n            }, 3000);\n        } catch (err: any) {\n            setStatus('ERROR');\n            setMessage(err.response?.data?.message || 'Erro ao redefinir senha. O link pode ter expirado.');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <div className=\"min-h-[70vh] flex items-center justify-center p-4 bg-[var(--branco-off-white)]\">\n            <div className=\"bg-white p-8 md:p-12 max-w-md w-full shadow-lg border border-[var(--azul-profundo)]/5 rounded-sm\">\n                <div className=\"text-center mb-10\">\n                    <h1 className=\"font-playfair text-3xl text-[var(--azul-profundo)] mb-3\">Redefinir Senha</h1>\n                    <p className=\"font-lato text-[11px] uppercase tracking-[0.2em] text-[var(--dourado-suave)]\">\n                        Crie uma nova credencial para sua conta\n                    </p>\n                </div>\n\n                {status === 'SUCCESS' ? (\n                    <div className=\"text-center space-y-4\">\n                        <div className=\"flex justify-center\">\n                            <CheckCircle className=\"text-green-500 w-16 h-16\" />\n                        </div>\n                        <p className=\"text-gray-700 font-lato\">{message}</p>\n                        <p className=\"text-[10px] text-gray-400\">Voc칡 ser치 redirecionado para o in칤cio em instantes...</p>\n                    </div>\n                ) : (\n                    <form onSubmit={handleSubmit} className=\"space-y-6\">\n                        <div>\n                            <label className=\"block text-[10px] uppercase tracking-widest text-gray-400 mb-2 font-lato\">Nova Senha</label>\n                            <div className=\"relative\">\n                                <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-300\" size={18} />\n                                <input\n                                    type=\"password\"\n                                    required\n                                    value={password}\n                                    onChange={(e) => setPassword(e.target.value)}\n                                    className=\"w-full bg-gray-50 border border-gray-100 py-4 pl-10 pr-4 text-sm focus:border-[var(--dourado-suave)] outline-none transition-colors\"\n                                    placeholder=\"********\"\n                                    minLength={6}\n                                />\n                            </div>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-[10px] uppercase tracking-widest text-gray-400 mb-2 font-lato\">Confirmar Nova Senha</label>\n                            <div className=\"relative\">\n                                <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-300\" size={18} />\n                                <input\n                                    type=\"password\"\n                                    required\n                                    value={confirmPassword}\n                                    onChange={(e) => setConfirmPassword(e.target.value)}\n                                    className=\"w-full bg-gray-50 border border-gray-100 py-4 pl-10 pr-4 text-sm focus:border-[var(--dourado-suave)] outline-none transition-colors\"\n                                    placeholder=\"********\"\n                                    minLength={6}\n                                />\n                            </div>\n                        </div>\n\n                        {status === 'ERROR' && (\n                            <div className=\"flex items-start gap-2 text-red-600 bg-red-50 p-4 border border-red-100 italic text-xs font-lato\">\n                                <AlertCircle size={16} className=\"shrink-0\" />\n                                <p>{message}</p>\n                            </div>\n                        )}\n\n                        <button\n                            type=\"submit\"\n                            disabled={loading || (status === 'ERROR' && !token)}\n                            className=\"w-full bg-[var(--azul-profundo)] text-white py-5 font-lato text-xs uppercase tracking-[0.2em] hover:bg-[var(--dourado-suave)] transition-all flex items-center justify-center gap-2 shadow-md hover:shadow-lg disabled:opacity-50\"\n                        >\n                            {loading ? <Loader2 size={18} className=\"animate-spin\" /> : \"Alterar Senha\"}\n                        </button>\n\n                        <button\n                            type=\"button\"\n                            onClick={() => navigate('/')}\n                            className=\"w-full flex items-center justify-center gap-2 text-[10px] text-gray-400 uppercase tracking-widest hover:text-[var(--azul-profundo)] transition-colors\"\n                        >\n                            <ArrowLeft size={14} /> Voltar para o in칤cio\n                        </button>\n                    </form>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default PasswordResetPage;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/ProductPage.tsx","messages":[{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useMemo\" is called conditionally. React Hooks must be called in the exact same order in every component render. Did you accidentally call a React Hook after an early return?","line":244,"column":27,"nodeType":"Identifier","endLine":244,"endColumn":34}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState, useMemo, useRef } from 'react';\nimport { useParams, Link, useNavigate } from 'react-router-dom';\nimport { productService } from '../services/productService';\nimport { cartService } from '../services/cartService';\nimport { authService } from '../services/authService';\nimport { orderService } from '../services/orderService';\nimport SEO from '../components/SEO';\nimport { useFavorites } from '../context/FavoritesContext';\nimport { ShoppingBag, ShieldCheck, Truck, RefreshCcw, ChevronLeft, Play, X, Maximize2, Heart } from 'lucide-react';\nimport { getImageUrl } from '../utils/imageUtils';\nimport ReviewSection from '../components/ReviewSection';\nimport ProductCard from '../components/ProductCard';\nimport OptimizedImage from '../components/ui/OptimizedImage';\nimport Button from '../components/ui/Button';\nimport Spinner from '../components/ui/Spinner';\nimport { useToast } from '../context/ToastContext';\nimport { Product, Variant, Review } from '../types';\n\nconst ProductPage: React.FC = () => {\n    const { id } = useParams<{ id: string }>();\n    const navigate = useNavigate();\n    const user = authService.getUser();\n    const { isFavorite: checkFavorite, toggleFavorite, loading: favLoading } = useFavorites();\n    const [product, setProduct] = useState<Product | null>(null);\n    const [loading, setLoading] = useState<boolean>(true);\n    const [quantity, setQuantity] = useState<number>(1);\n    const [recommendations, setRecommendations] = useState<Product[]>([]);\n    const [loadingRecs, setLoadingRecs] = useState<boolean>(false);\n    const { addToast } = useToast();\n\n    const [mainMedia, setMainMedia] = useState<string | null>(null);\n    const [selectedOptions, setSelectedOptions] = useState<Record<string, string>>({});\n    const [currentVariant, setCurrentVariant] = useState<Variant | null>(null);\n\n    const isFavorite = id ? checkFavorite(id) : false;\n\n    const handleToggleFavorite = async () => {\n        if (!product) return;\n        await toggleFavorite(product);\n    };\n\n    // UI State\n    const [isLightboxOpen, setIsLightboxOpen] = useState<boolean>(false);\n    const [zoomPos, setZoomPos] = useState<{ x: number; y: number; show: boolean }>({ x: 0, y: 0, show: false });\n    const mainImageRef = useRef<HTMLImageElement>(null);\n\n    useEffect(() => {\n        if (!id) return;\n        const fetchProduct = async () => {\n            setLoading(true);\n            try {\n                const data = await productService.getProductById(id);\n                setProduct(data);\n                if (data?.images && data.images.length > 0) {\n                    setMainMedia(data.images[0] || null);\n                } else if (data?.image) {\n                    setMainMedia(data.image || null);\n                }\n\n                // Registrar no hist칩rico de navega칞칚o via API se o usu치rio estiver logado\n                if (user?.id) {\n                    orderService.history.add(user.id, data.id);\n                }\n\n                if (data?.variants && data.variants.length > 0) {\n                    const firstActiveVariant = data.variants.find(v => (v.active !== false) && v.stockQuantity > 0) || data.variants[0];\n                    if (firstActiveVariant && firstActiveVariant.attributesJson) {\n                        try {\n                            const attrs = JSON.parse(firstActiveVariant.attributesJson);\n                            setSelectedOptions(attrs);\n                            setCurrentVariant(firstActiveVariant);\n                            if (firstActiveVariant.imageUrl) setMainMedia(firstActiveVariant.imageUrl);\n                        } catch (e) {\n                            console.error(\"Error parsing variant attributes\", e);\n                        }\n                    }\n                }\n\n                // Buscar recomenda칞칫es\n                setLoadingRecs(true);\n                try {\n                    let recs: Product[] = [];\n                    if (data?.categoryId) {\n                        recs = await productService.getProducts({ categoryId: data.categoryId });\n                        recs = recs.filter(r => r.id !== id);\n                    }\n                    setRecommendations(recs.slice(0, 4));\n                } catch (e) {\n                    console.error(\"Error fetching recommendations\", e);\n                    setRecommendations([]);\n                }\n                setLoadingRecs(false);\n            } catch (err) {\n                console.error(\"Failed to load product\", err);\n            } finally {\n                setLoading(false);\n            }\n        };\n        fetchProduct();\n    }, [id, user?.id]);\n\n    // M칤dias da variante selecionada\n    const variantMedias = useMemo(() => {\n        if (currentVariant) {\n            const seen = new Set<string>();\n            const imgs: string[] = [];\n            const addUnique = (url: string | undefined) => {\n                if (url && !seen.has(url)) {\n                    seen.add(url);\n                    imgs.push(url);\n                }\n            };\n            addUnique(currentVariant.imageUrl);\n            (currentVariant.images || []).forEach(addUnique);\n            return imgs.length > 0 ? imgs : (product?.images?.slice(0, 1) ?? []);\n        }\n        return product?.images ?? [];\n    }, [currentVariant, product]);\n\n\n    const displayPrice = currentVariant ? currentVariant.price : product?.price || 0;\n    const originalPrice = product?.originalPrice || displayPrice;\n    const hasDiscount = originalPrice > displayPrice;\n    const discountPercentage = product?.discountPercentage || (hasDiscount ? Math.round(((originalPrice - displayPrice) / originalPrice) * 100) : 0);\n\n    const displayStock = currentVariant ? currentVariant.stockQuantity : product?.stockQuantity || 0;\n    const isOutOfStock = displayStock <= 0;\n\n    const handleReviewAdded = (newReview: Review) => {\n        setProduct(prev => {\n            if (!prev) return null;\n            const newTotal = (prev.totalReviews || 0) + 1;\n            const currentAvg = prev.averageRating || 4.6;\n            const newAvg = ((currentAvg * (prev.totalReviews || 1)) + newReview.rating) / newTotal;\n\n            return {\n                ...prev,\n                totalReviews: newTotal,\n                averageRating: parseFloat(newAvg.toFixed(1))\n            };\n        });\n    };\n\n    const handleReviewsLoaded = (loadedReviews: Review[]) => {\n        if (!loadedReviews?.length) return;\n        const total = loadedReviews.length;\n        const avg = loadedReviews.reduce((sum, r) => sum + (r.rating || 0), 0) / total;\n        setProduct(prev => {\n            if (!prev) return null;\n            return {\n                ...prev,\n                totalReviews: total,\n                averageRating: parseFloat(avg.toFixed(1))\n            };\n        });\n    };\n\n    useEffect(() => {\n        setQuantity(1);\n    }, [currentVariant?.id]);\n\n    const handleAddToCart = () => {\n        if (!product || isOutOfStock) return;\n\n        const cartProduct = {\n            ...product,\n            id: currentVariant ? currentVariant.id : product.id,\n            name: currentVariant ? `${product.name} (${Object.values(selectedOptions).join(', ')})` : product.name,\n            price: displayPrice,\n            images: currentVariant?.imageUrl ? [currentVariant.imageUrl] : product.images,\n            image: currentVariant?.imageUrl || product.images?.[0] || product.image\n        };\n\n        cartService.add(cartProduct, quantity);\n        addToast(`${product.name} adicionado ao carrinho!`, \"success\");\n        setTimeout(() => { }, 3000); // added state was unused, keeping delay logic if needed later\n    };\n\n    const isVideo = (url: string | null) => {\n        if (!url) return false;\n        const lower = String(url).toLowerCase();\n        return lower.endsWith('.mp4') || lower.endsWith('.webm') || lower.endsWith('.mov');\n    };\n\n    const handleMouseMove = (e: React.MouseEvent) => {\n        if (!mainImageRef.current || isVideo(mainMedia)) return;\n        const { left, top, width, height } = mainImageRef.current.getBoundingClientRect();\n        const x = ((e.pageX - left - window.scrollX) / width) * 100;\n        const y = ((e.pageY - top - window.scrollY) / height) * 100;\n        setZoomPos({ x, y, show: true });\n    };\n\n    const renderMedia = (url: string | null, isMain: boolean = false) => {\n        if (!url) return null;\n        if (isVideo(url)) {\n            return (\n                <video\n                    src={getImageUrl(url)}\n                    className=\"w-full h-full object-cover\"\n                    controls={isMain}\n                    autoPlay={isMain}\n                    muted={isMain}\n                    loop={isMain}\n                    playsInline\n                />\n            );\n        }\n        return (\n            <OptimizedImage\n                ref={isMain ? mainImageRef : null}\n                src={url}\n                alt={product?.name || \"Produto\"}\n                width={isMain ? 600 : 80}\n                height={isMain ? 750 : 80}\n                priority={isMain}\n                productContext={isMain ? {\n                    name: product?.name || '',\n                    category: typeof product?.category === 'object' ? product.category.name : undefined\n                } : undefined}\n                className=\"w-full h-full object-cover\"\n                onMouseMove={isMain ? handleMouseMove : undefined}\n                onMouseLeave={isMain ? () => setZoomPos(prev => ({ ...prev, show: false })) : undefined}\n                onClick={isMain ? () => setIsLightboxOpen(true) : undefined}\n            />\n        );\n    };\n\n    if (loading) return (\n        <div className=\"min-h-screen flex flex-col items-center justify-center gap-4 bg-[#F7F7F4]\">\n            <Spinner size={40} className=\"text-[#C9A24D]\" />\n            <p className=\"font-lato text-[10px] uppercase tracking-widest text-[#0f2A44]/40\">Carregando Ax칠...</p>\n        </div>\n    );\n\n    if (!product) return (\n        <div className=\"min-h-screen flex items-center justify-center bg-[#F7F7F4]\">\n            <div className=\"text-center\">\n                <p className=\"font-playfair text-xl text-[#0f2A44] mb-4\">Produto n칚o encontrado.</p>\n                <Link to=\"/store\" className=\"text-[var(--dourado-suave)] hover:underline font-lato text-sm\">Voltar para a loja</Link>\n            </div>\n        </div>\n    );\n\n    const productJsonLd = useMemo(() => {\n        if (!product) return undefined;\n        const offer = {\n            \"@type\": \"Offer\",\n            \"url\": window.location.href,\n            \"priceCurrency\": \"BRL\",\n            \"price\": displayPrice.toFixed(2),\n            \"itemCondition\": \"https://schema.org/NewCondition\",\n            \"availability\": isOutOfStock ? \"https://schema.org/OutOfStock\" : \"https://schema.org/InStock\",\n        };\n\n        const schema = {\n            \"@context\": \"https://schema.org\",\n            \"@type\": \"Product\",\n            \"name\": product.name,\n            \"image\": product.images?.[0] || product.image || \"/og-image.jpg\",\n            \"description\": product.description || \"\",\n            \"sku\": product.id,\n            \"brand\": {\n                \"@type\": \"Brand\",\n                \"name\": \"Ateli칡 Filhos de Aruanda\"\n            },\n            \"offers\": offer,\n            ...(product.totalReviews ? {\n                \"aggregateRating\": {\n                    \"@type\": \"AggregateRating\",\n                    \"ratingValue\": product.averageRating,\n                    \"reviewCount\": product.totalReviews\n                }\n            } : {})\n        };\n        return JSON.stringify(schema);\n    }, [product, displayPrice, isOutOfStock]);\n\n    return (\n        <div className=\"min-h-screen bg-white\">\n            <SEO\n                title={product ? `${product.name} | ${typeof product.category === 'object' ? product.category.name : 'Artigos Religiosos'}` : undefined}\n                description={product.description?.substring(0, 150) + \"... Compre agora no Ateli칡!\"}\n                image={product.images?.[0] || product.image}\n                type=\"product\"\n                jsonLd={productJsonLd}\n                keywords={`${product.name}, ${typeof product.category === 'object' ? product.category.name : ''}, ateli칡 aruanda, artigos religiosos artesanais`}\n            />\n\n            {/* Lightbox Modal */}\n            {isLightboxOpen && mainMedia && (\n                <div className=\"fixed inset-0 z-[100] bg-black flex items-center justify-center p-4\">\n                    <button\n                        onClick={() => setIsLightboxOpen(false)}\n                        className=\"absolute top-6 right-6 text-white hover:text-[#C9A24D] transition-colors\"\n                    >\n                        <X size={32} />\n                    </button>\n                    <div className=\"max-w-4xl w-full h-full flex items-center justify-center\">\n                        {isVideo(mainMedia) ? (\n                            <video src={getImageUrl(mainMedia)} controls autoPlay className=\"max-h-full max-w-full\" />\n                        ) : (\n                            <img src={getImageUrl(mainMedia)} alt={product.name} className=\"max-h-full max-w-full object-contain\" />\n                        )}\n                    </div>\n                </div>\n            )}\n\n            <div className=\"max-w-[1440px] mx-auto px-4 md:px-8 py-8 lg:py-12\">\n                <div className=\"mb-8\">\n                    <Link\n                        to=\"/store\"\n                        className=\"group flex items-center gap-2 text-[10px] uppercase tracking-widest text-gray-400 hover:text-[var(--azul-profundo)] transition-all\"\n                    >\n                        <ChevronLeft size={14} className=\"group-hover:-translate-x-1 transition-transform\" />\n                        Voltar para o cat치logo\n                    </Link>\n                </div>\n\n                <div className=\"flex flex-col lg:flex-row gap-12 xl:gap-24\">\n                    <div className=\"flex flex-row gap-4 flex-1\">\n                        {variantMedias.length > 0 && (\n                            <div className=\"hidden md:flex flex-col gap-3 w-20 shrink-0\">\n                                {variantMedias.map((img, i) => (\n                                    <div\n                                        key={i}\n                                        onClick={() => setMainMedia(img)}\n                                        className={`aspect-square bg-white overflow-hidden shadow-sm transition-all cursor-pointer relative rounded-sm ${mainMedia === img ? 'ring-2 ring-[var(--azul-profundo)]' : 'opacity-60 hover:opacity-100'\n                                            }`}\n                                    >\n                                        {renderMedia(img, false)}\n                                        {isVideo(img) && (\n                                            <div className=\"absolute inset-0 flex items-center justify-center bg-black/10\">\n                                                <Play size={10} className=\"text-white fill-white\" />\n                                            </div>\n                                        )}\n                                    </div>\n                                ))}\n                            </div>\n                        )}\n\n                        <div className=\"flex-1 relative group cursor-crosshair\">\n                            <div className=\"aspect-[4/5] bg-white overflow-hidden shadow-sm relative rounded-sm\">\n                                {renderMedia(mainMedia, true)}\n\n                                {zoomPos.show && !isVideo(mainMedia) && mainMedia && (\n                                    <div\n                                        className=\"absolute inset-0 pointer-events-none overflow-hidden z-10\"\n                                        style={{\n                                            backgroundImage: `url(${getImageUrl(mainMedia)})`,\n                                            backgroundPosition: `${zoomPos.x}% ${zoomPos.y}%`,\n                                            backgroundSize: '200%',\n                                            backgroundRepeat: 'no-repeat'\n                                        }}\n                                    />\n                                )}\n\n                                {!mainMedia && (\n                                    <div className=\"absolute inset-0 flex items-center justify-center bg-gray-100\">\n                                        <span className=\"font-playfair text-[var(--azul-profundo)]/30 text-xl font-bold tracking-widest text-center uppercase\">Imagem<br />Indispon칤vel</span>\n                                    </div>\n                                )}\n\n                                <button\n                                    onClick={() => setIsLightboxOpen(true)}\n                                    className=\"absolute bottom-4 right-4 bg-white/80 p-2 rounded-full shadow-md opacity-0 group-hover:opacity-100 transition-opacity\"\n                                >\n                                    <Maximize2 size={18} className=\"text-[var(--azul-profundo)]\" />\n                                </button>\n                            </div>\n\n                            <div className=\"flex md:hidden flex-row gap-2 mt-4 overflow-x-auto pb-2 scrollbar-hide\">\n                                {product.images?.map((img, i) => (\n                                    <div\n                                        key={i}\n                                        onClick={() => setMainMedia(img)}\n                                        className={`aspect-square w-16 bg-white shrink-0 overflow-hidden shadow-sm transition-all relative rounded-sm ${mainMedia === img ? 'ring-2 ring-[var(--dourado-suave)]' : 'opacity-60'}`}\n                                    >\n                                        {renderMedia(img, false)}\n                                    </div>\n                                ))}\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"flex-1 flex flex-col pt-4 lg:pt-0\">\n                        <div className=\"space-y-6\">\n                            <div className=\"space-y-4\">\n                                <h1 className=\"font-playfair text-3xl md:text-[40px] text-[var(--azul-profundo)] leading-tight font-medium\">\n                                    {product.name || 'Produto sem t칤tulo'}\n                                </h1>\n                                <p className=\"hidden md:block text-[10px] uppercase tracking-widest text-[#C9A24D] font-bold\">\n                                    {typeof product.category === 'object' ? product.category.name : 'Artigos Religiosos Exclusivos'}\n                                </p>\n\n                                {(() => {\n                                    const avg = product.averageRating ?? 0;\n                                    const total = product.totalReviews ?? 0;\n                                    return (\n                                        <div className=\"flex items-center gap-2\">\n                                            {total > 0 ? (\n                                                <>\n                                                    <span className=\"text-sm font-lato text-gray-500\">{avg.toFixed(1)}</span>\n                                                    <div className=\"flex items-center gap-0.5\">\n                                                        {[1, 2, 3, 4, 5].map((star) => {\n                                                            const fill = Math.min(Math.max(avg - (star - 1), 0), 1);\n                                                            return (\n                                                                <span key={star} className=\"relative inline-block w-4 h-4\">\n                                                                    <svg className=\"w-4 h-4 text-gray-300 fill-gray-300 absolute inset-0\" viewBox=\"0 0 20 20\">\n                                                                        <path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\" />\n                                                                    </svg>\n                                                                    <svg\n                                                                        className=\"w-4 h-4 text-[#3483fa] fill-[#3483fa] absolute inset-0\"\n                                                                        viewBox=\"0 0 20 20\"\n                                                                        style={{ clipPath: `inset(0 ${100 - fill * 100}% 0 0)` }}\n                                                                    >\n                                                                        <path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\" />\n                                                                    </svg>\n                                                                </span>\n                                                            );\n                                                        })}\n                                                    </div>\n                                                    <span className=\"text-sm font-lato text-gray-400\">({total} {total === 1 ? 'avalia칞칚o' : 'avalia칞칫es'})</span>\n                                                </>\n                                            ) : (\n                                                <span className=\"text-xs font-lato text-gray-400 uppercase tracking-widest\">Sem avalia칞칫es ainda</span>\n                                            )}\n                                        </div>\n                                    );\n                                })()}\n\n                                <div className=\"flex flex-col gap-1 mt-6\">\n                                    {hasDiscount && (\n                                        <span className=\"font-lato text-gray-400 line-through text-lg\">\n                                            {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(originalPrice)}\n                                        </span>\n                                    )}\n                                    <div className=\"flex items-baseline gap-3\">\n                                        <span className=\"font-lato text-[44px] text-[var(--azul-profundo)] font-bold leading-none\">\n                                            {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(displayPrice)}\n                                        </span>\n                                        {hasDiscount && (\n                                            <span className=\"text-green-600 font-bold font-lato text-lg\">\n                                                {discountPercentage}% OFF\n                                            </span>\n                                        )}\n                                    </div>\n                                    <span className=\"text-sm font-lato text-[var(--azul-profundo)]\">12x {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(displayPrice / 12)}</span>\n                                    <button className=\"text-[var(--azul-claro)] text-sm font-lato hover:underline text-left mt-1\">Ver os meios de pagamento</button>\n                                </div>\n\n                                {displayStock <= 5 && displayStock > 0 && (\n                                    <p className=\"text-xs text-amber-600 font-lato mt-4 flex items-center gap-2\">\n                                        <span className=\"h-1.5 w-1.5 rounded-full bg-amber-600 animate-pulse\" />\n                                        칔ltimas unidades em estoque!\n                                    </p>\n                                )}\n                                {isOutOfStock && (\n                                    <p className=\"text-xs font-bold text-red-600 font-lato mt-4\">Fora de Estoque</p>\n                                )}\n                            </div>\n\n                            {product.variants && product.variants.length > 0 && (() => {\n                                const activeVariants = product.variants.filter(v => v.active !== false);\n\n                                return (\n                                    <div className=\"py-5 border-y border-gray-100 space-y-3\">\n                                        {Object.keys(selectedOptions).length > 0 && (\n                                            <p className=\"font-lato text-sm text-gray-700\">\n                                                {Object.entries(selectedOptions).map(([k, v], i) => (\n                                                    <span key={k}>\n                                                        {i > 0 && <span className=\"mx-2 text-gray-300\">췅</span>}\n                                                        <span className=\"font-semibold capitalize\">{k}:</span>{' '}\n                                                        <span className=\"font-bold uppercase tracking-wide text-[var(--azul-profundo)]\">{v}</span>\n                                                    </span>\n                                                ))}\n                                            </p>\n                                        )}\n\n                                        <div className=\"flex flex-row gap-2 overflow-x-auto pb-1\">\n                                            {activeVariants.map((variant) => {\n                                                const isSelected = currentVariant?.id === variant.id;\n                                                const thumbSrc = variant.imageUrl\n                                                    || product.images?.[0]\n                                                    || product.image\n                                                    || '/images/default.png';\n\n                                                let variantAttrs: Record<string, string> = {};\n                                                try { variantAttrs = JSON.parse(variant.attributesJson || '{}'); } catch { /* noop */ }\n                                                const tooltipLabel = Object.entries(variantAttrs)\n                                                    .map(([k, v]) => `${k}: ${v}`)\n                                                    .join(' | ') || `Variante ${variant.id}`;\n\n                                                return (\n                                                    <button\n                                                        key={variant.id}\n                                                        title={tooltipLabel}\n                                                        onClick={() => {\n                                                            setCurrentVariant(variant);\n                                                            setSelectedOptions(variantAttrs);\n                                                            if (variant.imageUrl) setMainMedia(variant.imageUrl);\n                                                        }}\n                                                        className={`shrink-0 w-[64px] h-[64px] rounded-md overflow-hidden border-2 transition-all duration-200 focus:outline-none\n                                                            ${isSelected\n                                                                ? 'border-[#3483fa] ring-2 ring-[#3483fa] ring-offset-1'\n                                                                : 'border-gray-200 hover:border-gray-400'\n                                                            }\n                                                        `}\n                                                    >\n                                                        <OptimizedImage\n                                                            src={thumbSrc}\n                                                            alt={tooltipLabel}\n                                                            width={64}\n                                                            height={64}\n                                                            className=\"w-full h-full object-cover\"\n                                                        />\n                                                    </button>\n                                                );\n                                            })}\n                                        </div>\n                                    </div>\n                                );\n                            })()}\n\n                            <div className=\"flex flex-col gap-4 pt-4\">\n                                <div className=\"flex items-center gap-2\">\n                                    <span className=\"font-lato text-sm text-[var(--azul-profundo)]\">Quantidade: <b>{quantity} {quantity > 1 ? 'unidades' : 'unidade'}</b></span>\n                                    <div className=\"flex flex-col border-l border-gray-200 pl-2\">\n                                        <button\n                                            onClick={() => setQuantity(Math.min(displayStock || 1, quantity + 1))}\n                                            disabled={quantity >= (displayStock || 1)}\n                                            className=\"text-[var(--azul-claro)] hover:text-[var(--azul-profundo)] disabled:opacity-30 disabled:cursor-not-allowed\"\n                                        >\n                                            <ChevronLeft size={14} className=\"rotate-90\" />\n                                        </button>\n                                        <button\n                                            onClick={() => setQuantity(Math.max(1, quantity - 1))}\n                                            disabled={quantity <= 1}\n                                            className=\"text-[var(--azul-claro)] hover:text-[var(--azul-profundo)] disabled:opacity-30 disabled:cursor-not-allowed\"\n                                        >\n                                            <ChevronLeft size={14} className=\"-rotate-90\" />\n                                        </button>\n                                    </div>\n                                    {displayStock > 0 ? (\n                                        <span className=\"text-gray-400 text-xs ml-2\">\n                                            ({Math.max(0, displayStock - quantity)} dispon칤ve{displayStock - quantity === 1 ? 'l' : 'is'})\n                                        </span>\n                                    ) : (\n                                        <span className=\"text-red-400 text-xs ml-2\">Sem estoque</span>\n                                    )}\n                                </div>\n\n                                <div className=\"flex flex-col gap-3\">\n                                    <Button\n                                        onClick={() => {\n                                            handleAddToCart();\n                                            navigate('/checkout');\n                                        }}\n                                        disabled={isOutOfStock}\n                                        variant=\"primary\"\n                                        className=\"w-full h-[58px] text-[20px] rounded-[4px]\"\n                                    >\n                                        Comprar agora\n                                    </Button>\n\n                                    <Button\n                                        onClick={handleAddToCart}\n                                        disabled={isOutOfStock}\n                                        variant=\"outline\"\n                                        className=\"w-full h-[58px] text-[20px] rounded-[4px] bg-[#e3edfb] border-none text-[#3483fa] hover:bg-[#d0e1f9] hover:text-[#3483fa]\"\n                                    >\n                                        <ShoppingBag size={24} />\n                                        Adicionar ao carrinho\n                                    </Button>\n\n                                    <Button\n                                        onClick={handleToggleFavorite}\n                                        isLoading={favLoading}\n                                        variant=\"outline\"\n                                        className={`w-full h-[58px] text-[16px] rounded-[4px] border\n                                            ${isFavorite\n                                                ? 'bg-white border-red-200 text-red-500 hover:bg-red-50 hover:text-red-600'\n                                                : 'bg-white border-gray-200 text-gray-600 hover:border-red-400 hover:text-red-500'\n                                            }\n                                        `}\n                                    >\n                                        {!favLoading && <Heart size={24} className={isFavorite ? \"fill-current\" : \"\"} />}\n                                        {isFavorite ? \"Remover dos favoritos\" : \"Adicionar aos favoritos\"}\n                                    </Button>\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-3 pt-8 mt-4\">\n                                <div className=\"flex items-center gap-3 p-3 bg-white border border-gray-50 rounded-sm\">\n                                    <Truck size={18} className=\"text-[#C9A24D]\" />\n                                    <span className=\"text-[10px] uppercase font-lato tracking-widest text-[var(--azul-profundo)]/80\">Frete Gr치tis</span>\n                                </div>\n                                <div className=\"flex items-center gap-3 p-3 bg-white border border-gray-50 rounded-sm\">\n                                    <ShieldCheck size={18} className=\"text-[#C9A24D]\" />\n                                    <span className=\"text-[10px] uppercase font-lato tracking-widest text-[var(--azul-profundo)]/80\">Seguro</span>\n                                </div>\n                                <div className=\"flex items-center gap-3 p-3 bg-white border border-gray-50 rounded-sm\">\n                                    <RefreshCcw size={18} className=\"text-[#C9A24D]\" />\n                                    <span className=\"text-[10px] uppercase font-lato tracking-widest text-[var(--azul-profundo)]/80\">7 Dias Devolu칞칚o</span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div className=\"mt-24 space-y-24\">\n                    <section className=\"max-w-4xl mx-auto\">\n                        <h2 className=\"font-playfair text-2xl text-[var(--azul-profundo)] mb-8 pb-4 border-b border-[var(--azul-profundo)]/10 text-center uppercase tracking-widest\">Sobre este Ax칠</h2>\n                        <div className=\"prose prose-slate max-w-none font-lato text-[var(--azul-profundo)]/70 text-lg leading-relaxed text-center italic\">\n                            {product.description}\n                        </div>\n                    </section>\n\n                    <section className=\"space-y-12\">\n                        <div className=\"text-center\">\n                            <h2 className=\"font-playfair text-[32px] text-[var(--azul-profundo)] mb-2 uppercase tracking-[0.2em] font-medium\">Voc칡 tamb칠m vai amar</h2>\n                            <div className=\"h-[2px] w-24 bg-[#3483fa] mx-auto\" />\n                        </div>\n\n                        {loadingRecs ? (\n                            <div className=\"flex justify-center py-12\">\n                                <Spinner className=\"text-[#3483fa]\" />\n                            </div>\n                        ) : recommendations.length > 0 ? (\n                            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-6\">\n                                {recommendations.map(req => (\n                                    <ProductCard key={req.id} product={req} />\n                                ))}\n                            </div>\n                        ) : (\n                            <p className=\"text-center text-gray-400 font-lato text-xs uppercase tracking-widest\">Sem recomenda칞칫es para este item no momento.</p>\n                        )}\n                    </section>\n\n                    <section id=\"reviews\" className=\"space-y-12 bg-white p-8 md:p-12 shadow-sm border border-gray-100 rounded-sm\">\n                        {id && (\n                            <ReviewSection\n                                productId={id}\n                                onReviewAdded={handleReviewAdded}\n                                onReviewsLoaded={handleReviewsLoaded}\n                            />\n                        )}\n                    </section>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default ProductPage;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/ProfilePage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":64,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":64,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, ChangeEvent } from 'react';\nimport { User as UserIcon, Shield, CreditCard, ChevronRight, MapPin, Bell, Gift, Mail, AlertTriangle, X, Loader2, Camera } from 'lucide-react';\nimport Cropper, { Area, Point } from 'react-easy-crop';\nimport { getCroppedImg } from '../utils/imageUtils';\nimport { useOutletContext, useNavigate, Link } from 'react-router-dom';\nimport api from '../services/api';\nimport { authService } from '../services/authService';\nimport { User } from '../types';\nimport { MaskedInput } from '../components/ui/MaskedInput';\nimport { isValidCPF, isValidCNPJ, sanitizeDocument } from '../utils/fiscal';\n\ninterface UserContext {\n    user: User | null;\n}\n\ntype ModalType = 'info' | 'security' | 'cancel' | 'crop' | null;\n\nconst ProfilePage: React.FC = () => {\n    const { user } = useOutletContext<UserContext>();\n    const navigate = useNavigate();\n\n    const [modal, setModal] = useState<ModalType>(null);\n    const [loading, setLoading] = useState<boolean>(false);\n    const [actionMsg, setActionMsg] = useState<string>('');\n\n    // State for Cropping\n    const [image, setImage] = useState<string | null>(null);\n    const [crop, setCrop] = useState<Point>({ x: 0, y: 0 });\n    const [zoom, setZoom] = useState<number>(1);\n    const [croppedAreaPixels, setCroppedAreaPixels] = useState<Area | null>(null);\n\n    // Profile Edit State\n    const [profileData, setProfileData] = useState({\n        name: user?.name || '',\n        document: user?.document || ''\n    });\n    const [profileError, setProfileError] = useState('');\n\n    const onCropComplete = (_croppedArea: Area, croppedAreaPixels: Area) => {\n        setCroppedAreaPixels(croppedAreaPixels);\n    };\n\n    const handleAction = async (endpoint: string, payload: Record<string, unknown>, successMsg: string) => {\n        setLoading(true);\n        setActionMsg('');\n        try {\n            await api.post(endpoint, payload);\n            setActionMsg(successMsg);\n            setTimeout(() => { setModal(null); setActionMsg(''); }, 2000);\n        } catch (err: unknown) {\n            const apiError = err as { response?: { data?: { message?: string } } };\n            setActionMsg(apiError.response?.data?.message || 'Ocorreu um erro.');\n        }\n        setLoading(false);\n    };\n\n    const handleCancelAccount = async () => {\n        if (!user?.id) return;\n        setLoading(true);\n        try {\n            await api.delete(`/users/${user.id}`);\n            authService.logout();\n            navigate('/login');\n        } catch (err) {\n            setActionMsg('Erro ao cancelar conta. Entre em contato com o suporte.');\n            setLoading(false);\n        }\n    };\n\n    const onFileChange = (e: ChangeEvent<HTMLInputElement>) => {\n        if (e.target.files && e.target.files.length > 0) {\n            const file = e.target.files[0];\n            if (file) {\n                const reader = new FileReader();\n                reader.onload = () => {\n                    setImage(reader.result as string);\n                    setModal('crop');\n                };\n                reader.readAsDataURL(file);\n            }\n        }\n    };\n\n    const handleUploadCrop = async () => {\n        if (!image || !croppedAreaPixels || !user) return;\n        setLoading(true);\n        try {\n            const croppedImageBlob = await getCroppedImg(image, croppedAreaPixels);\n            if (!croppedImageBlob) throw new Error(\"Falha ao gerar imagem cortada\");\n\n            const file = new File([croppedImageBlob], 'profile-photo.jpg', { type: 'image/jpeg' });\n\n            const formData = new FormData();\n            formData.append('file', file);\n            formData.append('category', 'avatars');\n            formData.append('public', 'true');\n\n            // 1. Upload da imagem\n            const uploadResp = await api.post('/media/upload', formData, {\n                headers: { 'Content-Type': 'multipart/form-data' }\n            });\n\n            // 2. A url retornada pode ser o id da m칤dia. \n            const photoUrl = `${api.defaults.baseURL}/media/public/${uploadResp.data.id}`;\n\n            // 3. Atualizar o perfil do usu치rio\n            await api.patch('/users/profile/photo', { photoUrl });\n\n            // 4. Atualizar localStorage e estado global\n            const updatedUser = { ...user, photoUrl };\n            localStorage.setItem('user', JSON.stringify(updatedUser));\n            window.dispatchEvent(new Event('auth-changed'));\n\n            setModal(null);\n            setTimeout(() => setActionMsg(''), 3000);\n        } catch (err: unknown) {\n            console.error('Erro ao atualizar foto:', err);\n            const apiError = err as { response?: { data?: { error?: string, message?: string } } };\n            const detail = apiError.response?.data?.error || apiError.response?.data?.message || 'Erro ao atualizar foto.';\n            setActionMsg(detail);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleUpdateProfile = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setLoading(true);\n        setProfileError('');\n\n        try {\n            // Valida칞칚o de documento se preenchido\n            if (profileData.document) {\n                const cleanDoc = sanitizeDocument(profileData.document);\n                const isDocValid = cleanDoc.length === 11 ? isValidCPF(cleanDoc) : (cleanDoc.length === 14 ? isValidCNPJ(cleanDoc) : false);\n\n                if (!isDocValid) {\n                    setProfileError(\"Por favor, insira um CPF ou CNPJ v치lido.\");\n                    setLoading(false);\n                    return;\n                }\n                profileData.document = cleanDoc;\n            }\n\n            await authService.updateProfile(profileData);\n            setActionMsg('Perfil atualizado com sucesso!');\n            setModal(null);\n            setTimeout(() => setActionMsg(''), 3000);\n        } catch (err: unknown) {\n            const apiError = err as { response?: { data?: { message?: string } } };\n            setProfileError(apiError.response?.data?.message || 'Erro ao atualizar perfil.');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    if (!user) return null;\n\n    return (\n        <div className=\"w-full pb-12 font-lato relative\">\n            <div className=\"max-w-4xl mx-auto px-4 pt-8\">\n                {/* Header Profile */}\n                <div className=\"flex items-center gap-6 mb-10\">\n                    <div className=\"relative group\">\n                        <div className=\"w-24 h-24 rounded-full bg-[var(--azul-profundo)] text-[var(--dourado-suave)] flex items-center justify-center text-3xl font-bold font-playfair shadow-lg overflow-hidden border-2 border-[var(--dourado-suave)]\">\n                            {user.photoUrl ? (\n                                <img src={user.photoUrl} alt={user.name} className=\"w-full h-full object-cover\" />\n                            ) : (\n                                <span>{user.name?.[0]?.toUpperCase() || user.email?.[0]?.toUpperCase() || 'U'}</span>\n                            )}\n                        </div>\n\n                        {/* Bot칚o de Trocar Foto (Oculto se for Google) */}\n                        {!user.googleId && (\n                            <label\n                                htmlFor=\"photo-upload\"\n                                className=\"absolute bottom-0 right-0 p-1.5 bg-white rounded-full shadow-md cursor-pointer hover:bg-gray-100 transition-colors border border-gray-200\"\n                                title=\"Mudar foto de perfil\"\n                            >\n                                <Camera size={16} className=\"text-[var(--azul-profundo)]\" />\n                                <input\n                                    id=\"photo-upload\"\n                                    type=\"file\"\n                                    className=\"hidden\"\n                                    accept=\"image/*\"\n                                    onChange={onFileChange}\n                                    disabled={loading}\n                                />\n                            </label>\n                        )}\n                    </div>\n                    <div>\n                        <h1 className=\"text-2xl font-bold text-gray-800\">{user.name || 'Visitante'}</h1>\n                        <p className=\"text-gray-500 mt-1 flex items-center gap-2\">\n                            <Mail size={14} /> {user.email}\n                        </p>\n                    </div>\n                </div>\n\n                {/* Mensagens Globais */}\n                {actionMsg && !modal && (\n                    <div className=\"mb-6 p-4 bg-blue-50 border border-blue-200 text-blue-800 rounded-lg text-sm flex items-center gap-2\">\n                        <Bell size={16} />\n                        {actionMsg}\n                    </div>\n                )}\n\n                {/* Banner de Verifica칞칚o (Apenas para n칚o verificados) */}\n                {user.emailVerified === false && (\n                    <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-10 flex items-start gap-4\">\n                        <AlertTriangle className=\"text-yellow-500 shrink-0 mt-0.5\" size={20} />\n                        <div>\n                            <h3 className=\"text-sm font-bold text-yellow-800\">Verifique seu e-mail</h3>\n                            <p className=\"text-sm text-yellow-700 mt-1 mb-3\">Para garantir a seguran칞a da sua conta e receber notifica칞칫es de pedidos, confirme seu endere칞o de e-mail.</p>\n                            <button\n                                onClick={() => handleAction('/users/resend-verification', { email: user.email }, 'Link enviado para o e-mail!')}\n                                className=\"bg-yellow-500 text-white px-4 py-2 rounded text-sm font-bold hover:bg-yellow-600 transition-colors\"\n                            >\n                                {loading && modal === null ? <Loader2 size={16} className=\"animate-spin inline mr-2\" /> : 'Validar E-mail'}\n                            </button>\n                        </div>\n                    </div>\n                )}\n\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    {!user.googleId && (\n                        <button onClick={() => {\n                            setProfileData({ name: user.name || '', document: user.document || '' });\n                            setModal('info');\n                        }} className=\"bg-white p-6 rounded-lg shadow-sm border border-gray-100 flex items-center justify-between hover:shadow-md transition-shadow group text-left\">\n                            <div className=\"flex items-center gap-4\">\n                                <div className=\"w-12 h-12 bg-blue-50 rounded-full flex items-center justify-center text-blue-500 group-hover:bg-blue-500 group-hover:text-white transition-colors\">\n                                    <UserIcon size={24} />\n                                </div>\n                                <div>\n                                    <h3 className=\"font-bold text-gray-800\">Dados Pessoais</h3>\n                                    <p className=\"text-sm text-gray-500 mt-1\">Nome e Identifica칞칚o Fiscal</p>\n                                </div>\n                            </div>\n                            <ChevronRight className=\"text-gray-300 group-hover:text-blue-500 transition-colors\" />\n                        </button>\n                    )}\n\n                    {!user.googleId && (\n                        <button onClick={() => setModal('security')} className=\"bg-white p-6 rounded-lg shadow-sm border border-gray-100 flex items-center justify-between hover:shadow-md transition-shadow group text-left\">\n                            <div className=\"flex items-center gap-4\">\n                                <div className=\"w-12 h-12 bg-blue-50 rounded-full flex items-center justify-center text-blue-500 group-hover:bg-blue-500 group-hover:text-white transition-colors\">\n                                    <Shield size={24} />\n                                </div>\n                                <div>\n                                    <h3 className=\"font-bold text-gray-800\">Seguran칞a</h3>\n                                    <p className=\"text-sm text-gray-500 mt-1\">Senha e autentica칞칚o</p>\n                                </div>\n                            </div>\n                            <ChevronRight className=\"text-gray-300 group-hover:text-blue-500 transition-colors\" />\n                        </button>\n                    )}\n\n                    <Link to=\"/assinaturas\" className=\"bg-white p-6 rounded-lg shadow-sm border border-gray-100 flex items-center justify-between hover:shadow-md transition-shadow group text-left\">\n                        <div className=\"flex items-center gap-4\">\n                            <div className=\"w-12 h-12 bg-yellow-50 rounded-full flex items-center justify-center text-yellow-500 group-hover:bg-yellow-500 group-hover:text-white transition-colors\">\n                                <Gift size={24} />\n                            </div>\n                            <div>\n                                <h3 className=\"font-bold text-gray-800\">Assinaturas Ateli칡+</h3>\n                                <p className=\"text-sm text-gray-500 mt-1\">Gerencie seu plano mensal</p>\n                            </div>\n                        </div>\n                        <ChevronRight className=\"text-gray-300 group-hover:text-yellow-500 transition-colors\" />\n                    </Link>\n\n                    <Link to=\"/perfil/cartoes\" className=\"bg-white p-6 rounded-lg shadow-sm border border-gray-100 flex items-center justify-between hover:shadow-md transition-shadow group text-left\">\n                        <div className=\"flex items-center gap-4\">\n                            <div className=\"w-12 h-12 bg-blue-50 rounded-full flex items-center justify-center text-blue-500 group-hover:bg-blue-500 group-hover:text-white transition-colors\">\n                                <CreditCard size={24} />\n                            </div>\n                            <div>\n                                <h3 className=\"font-bold text-gray-800\">Cart칫es Salvos</h3>\n                                <p className=\"text-sm text-gray-500 mt-1\">Gerencie formas de pagamento</p>\n                            </div>\n                        </div>\n                        <ChevronRight className=\"text-gray-300 group-hover:text-blue-500 transition-colors\" />\n                    </Link>\n\n                    <Link to=\"/perfil/enderecos\" className=\"bg-white p-6 rounded-lg shadow-sm border border-gray-100 flex items-center justify-between hover:shadow-md transition-shadow group text-left\">\n                        <div className=\"flex items-center gap-4\">\n                            <div className=\"w-12 h-12 bg-blue-50 rounded-full flex items-center justify-center text-blue-500 group-hover:bg-blue-500 group-hover:text-white transition-colors\">\n                                <MapPin size={24} />\n                            </div>\n                            <div>\n                                <h3 className=\"font-bold text-gray-800\">Endere칞os</h3>\n                                <p className=\"text-sm text-gray-500 mt-1\">Locais de entrega das compras</p>\n                            </div>\n                        </div>\n                        <ChevronRight className=\"text-gray-300 group-hover:text-blue-500 transition-colors\" />\n                    </Link>\n\n                </div>\n\n                <div className=\"mt-12 text-center\">\n                    <button onClick={() => setModal('cancel')} className=\"text-sm text-gray-400 hover:text-red-500 transition-colors hover:underline\">\n                        Deseja cancelar sua conta?\n                    </button>\n                </div>\n            </div>\n\n            {/* Modals Extras */}\n            {modal && (\n                <div className=\"fixed inset-0 z-50 bg-black/60 flex items-center justify-center p-4 backdrop-blur-sm\">\n                    <div className={`${modal === 'crop' ? 'max-w-xl' : 'max-w-md'} bg-white w-full rounded shadow-2xl p-6 relative`}>\n                        <button onClick={() => { setModal(null); setActionMsg(''); }} className=\"absolute top-4 right-4 z-10 text-gray-400 hover:text-gray-800 bg-white rounded-full p-1\">\n                            <X size={20} />\n                        </button>\n\n                        {modal === 'info' && (\n                            <div>\n                                <h2 className=\"text-xl font-bold mb-4 text-gray-800\">Dados Pessoais</h2>\n                                <form onSubmit={handleUpdateProfile} className=\"space-y-4\">\n                                    <div>\n                                        <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Nome Completo</label>\n                                        <input\n                                            type=\"text\"\n                                            value={profileData.name}\n                                            onChange={(e) => setProfileData({ ...profileData, name: e.target.value })}\n                                            className=\"w-full border border-gray-200 rounded px-4 py-2 focus:border-[var(--azul-profundo)] outline-none\"\n                                            required\n                                        />\n                                    </div>\n                                    <MaskedInput\n                                        mask=\"cpf-cnpj\"\n                                        label=\"CPF ou CNPJ\"\n                                        value={profileData.document}\n                                        onChange={(val) => setProfileData({ ...profileData, document: val })}\n                                    />\n                                    <p className=\"text-[10px] text-gray-400 uppercase tracking-widest leading-relaxed\">\n                                        Necess치rio para a emiss칚o de Notas Fiscais Eletr칪nicas.\n                                    </p>\n\n                                    {profileError && <p className=\"text-xs text-red-500 font-bold\">{profileError}</p>}\n\n                                    <button\n                                        type=\"submit\"\n                                        disabled={loading}\n                                        className=\"w-full bg-[var(--azul-profundo)] text-white py-2 rounded font-bold hover:bg-[#0a1e33] flex items-center justify-center gap-2\"\n                                    >\n                                        {loading ? <Loader2 size={16} className=\"animate-spin\" /> : 'Salvar Altera칞칫es'}\n                                    </button>\n                                </form>\n                                <div className=\"mt-6 pt-6 border-t border-gray-100\">\n                                    <p className=\"text-xs text-gray-500 mb-3 text-center italic\">Para outras altera칞칫es cr칤ticas, contate o suporte.</p>\n                                    <a href=\"https://wa.me/5511963212172\" target=\"_blank\" rel=\"noreferrer\" className=\"block w-full text-center border border-gray-200 text-gray-600 py-2 rounded font-bold hover:bg-gray-50 text-sm\">Falar no WhatsApp</a>\n                                </div>\n                            </div>\n                        )}\n\n                        {modal === 'security' && (\n                            <div>\n                                <h2 className=\"text-xl font-bold mb-4 text-gray-800\">Trocar Senha</h2>\n                                <p className=\"text-sm text-gray-600 mb-4\">Voc칡 receber치 um e-mail com um link seguro para redefinir sua senha.</p>\n                                <button\n                                    onClick={() => handleAction('/auth/forgot-password', { email: user.email }, 'Link de redefini칞칚o enviado!')}\n                                    disabled={loading}\n                                    className=\"w-full bg-[var(--azul-profundo)] text-white py-2 rounded font-bold hover:bg-[#0a1e33] disabled:opacity-50\"\n                                >\n                                    {loading ? <Loader2 size={16} className=\"animate-spin mx-auto\" /> : 'Solicitar Redefini칞칚o'}\n                                </button>\n                                {actionMsg && <p className=\"mt-3 text-sm font-bold text-green-600 text-center\">{actionMsg}</p>}\n                            </div>\n                        )}\n\n                        {modal === 'crop' && image && (\n                            <div className=\"flex flex-col\">\n                                <h2 className=\"text-xl font-bold mb-4 text-gray-800\">Ajustar Foto</h2>\n                                <div className=\"relative w-full h-80 bg-gray-100 rounded-lg overflow-hidden mb-4\">\n                                    <Cropper\n                                        image={image}\n                                        crop={crop}\n                                        zoom={zoom}\n                                        aspect={1}\n                                        onCropChange={setCrop}\n                                        onCropComplete={onCropComplete}\n                                        onZoomChange={setZoom}\n                                    />\n                                </div>\n                                <div className=\"flex flex-col gap-4\">\n                                    <div className=\"flex items-center gap-4\">\n                                        <span className=\"text-sm text-gray-500\">Zoom</span>\n                                        <input\n                                            type=\"range\"\n                                            value={zoom}\n                                            min={1}\n                                            max={3}\n                                            step={0.1}\n                                            onChange={(e) => setZoom(parseFloat(e.target.value))}\n                                            className=\"grow accent-[var(--azul-profundo)]\"\n                                        />\n                                    </div>\n                                    <div className=\"flex gap-3\">\n                                        <button\n                                            onClick={() => setModal(null)}\n                                            className=\"flex-1 border border-gray-300 text-gray-700 py-2 rounded font-bold hover:bg-gray-50\"\n                                        >\n                                            Cancelar\n                                        </button>\n                                        <button\n                                            onClick={handleUploadCrop}\n                                            disabled={loading}\n                                            className=\"flex-1 bg-[var(--azul-profundo)] text-white py-2 rounded font-bold hover:bg-[#0a1e33] flex items-center justify-center gap-2\"\n                                        >\n                                            {loading ? <Loader2 size={16} className=\"animate-spin\" /> : 'Salvar Foto'}\n                                        </button>\n                                    </div>\n                                    {actionMsg && <p className=\"text-sm font-bold text-red-600 text-center\">{actionMsg}</p>}\n                                </div>\n                            </div>\n                        )}\n\n\n                        {modal === 'cancel' && (\n                            <div>\n                                <h2 className=\"text-xl font-bold mb-2 text-red-600\">Alerta de Exclus칚o</h2>\n                                <p className=\"text-sm text-gray-600 mb-6\">Tem certeza que deseja cancelar sua conta? <b>Esta a칞칚o n칚o pode ser desfeita</b> e todo o seu hist칩rico ser치 permanentemente apagado.</p>\n                                <div className=\"flex gap-3\">\n                                    <button onClick={() => setModal(null)} className=\"flex-1 border border-gray-300 text-gray-700 py-2 rounded font-bold hover:bg-gray-50\">Voltar</button>\n                                    <button onClick={handleCancelAccount} disabled={loading} className=\"flex-1 bg-red-600 text-white py-2 rounded font-bold hover:bg-red-700 disabled:opacity-50\">\n                                        {loading ? <Loader2 size={16} className=\"animate-spin mx-auto\" /> : 'Confirmar Exclus칚o'}\n                                    </button>\n                                </div>\n                                {actionMsg && <p className=\"mt-3 text-sm font-bold text-red-600 text-center\">{actionMsg}</p>}\n                            </div>\n                        )}\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default ProfilePage;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/QuestionsPage.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/QuestionsPage.tsx:32:13\n  30 |                 });\n  31 |         } else {\n> 32 |             setLoading(false);\n     |             ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  33 |         }\n  34 |     }, [user]);\n  35 |","line":32,"column":13,"nodeType":null,"endLine":32,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Search, MessageSquare, CornerDownRight } from 'lucide-react';\nimport SEO from '../components/SEO';\nimport { useOutletContext, Link } from 'react-router-dom';\nimport api from '../services/api';\nimport { getImageUrl } from '../utils/imageUtils';\nimport { User, ProductQuestion } from '../types';\n\ninterface UserContext {\n    user: User | null;\n}\n\nconst QuestionsPage: React.FC = () => {\n    const { user } = useOutletContext<UserContext>();\n    const [searchTerm, setSearchTerm] = useState<string>('');\n    const [questions, setQuestions] = useState<ProductQuestion[]>([]);\n    const [loading, setLoading] = useState<boolean>(true);\n\n    useEffect(() => {\n        const userId = user?.id;\n        if (userId) {\n            api.get(`/questions?userId=${userId}`)\n                .then(res => {\n                    setQuestions(res.data);\n                    setLoading(false);\n                })\n                .catch(err => {\n                    console.error(\"Error fetching questions:\", err);\n                    setLoading(false);\n                });\n        } else {\n            setLoading(false);\n        }\n    }, [user]);\n\n    if (!user) return null;\n\n    const filteredQuestions = questions.filter(q =>\n        (q.product?.name || '').toLowerCase().includes(searchTerm.toLowerCase()) ||\n        q.question.toLowerCase().includes(searchTerm.toLowerCase())\n    );\n\n    if (loading) return (\n        <div className=\"flex justify-center items-center h-64\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500\"></div>\n        </div>\n    );\n\n    return (\n        <div className=\"w-full pb-12 font-lato\">\n            <SEO title=\"Minhas Perguntas\" description=\"Acompanhe as perguntas que voc칡 fez aos vendedores.\" />\n\n            <div className=\"max-w-5xl mx-auto px-4 pt-8\">\n                {/* Header */}\n                <div className=\"mb-6 flex flex-col md:flex-row md:items-center justify-between gap-4\">\n                    <div>\n                        <h1 className=\"text-2xl font-bold text-gray-800 font-playfair\">Perguntas</h1>\n                        <p className=\"text-gray-500 text-sm mt-1\">Acompanhe as d칰vidas que voc칡 tirou antes de comprar.</p>\n                    </div>\n                </div>\n\n                {/* Filtros */}\n                <div className=\"flex items-center gap-4 mb-8\">\n                    <div className=\"relative w-full md:w-1/2\">\n                        <input\n                            type=\"text\"\n                            placeholder=\"Buscar nas minhas perguntas...\"\n                            value={searchTerm}\n                            onChange={(e) => setSearchTerm(e.target.value)}\n                            className=\"w-full pl-10 pr-4 py-2.5 bg-white border border-gray-300 rounded-md text-sm focus:outline-none focus:border-blue-500 shadow-sm\"\n                        />\n                        <Search className=\"absolute left-3 top-3 text-gray-400\" size={18} />\n                    </div>\n                </div>\n\n                {/* Lista de Perguntas */}\n                <div className=\"space-y-4\">\n                    {filteredQuestions.length === 0 ? (\n                        <div className=\"text-center py-16 bg-white rounded-md border border-gray-200\">\n                            <MessageSquare className=\"mx-auto text-gray-300 mb-4\" size={48} strokeWidth={1.5} />\n                            <h3 className=\"text-lg font-semibold text-gray-700 mb-2\">Nenhuma pergunta encontrada</h3>\n                            <p className=\"text-gray-500 text-sm\">Tire suas d칰vidas nos an칰ncios antes de comprar.</p>\n                        </div>\n                    ) : (\n                        filteredQuestions.map((item) => (\n                            <div key={item.id} className=\"bg-white rounded-md shadow-sm border border-gray-200 overflow-hidden\">\n\n                                {/* Cabe칞alho do Card (Produto) */}\n                                <div className=\"p-4 border-b border-gray-100 bg-gray-50/50 flex items-center gap-4\">\n                                    <div className=\"w-12 h-12 shrink-0 border border-gray-200 rounded p-1 bg-white\">\n                                        <img\n                                            src={getImageUrl(item.product?.images?.[0] || '')}\n                                            alt={item.product?.name || 'Produto'}\n                                            onError={(e: React.SyntheticEvent<HTMLImageElement, Event>) => {\n                                                const target = e.target as HTMLImageElement;\n                                                target.src = '/images/default.png';\n                                            }}\n                                            className=\"w-full h-full object-contain mix-blend-multiply\"\n                                        />\n                                    </div>\n                                    <div className=\"flex-1\">\n                                        <h3 className=\"text-sm font-semibold text-gray-800 line-clamp-1\">{item.product?.name}</h3>\n                                        <Link to={`/store`} className=\"text-xs text-blue-500 hover:text-blue-600 transition-colors\">Ver an칰ncio</Link>\n                                    </div>\n\n                                    {/* Badge Status */}\n                                    <div>\n                                        {item.status === 'ANSWERED' ? (\n                                            <span className=\"bg-green-100 text-green-700 text-[10px] font-bold uppercase tracking-wider px-2 py-1 rounded\">Respondida</span>\n                                        ) : (\n                                            <span className=\"bg-yellow-100 text-yellow-700 text-[10px] font-bold uppercase tracking-wider px-2 py-1 rounded\">Aguardando</span>\n                                        )}\n                                    </div>\n                                </div>\n\n                                {/* Corpo da Pergunta/Resposta */}\n                                <div className=\"p-6\">\n                                    {/* A Pergunta */}\n                                    <div className=\"flex gap-4\">\n                                        <div className=\"w-8 h-8 rounded-full bg-blue-50 text-blue-500 flex items-center justify-center shrink-0\">\n                                            <MessageSquare size={16} />\n                                        </div>\n                                        <div>\n                                            <p className=\"text-gray-800 text-sm mb-1\">{item.question}</p>\n                                            <p className=\"text-xs text-gray-400\">{new Date(item.createdAt).toLocaleDateString('pt-BR')}</p>\n                                        </div>\n                                    </div>\n\n                                    {/* A Resposta (se houver) */}\n                                    {item.status === 'ANSWERED' && (\n                                        <div className=\"flex gap-4 mt-4 ml-4 pl-4 border-l-2 border-gray-100\">\n                                            <div className=\"w-8 h-8 rounded-full bg-gray-100 text-gray-500 flex items-center justify-center shrink-0\">\n                                                <CornerDownRight size={16} />\n                                            </div>\n                                            <div>\n                                                <p className=\"text-gray-700 text-sm mb-1\">{item.answer}</p>\n                                                <p className=\"text-xs text-gray-400\">{item.answeredAt ? new Date(item.answeredAt).toLocaleDateString('pt-BR') : ''}</p>\n                                            </div>\n                                        </div>\n                                    )}\n                                </div>\n                            </div>\n                        ))\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default QuestionsPage;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/ReturnsPolicyPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/ReviewsPage.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/ReviewsPage.tsx:52:13\n  50 |         const userId = user?.id || user?.googleId;\n  51 |         if (userId) {\n> 52 |             fetchReviews(userId);\n     |             ^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  53 |         } else {\n  54 |             setLoading(false);\n  55 |         }","line":52,"column":13,"nodeType":null,"endLine":52,"endColumn":25},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchReviews'. Either include it or remove the dependency array.","line":56,"column":8,"nodeType":"ArrayExpression","endLine":56,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [user, activeTab, fetchReviews]","fix":{"range":[1824,1841],"text":"[user, activeTab, fetchReviews]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Star } from 'lucide-react';\nimport SEO from '../components/SEO';\nimport { useOutletContext } from 'react-router-dom';\nimport ReviewForm from '../components/ReviewForm';\nimport api from '../services/api';\nimport { getImageUrl } from '../utils/imageUtils';\nimport { User, Review } from '../types';\n\ninterface UserContext {\n    user: User | null;\n}\n\ninterface PendingReviewItem {\n    id: string;\n    name: string;\n    images?: string[];\n}\n\nconst ReviewsPage: React.FC = () => {\n    const { user } = useOutletContext<UserContext>();\n    const [activeTab, setActiveTab] = useState<'pending' | 'completed'>('pending');\n    const [pendingReviews, setPendingReviews] = useState<PendingReviewItem[]>([]);\n    const [completedReviews, setCompletedReviews] = useState<Review[]>([]);\n    const [loading, setLoading] = useState<boolean>(true);\n    const [reviewItem, setReviewItem] = useState<PendingReviewItem | null>(null);\n\n    const fetchReviews = (userId: string) => {\n        setLoading(true);\n        const endpoint = activeTab === 'pending'\n            ? `/reviews/user/${userId}/pending`\n            : `/reviews/user/${userId}`;\n\n        api.get(endpoint)\n            .then(res => {\n                if (activeTab === 'pending') {\n                    setPendingReviews(res.data);\n                } else {\n                    setCompletedReviews(res.data);\n                }\n                setLoading(false);\n            })\n            .catch(err => {\n                console.error(\"Error fetching reviews:\", err);\n                setLoading(false);\n            });\n    };\n\n    useEffect(() => {\n        const userId = user?.id || user?.googleId;\n        if (userId) {\n            fetchReviews(userId);\n        } else {\n            setLoading(false);\n        }\n    }, [user, activeTab]);\n\n    if (!user) return null;\n\n    const handleReviewSubmitted = (itemId: string) => {\n        setPendingReviews(prev => prev.filter(item => item.id !== itemId));\n        setReviewItem(null);\n    };\n\n    return (\n        <div className=\"w-full pb-12 font-lato\">\n            <SEO title=\"Minhas Opini칫es\" description=\"Suas opini칫es sobre os produtos comprados.\" />\n\n            {/* Modal de Avalia칞칚o Reaproveitado */}\n            {reviewItem && (\n                <div className=\"fixed inset-0 z-50 bg-black/60 flex items-center justify-center p-4 backdrop-blur-sm\">\n                    <div className=\"bg-white w-full max-w-xl rounded-sm shadow-2xl p-8 relative max-h-[90vh] overflow-y-auto\">\n                        <button\n                            onClick={() => setReviewItem(null)}\n                            className=\"absolute top-4 right-4 text-gray-400 hover:text-[var(--azul-profundo)] transition-colors\"\n                        >\n                            九뎊n                        </button>\n                        <div className=\"mb-6 flex items-center gap-4 border-b border-gray-100 pb-4\">\n                            <div className=\"w-16 h-16 shrink-0 border border-gray-200 rounded p-1 flex items-center justify-center bg-gray-50\">\n                                <img\n                                    src={getImageUrl(reviewItem.images?.[0] || '')}\n                                    alt={reviewItem.name}\n                                    onError={(e: React.SyntheticEvent<HTMLImageElement, Event>) => {\n                                        const target = e.target as HTMLImageElement;\n                                        target.src = '/images/default.png';\n                                    }}\n                                    className=\"max-w-full max-h-full object-contain\"\n                                />\n                            </div>\n                            <div>\n                                <h3 className=\"font-playfair text-xl text-[var(--azul-profundo)] mb-1\">Avaliar Produto</h3>\n                                <p className=\"font-lato text-sm text-gray-500 line-clamp-1\">{reviewItem.name}</p>\n                            </div>\n                        </div>\n                        <ReviewForm\n                            productId={reviewItem.id}\n                            onReviewSubmitted={() => handleReviewSubmitted(reviewItem.id)}\n                        />\n                    </div>\n                </div>\n            )}\n\n            <div className=\"max-w-4xl mx-auto px-4 pt-8\">\n                <h1 className=\"text-2xl font-bold text-gray-800 mb-6 font-playfair\">Opini칫es</h1>\n\n                {/* Tabs */}\n                <div className=\"flex border-b border-gray-200 mb-6\">\n                    <button\n                        onClick={() => setActiveTab('pending')}\n                        className={`px-6 py-3 text-sm font-semibold transition-colors border-b-2 ${activeTab === 'pending'\n                            ? 'border-blue-500 text-blue-500'\n                            : 'border-transparent text-gray-500 hover:text-gray-700'\n                            }`}\n                    >\n                        Pendentes\n                    </button>\n                    <button\n                        onClick={() => setActiveTab('completed')}\n                        className={`px-6 py-3 text-sm font-semibold transition-colors border-b-2 ${activeTab === 'completed'\n                            ? 'border-blue-500 text-blue-500'\n                            : 'border-transparent text-gray-500 hover:text-gray-700'\n                            }`}\n                    >\n                        Realizadas\n                    </button>\n                </div>\n\n                {/* Content */}\n                {loading ? (\n                    <div className=\"flex justify-center py-20\">\n                        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500\"></div>\n                    </div>\n                ) : activeTab === 'pending' ? (\n                    <div>\n                        <div className=\"flex justify-between items-center mb-4\">\n                            <h2 className=\"text-sm font-semibold text-gray-600\">D칡 sua opini칚o e ajude a mais pessoas</h2>\n                            <span className=\"text-sm text-gray-400\">\n                                {pendingReviews.length} opini칫es pendentes\n                            </span>\n                        </div>\n\n                        <div className=\"space-y-4\">\n                            {pendingReviews.length === 0 ? (\n                                <div className=\"text-center py-12 bg-white rounded-md border border-gray-200\">\n                                    <p className=\"text-gray-500\">Voc칡 n칚o tem produtos pendentes de avalia칞칚o!</p>\n                                </div>\n                            ) : (\n                                pendingReviews.map((item) => (\n                                    <div key={item.id} className=\"bg-white rounded-md border border-gray-200 p-6 flex flex-col md:flex-row items-center gap-6 shadow-sm hover:shadow-md transition-shadow\">\n\n                                        {/* Imagem e Nome */}\n                                        <div className=\"flex items-center gap-4 flex-1 w-full\">\n                                            <div className=\"w-16 h-16 shrink-0 border border-gray-200 rounded p-1 flex items-center justify-center bg-gray-50\">\n                                                <img\n                                                    src={getImageUrl(item.images?.[0] || '')}\n                                                    alt={item.name}\n                                                    onError={(e: React.SyntheticEvent<HTMLImageElement, Event>) => {\n                                                        const target = e.target as HTMLImageElement;\n                                                        target.src = '/images/default.png';\n                                                    }}\n                                                    className=\"max-w-full max-h-full object-contain mix-blend-multiply\"\n                                                />\n                                            </div>\n                                            <h3 className=\"text-sm font-bold text-gray-800 line-clamp-2 md:pr-4\">{item.name}</h3>\n                                        </div>\n\n                                        {/* Estrelas Clic치veis para Avaliar */}\n                                        <div className=\"flex items-center gap-1 group cursor-pointer\" onClick={() => setReviewItem(item)}>\n                                            {[1, 2, 3, 4, 5].map((star) => (\n                                                <Star\n                                                    key={star}\n                                                    size={28}\n                                                    strokeWidth={1}\n                                                    className=\"text-gray-300 group-hover:text-blue-500 group-hover:fill-blue-100 transition-colors\"\n                                                />\n                                            ))}\n                                        </div>\n                                    </div>\n                                ))\n                            )}\n                        </div>\n                    </div>\n                ) : (\n                    <div className=\"space-y-4\">\n                        {completedReviews.length === 0 ? (\n                            <div className=\"text-center py-12 bg-white rounded-md border border-gray-200\">\n                                <p className=\"text-gray-500\">Voc칡 ainda n칚o avaliou nenhum produto.</p>\n                            </div>\n                        ) : (\n                            completedReviews.map((review) => (\n                                <div key={review.id} className=\"bg-white rounded-md border border-gray-200 p-6 shadow-sm\">\n                                    <div className=\"flex items-center gap-4 mb-4\">\n                                        <div className=\"w-12 h-12 shrink-0 border border-gray-100 rounded p-1 flex items-center justify-center\">\n                                            <img\n                                                src={getImageUrl(review.user?.name || '')} // Review object structure checkout\n                                                alt={review.userName}\n                                                onError={(e: React.SyntheticEvent<HTMLImageElement, Event>) => {\n                                                    const target = e.target as HTMLImageElement;\n                                                    target.src = '/images/default.png';\n                                                }}\n                                                className=\"max-w-full max-h-full object-contain\"\n                                            />\n                                        </div>\n                                        <div className=\"flex-1\">\n                                            <h3 className=\"text-sm font-bold text-gray-800 line-clamp-1\">{review.userName || 'Doador'}</h3>\n                                            <div className=\"flex items-center gap-1 mt-1\">\n                                                {[...Array(5)].map((_, i) => (\n                                                    <Star\n                                                        key={i}\n                                                        size={14}\n                                                        fill={i < review.rating ? \"#EAB308\" : \"none\"}\n                                                        className={i < review.rating ? \"text-yellow-500\" : \"text-gray-300\"}\n                                                    />\n                                                ))}\n                                            </div>\n                                        </div>\n                                        <div className=\"text-xs text-gray-400\">\n                                            {new Date(review.createdAt).toLocaleDateString('pt-BR')}\n                                        </div>\n                                    </div>\n                                    <p className=\"text-sm text-gray-600 italic\">\"{review.comment}\"</p>\n                                </div>\n                            ))\n                        )}\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default ReviewsPage;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/SavedCardsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1115,1118],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1115,1118],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement. Only these console methods are allowed: warn, error.","line":54,"column":25,"nodeType":"MemberExpression","messageId":"limited","endLine":54,"endColumn":36,"suggestions":[{"fix":{"range":[1899,1957],"text":""},"messageId":"removeConsole","data":{"propertyName":"log"},"desc":"Remove the console.log()."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":68,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2872,2875],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2872,2875],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement. Only these console methods are allowed: warn, error.","line":73,"column":41,"nodeType":"MemberExpression","messageId":"limited","endLine":73,"endColumn":52,"suggestions":[{"fix":{"range":[3215,3260],"text":""},"messageId":"removeConsole","data":{"propertyName":"log"},"desc":"Remove the console.log()."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":89,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":89,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4153,4156],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4153,4156],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":95,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4480,4483],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4480,4483],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":129,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":129,"endColumn":21}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\nimport { CreditCard, Plus, Trash2, ShieldCheck, AlertTriangle, Loader2 } from 'lucide-react';\nimport SEO from '../components/SEO';\nimport { useOutletContext } from 'react-router-dom';\nimport cardService from '../services/cardService';\nimport { useMercadoPago } from '../hooks/useMercadoPago';\nimport { User, Card } from '../types';\n\ninterface UserContext {\n    user: User | null;\n}\n\nconst brandLogos: Record<string, string> = {\n    visa: '游눱 Visa',\n    master: '游눱 Mastercard',\n    amex: '游눱 Amex',\n    elo: '游눱 Elo',\n    hipercard: '游눱 Hipercard',\n};\n\nconst SavedCardsPage: React.FC = () => {\n    const { user } = useOutletContext<UserContext>();\n    const { mp, loading: mpLoading, isConfigured, error: mpError } = useMercadoPago();\n    const [cards, setCards] = useState<Card[]>([]);\n    const [loading, setLoading] = useState<boolean>(true);\n    const [showAddForm, setShowAddForm] = useState<boolean>(false);\n    const [saving, setSaving] = useState<boolean>(false);\n    const [error, setError] = useState<string>('');\n    const cardFormRef = useRef<any>(null);\n\n    useEffect(() => {\n        const userId = user?.id || user?.googleId;\n        if (userId) {\n            fetchCards();\n        } else {\n            setLoading(false);\n        }\n    }, [user]);\n\n    // Inicializa CardForm quando o formul치rio 칠 exibido e MP est치 pronto\n    useEffect(() => {\n        let mounted = true;\n\n        const initCardForm = () => {\n            if (showAddForm && mp && isConfigured && !cardFormRef.current) {\n                // Pequeno timeout para garantir que os elementos ID est칚o no DOM\n                setTimeout(() => {\n                    if (!mounted) return;\n\n                    const container = document.getElementById('mp-card-number');\n                    if (!container) return;\n\n                    try {\n                        console.log(\"[SavedCardsPage] Inicializando CardForm...\");\n                        cardFormRef.current = mp.cardForm({\n                            amount: '1.0',\n                            iframe: true,\n                            form: {\n                                id: 'mp-card-form',\n                                cardNumber: { id: 'mp-card-number', placeholder: '0000 0000 0000 0000' },\n                                expirationDate: { id: 'mp-expiration-date', placeholder: 'MM/AA' },\n                                securityCode: { id: 'mp-security-code', placeholder: 'CVV' },\n                                cardholderName: { id: 'mp-cardholder-name' },\n                                identificationType: { id: 'mp-identification-type' },\n                                identificationNumber: { id: 'mp-identification-number' },\n                            },\n                            callbacks: {\n                                onFormMounted: (error: any) => {\n                                    if (error) {\n                                        console.error('Erro ao montar form:', error);\n                                        setError('Erro ao carregar campos seguros. Tente recarregar a p치gina.');\n                                    } else {\n                                        console.log('CardForm montado com sucesso.');\n                                    }\n                                },\n                                onSubmit: async (event: React.FormEvent) => {\n                                    event.preventDefault();\n                                    setSaving(true);\n                                    setError('');\n\n                                    try {\n                                        const formData = cardFormRef.current.getCardFormData();\n                                        if (formData.token) {\n                                            await cardService.saveCard(formData.token);\n                                            fetchCards();\n                                            setShowAddForm(false);\n                                            cardFormRef.current = null;\n                                        }\n                                    } catch (err: any) {\n                                        setError(err.message || 'Erro ao salvar cart칚o.');\n                                    } finally {\n                                        setSaving(false);\n                                    }\n                                },\n                                onError: (errors: any[]) => {\n                                    const errorMsg = errors.find(e => e.message)?.message || 'Verifique os dados do cart칚o.';\n                                    setError(errorMsg);\n                                    setSaving(false);\n                                }\n                            }\n                        });\n                    } catch (e) {\n                        console.error('Erro ao inicializar CardForm:', e);\n                    }\n                }, 200);\n            }\n        };\n\n        initCardForm();\n\n        return () => {\n            mounted = false;\n        };\n    }, [showAddForm, mp, isConfigured]);\n\n    const fetchCards = () => {\n        setLoading(true);\n        cardService.listCards()\n            .then(data => setCards(data))\n            .catch(() => setCards([]))\n            .finally(() => setLoading(false));\n    };\n\n    const handleDelete = async (cardId: string) => {\n        if (!confirm('Tem certeza que deseja remover este cart칚o?')) return;\n        try {\n            await cardService.deleteCard(cardId);\n            setCards(prev => prev.filter(c => c.id !== cardId));\n        } catch (err) {\n            setError('Erro ao remover cart칚o.');\n        }\n    };\n\n    const handleFormSubmit = (e: React.FormEvent) => {\n        e.preventDefault();\n        if (cardFormRef.current) {\n            cardFormRef.current.submit();\n        }\n    };\n\n    if (!user) return null;\n\n    return (\n        <div className=\"w-full pb-12 font-lato\">\n            <SEO title=\"Cart칫es Salvos\" description=\"Gerencie seus cart칫es de pagamento salvos.\" />\n\n            <div className=\"max-w-4xl mx-auto px-4 pt-8\">\n                {/* Header */}\n                <div className=\"mb-6 flex flex-col md:flex-row md:items-center justify-between gap-4\">\n                    <div>\n                        <h1 className=\"text-2xl font-bold text-gray-800\">Cart칫es Salvos</h1>\n                        <p className=\"text-gray-500 text-sm mt-1\">Gerencie seus m칠todos de pagamento para compras e assinaturas.</p>\n                    </div>\n                    <button\n                        onClick={() => setShowAddForm(!showAddForm)}\n                        className=\"flex items-center gap-2 bg-[var(--azul-profundo)] text-white px-5 py-2.5 rounded text-sm font-semibold hover:bg-[#0a1e33] transition-colors\"\n                    >\n                        <Plus size={18} />\n                        Adicionar Cart칚o\n                    </button>\n                </div>\n\n                {/* Banner de Seguran칞a / Aviso de Configura칞칚o */}\n                {!isConfigured && !mpLoading ? (\n                    <div className=\"bg-amber-50 rounded-md p-6 mb-8 border border-amber-200 flex items-start gap-4 animate-in fade-in slide-in-from-top-4\">\n                        <div className=\"w-12 h-12 flex items-center justify-center bg-amber-100 text-amber-600 rounded-full shrink-0\">\n                            <AlertTriangle size={24} />\n                        </div>\n                        <div>\n                            <h3 className=\"text-sm text-amber-900 font-bold uppercase tracking-widest mb-1\">Aten칞칚o: Configura칞칚o Pendente</h3>\n                            <p className=\"text-xs text-amber-800/80 leading-relaxed\">\n                                A integra칞칚o com o Mercado Pago ainda n칚o foi conclu칤da pelo administrador.\n                                O salvamento de novos cart칫es estar치 dispon칤vel assim que as chaves de API forem configuradas no Dashboard.\n                            </p>\n                        </div>\n                    </div>\n                ) : (\n                    <div className=\"bg-white rounded-md p-4 mb-6 shadow-sm border border-gray-200 flex items-center gap-4\">\n                        <div className=\"w-12 h-12 flex items-center justify-center bg-green-50 text-green-600 rounded-full shrink-0\">\n                            <ShieldCheck size={24} />\n                        </div>\n                        <div>\n                            <p className=\"text-sm text-gray-800 font-semibold mb-1\">Seus dados est칚o seguros</p>\n                            <p className=\"text-xs text-gray-500\">Os cart칫es s칚o tokenizados pelo Mercado Pago. Nunca armazenamos dados sens칤veis do cart칚o diretamente.</p>\n                        </div>\n                    </div>\n                )}\n\n                {/* Erro */}\n                {(error || mpError) && (\n                    <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-6 flex items-center gap-2 text-sm\">\n                        <AlertTriangle size={16} />\n                        {error || mpError}\n                    </div>\n                )}\n\n                {/* Formul치rio para Adicionar Cart칚o */}\n                {showAddForm && (\n                    <div className=\"bg-white rounded-md shadow-sm border border-gray-200 p-8 mb-6 animate-in fade-in slide-in-from-top-4\">\n                        <h3 className=\"text-sm font-bold text-[var(--azul-profundo)] mb-6 flex items-center gap-2\">\n                            <CreditCard size={18} />\n                            Novo Cart칚o de Cr칠dito\n                        </h3>\n\n                        {mpLoading ? (\n                            <div className=\"flex flex-col items-center justify-center py-8 text-gray-400\">\n                                <Loader2 size={32} className=\"animate-spin mb-2\" />\n                                <p className=\"text-xs font-medium uppercase tracking-widest\">Carregando Mercado Pago...</p>\n                            </div>\n                        ) : !isConfigured ? (\n                            <div className=\"text-center py-12 border-2 border-dashed border-gray-200 rounded-lg\">\n                                <AlertTriangle size={32} className=\"mx-auto text-amber-500 mb-4 opacity-40\" />\n                                <p className=\"text-[10px] uppercase font-bold tracking-widest text-gray-400\">Os campos seguros ser칚o carregados automaticamente <br /> ap칩s a configura칞칚o da Chave P칰blica no Dashboard.</p>\n                            </div>\n                        ) : (\n                            <form id=\"mp-card-form\" onSubmit={handleFormSubmit} className=\"space-y-6\">\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                                    <div className=\"md:col-span-2\">\n                                        <label className=\"block text-[10px] font-bold uppercase tracking-widest text-gray-500 mb-2\">N칰mero do Cart칚o</label>\n                                        <div id=\"mp-card-number\" className=\"h-12 border border-gray-200 rounded-md px-4 py-3 bg-gray-50 focus-within:border-[var(--dourado-suave)] transition-colors\"></div>\n                                    </div>\n\n                                    <div className=\"md:col-span-2\">\n                                        <label className=\"block text-[10px] font-bold uppercase tracking-widest text-gray-500 mb-2\">Nome do Titular</label>\n                                        <input type=\"text\" id=\"mp-cardholder-name\" placeholder=\"Como impresso no cart칚o\" className=\"w-full h-12 border border-gray-200 rounded-md px-4 py-3 bg-gray-50 focus:outline-none focus:border-[var(--dourado-suave)] transition-colors text-sm uppercase\" />\n                                    </div>\n\n                                    <div>\n                                        <label className=\"block text-[10px] font-bold uppercase tracking-widest text-gray-500 mb-2\">Vencimento</label>\n                                        <div id=\"mp-expiration-date\" className=\"h-12 border border-gray-200 rounded-md px-4 py-3 bg-gray-50 focus-within:border-[var(--dourado-suave)] transition-colors\"></div>\n                                    </div>\n\n                                    <div>\n                                        <label className=\"block text-[10px] font-bold uppercase tracking-widest text-gray-500 mb-2\">C칩digo de Seguran칞a</label>\n                                        <div id=\"mp-security-code\" className=\"h-12 border border-gray-200 rounded-md px-4 py-3 bg-gray-50 focus-within:border-[var(--dourado-suave)] transition-colors\"></div>\n                                    </div>\n\n                                    <div>\n                                        <label className=\"block text-[10px] font-bold uppercase tracking-widest text-gray-500 mb-2\">Tipo de Documento</label>\n                                        <select id=\"mp-identification-type\" className=\"w-full h-12 border border-gray-200 rounded-md px-4 py-3 bg-gray-50 focus:outline-none focus:border-[var(--dourado-suave)] transition-colors text-sm\"></select>\n                                    </div>\n\n                                    <div>\n                                        <label className=\"block text-[10px] font-bold uppercase tracking-widest text-gray-500 mb-2\">N칰mero do Documento</label>\n                                        <input type=\"text\" id=\"mp-identification-number\" className=\"w-full h-12 border border-gray-200 rounded-md px-4 py-3 bg-gray-50 focus:outline-none focus:border-[var(--dourado-suave)] transition-colors text-sm\" />\n                                    </div>\n                                </div>\n\n                                <div className=\"flex gap-4 pt-4\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => setShowAddForm(false)}\n                                        className=\"flex-1 px-6 py-3 border border-gray-300 rounded-md text-xs font-bold uppercase tracking-widest text-gray-500 hover:bg-gray-50 transition-colors\"\n                                    >\n                                        Cancelar\n                                    </button>\n                                    <button\n                                        type=\"submit\"\n                                        id=\"mp-form-submit\"\n                                        disabled={saving}\n                                        className=\"flex-1 bg-[var(--azul-profundo)] text-white px-6 py-3 rounded-md text-xs font-bold uppercase tracking-widest hover:bg-[#0a1e33] transition disabled:opacity-50 flex items-center justify-center gap-2\"\n                                    >\n                                        {saving ? (\n                                            <>\n                                                <Loader2 size={16} className=\"animate-spin\" />\n                                                Validando...\n                                            </>\n                                        ) : (\n                                            'Salvar Cart칚o'\n                                        )}\n                                    </button>\n                                </div>\n                            </form>\n                        )}\n                    </div>\n                )}\n\n                {/* Loading */}\n                {loading ? (\n                    <div className=\"flex justify-center items-center h-40\">\n                        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500\" />\n                    </div>\n                ) : cards.length === 0 ? (\n                    /* Empty State */\n                    <div className=\"bg-white rounded-md shadow-sm border border-dashed border-gray-300 p-12 text-center\">\n                        <CreditCard size={48} className=\"mx-auto text-gray-300 mb-4\" />\n                        <h3 className=\"text-lg font-medium text-gray-800 mb-2\">Nenhum cart칚o salvo</h3>\n                        <p className=\"text-gray-500 text-sm mb-4\">Adicione um cart칚o para agilizar suas compras e assinaturas recorrentes.</p>\n                        <button\n                            onClick={() => setShowAddForm(true)}\n                            className=\"text-sm text-blue-600 font-semibold hover:underline\"\n                        >\n                            + Adicionar meu primeiro cart칚o\n                        </button>\n                    </div>\n                ) : (\n                    /* Lista de Cart칫es */\n                    <div className=\"space-y-3\">\n                        {cards.map(card => (\n                            <div key={card.id} className=\"bg-white rounded-md shadow-sm border border-gray-200 p-5 flex items-center justify-between hover:shadow-md transition\">\n                                <div className=\"flex items-center gap-4\">\n                                    {/* 칈cone / Brand */}\n                                    <div className=\"w-14 h-10 bg-gradient-to-br from-gray-100 to-gray-50 border border-gray-200 rounded-md flex items-center justify-center text-xs font-bold text-gray-600 uppercase\">\n                                        {card.payment_method?.id || 'CARD'}\n                                    </div>\n\n                                    <div>\n                                        <p className=\"text-sm font-semibold text-gray-800\">\n                                            {brandLogos[card.payment_method?.id || ''] || '游눱'} 뮉뮉뮉 뮉뮉뮉 뮉뮉뮉 {card.last_four_digits || '****'}\n                                        </p>\n                                        <p className=\"text-xs text-gray-500 mt-0.5\">\n                                            {card.cardholder?.name || 'Titular'} 췅 Vence {card.expiration_month}/{card.expiration_year}\n                                        </p>\n                                    </div>\n                                </div>\n\n                                <button\n                                    onClick={() => handleDelete(card.id)}\n                                    className=\"p-2 text-red-500 hover:bg-red-50 rounded-md transition\"\n                                    title=\"Remover cart칚o\"\n                                >\n                                    <Trash2 size={18} />\n                                </button>\n                            </div>\n                        ))}\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default SavedCardsPage;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/SearchPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/ShippingPolicyPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/ShopPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/SubscriptionCheckoutPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":67,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3038,3041],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3038,3041],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'user'. Either include it or remove the dependency array.","line":85,"column":8,"nodeType":"ArrayExpression","endLine":85,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [id, navigate, user]","fix":{"range":[3675,3689],"text":"[id, navigate, user]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate, Link } from 'react-router-dom';\nimport { ChevronLeft, Package, Clock, ShieldCheck, CheckCircle, Search, Plus, Trash2, Loader2, MapPin } from 'lucide-react';\nimport SEO from '../components/SEO';\nimport subscriptionService from '../services/subscriptionService';\nimport { productService } from '../services/productService';\nimport addressService from '../services/addressService';\nimport { SubscriptionPlan, Address, Product, User } from '../types';\n\ninterface SelectionProduct {\n    id: string;\n    name: string;\n    price: number;\n    quantity: number;\n}\n\nconst SubscriptionCheckoutPage: React.FC = () => {\n    const { id } = useParams<{ id: string }>();\n    const navigate = useNavigate();\n    const userStr = localStorage.getItem('user');\n    const user: User | null = userStr ? JSON.parse(userStr) : null;\n\n    const [plan, setPlan] = useState<SubscriptionPlan | null>(null);\n    const [loading, setLoading] = useState<boolean>(true);\n    const [submitting, setSubmitting] = useState<boolean>(false);\n    const [success, setSuccess] = useState<boolean>(false);\n\n    // Form State\n    const [selectedFrequency, setSelectedFrequency] = useState<string>('');\n    const [selectedProducts, setSelectedProducts] = useState<SelectionProduct[]>([]);\n    const [selectedAddress, setSelectedAddress] = useState<Address | null>(null);\n    const [userAddresses, setUserAddresses] = useState<Address[]>([]);\n\n    // Product Search State (for CUSTOM kit)\n    const [searchTerm, setSearchTerm] = useState<string>('');\n    const [searchResults, setSearchResults] = useState<Product[]>([]);\n    const [searching, setSearching] = useState<boolean>(false);\n\n    useEffect(() => {\n        if (!user) {\n            window.dispatchEvent(new CustomEvent('show-alert', { detail: 'Fa칞a login para assinar um plano.' }));\n            navigate('/assinaturas');\n            return;\n        }\n\n        const loadData = async () => {\n            if (!id) return;\n            try {\n                const planData = await subscriptionService.getPlan(id);\n                setPlan(planData);\n\n                const params = new URLSearchParams(window.location.search);\n                const freqParam = params.get('frequency');\n\n                // Set frequency: query param > first available\n                if (freqParam && planData.frequencyRules?.some(r => r.frequency === freqParam)) {\n                    setSelectedFrequency(freqParam);\n                } else if (planData.frequencyRules?.[0]) {\n                    setSelectedFrequency(planData.frequencyRules[0].frequency);\n                }\n\n                // If FIXED plan, pre-fill products\n                if (planData.type === 'FIXED' && planData.products) {\n                    setSelectedProducts(planData.products.map(pp => ({\n                        id: pp.product.id || '', // Assumindo que id existe no objeto retornado\n                        name: pp.product.name,\n                        price: (pp.product as any).price || 0, // Fallback caso price falte na sub-interface\n                        quantity: pp.quantity\n                    })));\n                }\n\n                // Load addresses\n                const addresses = await addressService.list(user.id);\n                setUserAddresses(addresses);\n                const def = addresses.find(a => a.isDefault) || addresses[0];\n                if (def) setSelectedAddress(def);\n\n            } catch (err) {\n                console.error(\"Erro ao carregar checkout:\", err);\n            } finally {\n                setLoading(false);\n            }\n        };\n        loadData();\n    }, [id, navigate]);\n\n    useEffect(() => {\n        if (searchTerm.length > 2) {\n            setSearching(true);\n            const timer = setTimeout(async () => {\n                try {\n                    const results = await productService.getProducts({ search: searchTerm });\n                    setSearchResults(results.slice(0, 5));\n                } finally {\n                    setSearching(false);\n                }\n            }, 500);\n            return () => clearTimeout(timer);\n        } else {\n            setSearchResults([]);\n        }\n    }, [searchTerm]);\n\n    const handleAddProduct = (product: Product) => {\n        if (!plan || (plan.maxProducts && selectedProducts.length >= plan.maxProducts)) {\n            window.dispatchEvent(new CustomEvent('show-alert', { detail: `Limite m치ximo de ${plan?.maxProducts} produtos atingido.` }));\n            return;\n        }\n        setSelectedProducts(prev => {\n            const existing = prev.find(p => p.id === product.id);\n            if (existing) {\n                return prev.map(p => p.id === product.id ? { ...p, quantity: p.quantity + 1 } : p);\n            }\n            return [...prev, { id: product.id, name: product.name, price: product.price, quantity: 1 }];\n        });\n        setSearchTerm('');\n    };\n\n    const handleRemoveProduct = (productId: string) => {\n        setSelectedProducts(prev => prev.filter(p => p.id !== productId));\n    };\n\n    const calculateTotal = () => {\n        if (!plan) return 0;\n        const productsTotal = selectedProducts.reduce((acc, p) => acc + (p.price * p.quantity), 0);\n        return (plan.basePrice || 0) + productsTotal;\n    };\n\n    const handleSubmit = async () => {\n        if (!plan || !user) return;\n\n        if (plan.type === 'CUSTOM' && plan.minProducts && selectedProducts.length < plan.minProducts) {\n            window.dispatchEvent(new CustomEvent('show-alert', { detail: `Selecione pelo menos ${plan.minProducts} produtos.` }));\n            return;\n        }\n        if (!selectedAddress) {\n            window.dispatchEvent(new CustomEvent('show-alert', { detail: 'Selecione um endere칞o de entrega.' }));\n            return;\n        }\n\n        setSubmitting(true);\n        try {\n            await subscriptionService.subscribe(user.id, {\n                planId: plan.id,\n                frequency: selectedFrequency,\n                shippingAddressId: selectedAddress.id,\n                items: selectedProducts.map(p => ({ productId: p.id, quantity: p.quantity }))\n            });\n            setSuccess(true);\n        } catch (err) {\n            console.error(\"Erro ao assinar:\", err);\n            window.dispatchEvent(new CustomEvent('show-alert', { detail: 'Erro ao processar assinatura. Tente novamente.' }));\n        } finally {\n            setSubmitting(false);\n        }\n    };\n\n    if (loading) return (\n        <div className=\"min-h-screen flex items-center justify-center\">\n            <Loader2 className=\"animate-spin text-[var(--azul-profundo)]\" size={40} />\n        </div>\n    );\n\n    if (success && plan) return (\n        <div className=\"min-h-screen bg-[var(--branco-off-white)] flex flex-col items-center justify-center p-4 text-center\">\n            <SEO title=\"Assinatura Confirmada\" />\n            <div className=\"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center text-green-600 mb-8\">\n                <CheckCircle size={40} />\n            </div>\n            <h1 className=\"font-playfair text-4xl text-[var(--azul-profundo)] mb-4\">Assinatura Ativada!</h1>\n            <p className=\"font-lato text-base text-[var(--azul-profundo)]/60 mb-8 max-w-md\">\n                Parab칠ns! Sua assinatura do plano <strong>{plan.name}</strong> foi confirmada.\n                Voc칡 receber치 seus produtos em casa a cada {selectedFrequency === 'WEEKLY' ? 'semana' : selectedFrequency === 'BIWEEKLY' ? '15 dias' : 'm칡s'}.\n            </p>\n            <Link to=\"/perfil/assinaturas\" className=\"bg-[var(--azul-profundo)] text-white px-10 py-4 font-lato text-xs uppercase tracking-widest hover:bg-[#0a1e33] transition-all\">\n                Gerenciar minhas assinaturas\n            </Link>\n        </div>\n    );\n\n    if (!plan) return null;\n\n    return (\n        <div className=\"bg-[var(--branco-off-white)] min-h-screen pb-24\">\n            <SEO title={`Assinar ${plan.name}`} />\n            <div className=\"max-w-7xl mx-auto px-4 pt-12\">\n                <Link to=\"/assinaturas\" className=\"inline-flex items-center gap-2 text-[var(--azul-profundo)]/40 hover:text-[var(--azul-profundo)] mb-12\">\n                    <ChevronLeft size={16} />\n                    <span className=\"font-lato text-[10px] uppercase tracking-widest\">Voltar para planos</span>\n                </Link>\n\n                <div className=\"flex flex-col lg:flex-row gap-12\">\n                    {/* Configura칞칚o */}\n                    <div className=\"flex-[1.5] space-y-12\">\n                        <section>\n                            <h1 className=\"font-playfair text-3xl text-[var(--azul-profundo)] mb-2\">Finalizar Assinatura</h1>\n                            <p className=\"text-gray-500\">Configura칞칚o do seu plano {plan.name}</p>\n                        </section>\n\n                        {/* 1. Produtos */}\n                        <section className=\"bg-white p-8 border border-gray-100 rounded-xl shadow-sm\">\n                            <h2 className=\"font-playfair text-xl text-[var(--azul-profundo)] mb-6 flex items-center gap-3\">\n                                <Package className=\"text-[var(--dourado-suave)]\" />\n                                {plan.type === 'FIXED' ? 'Produtos Inclusos' : 'Monte seu Kit'}\n                            </h2>\n\n                            {plan.type === 'CUSTOM' && (\n                                <div className=\"mb-6\">\n                                    <div className=\"relative\">\n                                        <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400\" size={18} />\n                                        <input\n                                            type=\"text\"\n                                            placeholder=\"Busque produtos para seu kit...\"\n                                            value={searchTerm}\n                                            onChange={(e) => setSearchTerm(e.target.value)}\n                                            className=\"w-full pl-12 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-lg text-sm outline-none focus:border-[var(--dourado-suave)] transition\"\n                                        />\n                                        {searching && <Loader2 className=\"absolute right-4 top-1/2 -translate-y-1/2 animate-spin text-gray-400\" size={18} />}\n                                    </div>\n                                    {searchResults.length > 0 && (\n                                        <div className=\"mt-2 bg-white border border-gray-100 rounded-lg shadow-xl overflow-hidden animate-in fade-in slide-in-from-top-2\">\n                                            {searchResults.map(p => (\n                                                <button key={p.id} onClick={() => handleAddProduct(p)} className=\"w-full px-4 py-3 flex items-center justify-between hover:bg-gray-50 text-left border-b border-gray-50 last:border-0\">\n                                                    <span className=\"text-sm font-medium\">{p.name}</span>\n                                                    <Plus size={16} className=\"text-[var(--dourado-suave)]\" />\n                                                </button>\n                                            ))}\n                                        </div>\n                                    )}\n                                    <p className=\"mt-2 text-[10px] uppercase tracking-wider text-gray-400\">\n                                        Selecione de {plan.minProducts} a {plan.maxProducts} itens\n                                    </p>\n                                </div>\n                            )}\n\n                            <div className=\"space-y-4\">\n                                {selectedProducts.map(p => (\n                                    <div key={p.id} className=\"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-100 transition hover:border-[var(--dourado-suave)]/30\">\n                                        <div className=\"flex items-center gap-4\">\n                                            <div className=\"w-10 h-10 bg-white border border-gray-100 rounded flex items-center justify-center\"><Package size={20} className=\"text-gray-300\" /></div>\n                                            <div>\n                                                <p className=\"text-sm font-bold text-[var(--azul-profundo)]\">{p.name}</p>\n                                                <p className=\"text-xs text-gray-500\">{p.quantity} un.  {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(p.price)}</p>\n                                            </div>\n                                        </div>\n                                        {plan.type === 'CUSTOM' && (\n                                            <button onClick={() => handleRemoveProduct(p.id)} className=\"text-gray-300 hover:text-red-500 p-2\"><Trash2 size={18} /></button>\n                                        )}\n                                    </div>\n                                ))}\n                                {selectedProducts.length === 0 && (\n                                    <div className=\"text-center py-8 text-gray-400 border-2 border-dashed border-gray-100 rounded-xl\">Nenhum produto selecionado</div>\n                                )}\n                            </div>\n                        </section>\n\n                        {/* 2. Frequ칡ncia */}\n                        <section className=\"bg-white p-8 border border-gray-100 rounded-xl shadow-sm\">\n                            <h2 className=\"font-playfair text-xl text-[var(--azul-profundo)] mb-6 flex items-center gap-3\">\n                                <Clock className=\"text-[var(--dourado-suave)]\" /> Frequ칡ncia de Entrega\n                            </h2>\n                            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                                {plan.frequencyRules?.map(rule => (\n                                    <button\n                                        key={rule.frequency}\n                                        onClick={() => setSelectedFrequency(rule.frequency)}\n                                        className={`p-4 rounded-xl border-2 transition-all text-left group ${selectedFrequency === rule.frequency ? 'border-[var(--dourado-suave)] bg-[var(--dourado-suave)]/5' : 'border-gray-50 hover:border-gray-200'}`}\n                                    >\n                                        <p className={`text-sm font-bold ${selectedFrequency === rule.frequency ? 'text-[var(--azul-profundo)]' : 'text-gray-400'}`}>\n                                            {rule.frequency === 'WEEKLY' ? 'Semanal' : rule.frequency === 'BIWEEKLY' ? 'Quinzenal' : 'Mensal'}\n                                        </p>\n                                        {rule.discountPercentage > 0 && (\n                                            <p className=\"text-xs text-green-600 mt-1\">-{rule.discountPercentage}% de desconto</p>\n                                        )}\n                                    </button>\n                                ))}\n                            </div>\n                        </section>\n\n                        {/* 3. Endere칞o */}\n                        <section className=\"bg-white p-8 border border-gray-100 rounded-xl shadow-sm\">\n                            <h2 className=\"font-playfair text-xl text-[var(--azul-profundo)] mb-6 flex items-center gap-3\">\n                                <MapPin className=\"text-[var(--dourado-suave)]\" /> Endere칞o de Entrega\n                            </h2>\n                            <div className=\"space-y-4\">\n                                {userAddresses.map(addr => (\n                                    <button\n                                        key={addr.id}\n                                        onClick={() => setSelectedAddress(addr)}\n                                        className={`w-full p-4 rounded-xl border-2 transition-all text-left flex items-center justify-between ${selectedAddress?.id === addr.id ? 'border-[var(--dourado-suave)] bg-[var(--dourado-suave)]/5' : 'border-gray-50 hover:border-gray-200'}`}\n                                    >\n                                        <div>\n                                            <p className=\"text-sm font-bold text-[var(--azul-profundo)]\">{addr.label || 'Endere칞o'} {addr.isDefault && <span className=\"text-[9px] bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded font-bold uppercase ml-2\">Padr칚o</span>}</p>\n                                            <p className=\"text-xs text-gray-500 mt-0.5\">{addr.street}, {addr.number} - {addr.city}</p>\n                                        </div>\n                                        {selectedAddress?.id === addr.id && <CheckCircle size={18} className=\"text-[var(--dourado-suave)]\" />}\n                                    </button>\n                                ))}\n                                <Link to=\"/perfil/enderecos\" className=\"inline-block text-xs text-[var(--dourado-suave)] font-bold uppercase tracking-wider hover:opacity-80 transition\">+ Gerenciar Endere칞os</Link>\n                            </div>\n                        </section>\n                    </div>\n\n                    {/* Resumo */}\n                    <div className=\"flex-1 lg:sticky lg:top-32 h-fit\">\n                        <div className=\"bg-white p-8 border border-gray-100 rounded-xl shadow-lg space-y-8\">\n                            <h2 className=\"font-playfair text-2xl text-[var(--azul-profundo)]\">Resumo da Assinatura</h2>\n                            <div className=\"space-y-4 border-t border-gray-50 pt-6\">\n                                <div className=\"flex justify-between text-sm text-gray-600\">\n                                    <span>Base do Plano</span>\n                                    <span>{new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(plan.basePrice || 0)}</span>\n                                </div>\n                                <div className=\"flex justify-between text-sm text-gray-600\">\n                                    <span>Produtos ({selectedProducts.length})</span>\n                                    <span>{new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(selectedProducts.reduce((acc, p) => acc + (p.price * p.quantity), 0))}</span>\n                                </div>\n                                <div className=\"flex justify-between text-xl font-bold text-[var(--azul-profundo)] pt-4 border-t border-gray-50\">\n                                    <span>Total Recorrente</span>\n                                    <span>{new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(calculateTotal())}</span>\n                                </div>\n                                <p className=\"text-[10px] text-gray-400 leading-relaxed text-center italic\">Este valor ser치 cobrado automaticamente a cada {selectedFrequency === 'WEEKLY' ? 'semana' : selectedFrequency === 'BIWEEKLY' ? '15 dias' : 'm칡s'}.</p>\n                            </div>\n\n                            <div className=\"pt-4 space-y-4\">\n                                <div className=\"bg-gray-50 p-4 rounded-lg flex items-start gap-3\">\n                                    <ShieldCheck className=\"text-green-600 shrink-0\" size={20} />\n                                    <p className=\"text-[10px] text-gray-500 leading-relaxed\">\n                                        Pagamento processado via Mercado Pago. O valor ser치 debitado no cart칚o cadastrado em sua conta. Voc칡 pode cancelar ou pausar a qualquer momento.\n                                    </p>\n                                </div>\n                                <button\n                                    onClick={handleSubmit}\n                                    disabled={submitting}\n                                    className=\"w-full bg-[var(--azul-profundo)] text-white py-5 rounded-xl font-bold uppercase tracking-widest hover:bg-[#0a1e33] transition-all flex items-center justify-center gap-3 shadow-xl shadow-blue-900/10 disabled:opacity-50\"\n                                >\n                                    {submitting ? <Loader2 className=\"animate-spin\" size={20} /> : 'Confirmar Assinatura'}\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default SubscriptionCheckoutPage;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/SubscriptionDetailPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/SubscriptionsPage.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchSubscriptions` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/SubscriptionsPage.tsx:21:13\n  19 |         const userId = user?.id || user?.googleId;\n  20 |         if (userId) {\n> 21 |             fetchSubscriptions(userId);\n     |             ^^^^^^^^^^^^^^^^^^ `fetchSubscriptions` accessed before it is declared\n  22 |         } else {\n  23 |             setLoading(false);\n  24 |         }\n\n/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/SubscriptionsPage.tsx:27:5\n  25 |     }, [user]);\n  26 |\n> 27 |     const fetchSubscriptions = (userId: string) => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 28 |         setLoading(true);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 29 |         subscriptionService.getUserSubscriptions(userId)\n     뵢n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 37 |             });\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 38 |     };\n     | ^^^^^^^ `fetchSubscriptions` is declared here\n  39 |\n  40 |     const handleToggleStatus = (sub: UserSubscription) => {\n  41 |         const userId = user?.id || user?.googleId;","line":21,"column":13,"nodeType":null,"endLine":21,"endColumn":31}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { PackageOpen, Clock, Settings, Search, PackageCheck } from 'lucide-react';\nimport SEO from '../components/SEO';\nimport { useOutletContext, Link } from 'react-router-dom';\nimport subscriptionService from '../services/subscriptionService';\nimport { UserSubscription, User } from '../types';\n\ninterface UserContext {\n    user: User | null;\n}\n\nconst SubscriptionsPage: React.FC = () => {\n    const { user } = useOutletContext<UserContext>();\n    const [subscriptions, setSubscriptions] = useState<UserSubscription[]>([]);\n    const [loading, setLoading] = useState<boolean>(true);\n    const [searchTerm, setSearchTerm] = useState<string>('');\n\n    useEffect(() => {\n        const userId = user?.id || user?.googleId;\n        if (userId) {\n            fetchSubscriptions(userId);\n        } else {\n            setLoading(false);\n        }\n    }, [user]);\n\n    const fetchSubscriptions = (userId: string) => {\n        setLoading(true);\n        subscriptionService.getUserSubscriptions(userId)\n            .then(data => {\n                setSubscriptions(data);\n                setLoading(false);\n            })\n            .catch(err => {\n                console.error(\"Error fetching subscriptions:\", err);\n                setLoading(false);\n            });\n    };\n\n    const handleToggleStatus = (sub: UserSubscription) => {\n        const userId = user?.id || user?.googleId;\n        if (!userId) return;\n\n        const action = sub.status === 'ACTIVE'\n            ? subscriptionService.pauseSubscription(sub.id)\n            : subscriptionService.resumeSubscription(sub.id);\n\n        action\n            .then(() => fetchSubscriptions(userId))\n            .catch(err => console.error(\"Error updating status:\", err));\n    };\n\n    if (!user) return null;\n\n    const filteredSubscriptions = subscriptions.filter(sub =>\n        (sub.plan?.name || '').toLowerCase().includes(searchTerm.toLowerCase())\n    );\n\n    const activeCount = filteredSubscriptions.filter(sub => sub.status === 'ACTIVE').length;\n\n    const getStatusText = (status: string) => {\n        switch (status) {\n            case 'ACTIVE': return 'Ativa';\n            case 'PAUSED': return 'Pausada';\n            case 'CANCELLED': return 'Cancelada';\n            default: return status;\n        }\n    };\n\n    if (loading) return (\n        <div className=\"flex justify-center items-center h-64\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500\"></div>\n        </div>\n    );\n\n    return (\n        <div className=\"w-full pb-12 font-lato\">\n            <SEO title=\"Minhas Assinaturas\" description=\"Gerencie suas entregas recorrentes.\" />\n\n            <div className=\"max-w-5xl mx-auto px-4 pt-8\">\n                {/* Header */}\n                <div className=\"mb-6 flex flex-col md:flex-row md:items-center justify-between gap-4\">\n                    <div>\n                        <h1 className=\"text-2xl font-bold text-[var(--azul-profundo)]\">Assinaturas</h1>\n                        <p className=\"text-gray-500 text-sm mt-1\">Gerencie seu plano e produtos recorrentes.</p>\n                    </div>\n                    <Link to=\"/assinaturas\" className=\"bg-[var(--dourado-suave)] text-white px-5 py-2.5 rounded text-sm font-semibold hover:opacity-90 transition-opacity\">\n                        Explorar Mais Planos\n                    </Link>\n                </div>\n\n                {/* Filtros */}\n                <div className=\"flex flex-col md:flex-row items-start md:items-center justify-between gap-4 mb-6\">\n                    <div className=\"relative w-full md:w-1/2 lg:w-1/3\">\n                        <input\n                            type=\"text\"\n                            placeholder=\"Busque pelo nome do plano...\"\n                            value={searchTerm}\n                            onChange={(e) => setSearchTerm(e.target.value)}\n                            className=\"w-full pl-10 pr-4 py-2 bg-white border border-gray-300 rounded-full text-sm focus:outline-none focus:border-[var(--azul-profundo)] shadow-sm\"\n                        />\n                        <Search className=\"absolute left-3 top-2.5 text-gray-400\" size={18} />\n                    </div>\n                    <div className=\"flex items-center gap-6 text-sm text-gray-600\">\n                        <span className=\"text-gray-400 font-medium\">{activeCount} assinaturas ativas</span>\n                    </div>\n                </div>\n\n                {/* Banner Educativo */}\n                <div className=\"bg-white rounded-md p-4 mb-6 shadow-sm border border-gray-200 flex items-center gap-4\">\n                    <div className=\"w-12 h-12 flex items-center justify-center bg-blue-50 text-[var(--azul-profundo)] rounded-full shrink-0\">\n                        <PackageCheck size={24} />\n                    </div>\n                    <div>\n                        <p className=\"text-sm text-gray-800 font-semibold mb-1\">Assinatura Ateli칡 - Sistema de Planos</p>\n                        <p className=\"text-xs text-gray-500\">Voc칡 est치 no novo sistema de assinaturas. Gerencie seus kits e frequ칡ncias abaixo.</p>\n                    </div>\n                </div>\n\n                {/* Lista de Assinaturas */}\n                <div className=\"space-y-4\">\n                    {filteredSubscriptions.map(sub => (\n                        <div key={sub.id} className=\"bg-white rounded-md shadow-sm border border-gray-200 overflow-hidden flex flex-col md:flex-row p-6 gap-6 relative\">\n\n                            {/* Badges */}\n                            <div className=\"absolute top-4 right-4 flex gap-2\">\n                                <span className={`px-2 py-1 text-[10px] uppercase font-bold tracking-wider rounded ${sub.status === 'ACTIVE' ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-600'\n                                    }`}>\n                                    {getStatusText(sub.status)}\n                                </span>\n                            </div>\n\n                            {/* Detalhes do Plano */}\n                            <div className=\"flex-1\">\n                                <h3 className=\"text-[var(--azul-profundo)] font-bold text-lg mb-1 pr-16\">{sub.plan?.name}</h3>\n                                <div className=\"text-sm font-bold text-gray-900 mb-4\">\n                                    {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(sub.totalPrice)}\n                                    <span className=\"text-gray-400 font-normal text-xs ml-1\">/ recorr칡ncia</span>\n                                </div>\n\n                                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm text-gray-600\">\n                                    <div className=\"flex items-center gap-2\">\n                                        <Clock size={16} className=\"text-gray-400\" />\n                                        <span>Frequ칡ncia: <strong className=\"text-gray-800\">{sub.frequency}</strong></span>\n                                    </div>\n                                    <div className=\"flex items-center gap-2\">\n                                        <PackageOpen size={16} className={sub.status === 'ACTIVE' ? 'text-[var(--azul-profundo)]' : 'text-gray-400'} />\n                                        <span>Pr칩xima cobran칞a: <strong className={sub.status === 'ACTIVE' ? 'text-[var(--azul-profundo)]' : 'text-gray-800'}>{new Date(sub.nextBillingAt).toLocaleDateString('pt-BR')}</strong></span>\n                                    </div>\n                                </div>\n\n                                {/* Itens do Kit (se houver) */}\n                                {sub.items && sub.items.length > 0 && (\n                                    <div className=\"mt-4 pt-4 border-t border-gray-50\">\n                                        <p className=\"text-[10px] uppercase font-bold text-gray-400 mb-2\">Produtos no Kit:</p>\n                                        <div className=\"flex flex-wrap gap-2\">\n                                            {sub.items.map(item => (\n                                                <span key={item.id} className=\"inline-flex items-center px-2 py-1 bg-gray-50 border border-gray-100 rounded text-xs text-gray-600\">\n                                                    {item.quantity}x {item.product?.name}\n                                                </span>\n                                            ))}\n                                        </div>\n                                    </div>\n                                )}\n                            </div>\n\n                            {/* A칞칫es */}\n                            <div className=\"w-full md:w-48 flex flex-col justify-center gap-2 shrink-0 md:border-l border-gray-100 md:pl-6\">\n                                <Link\n                                    to={`/assinaturas/gerenciar/${sub.id}`}\n                                    className=\"w-full py-2 bg-blue-50 text-[var(--azul-profundo)] text-sm font-semibold rounded hover:bg-blue-100 transition-colors flex items-center justify-center gap-2\"\n                                >\n                                    <Settings size={16} /> Configurar\n                                </Link>\n                                {sub.status === 'ACTIVE' ? (\n                                    <button\n                                        onClick={() => handleToggleStatus(sub)}\n                                        className=\"w-full py-2 bg-white text-gray-500 border border-gray-200 text-sm font-semibold rounded hover:bg-gray-50 transition-colors\"\n                                    >\n                                        Pausar\n                                    </button>\n                                ) : (\n                                    <button\n                                        onClick={() => handleToggleStatus(sub)}\n                                        className=\"w-full py-2 bg-[var(--azul-profundo)] text-white text-sm font-semibold rounded hover:opacity-90 transition-opacity\"\n                                    >\n                                        Reativar\n                                    </button>\n                                )}\n                            </div>\n                        </div>\n                    ))}\n                    {filteredSubscriptions.length === 0 && (\n                        <div className=\"text-center py-20 bg-white rounded-md border border-dashed border-gray-300\">\n                            <PackageOpen size={48} className=\"mx-auto text-gray-300 mb-4\" />\n                            <p className=\"text-gray-500\">Nenhuma assinatura encontrada no novo sistema.</p>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default SubscriptionsPage;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/TermsOfUsePage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/UnsubscribeNewsletter.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/UnsubscribeNewsletter.tsx:14:13\n  12 |         const token = searchParams.get('token');\n  13 |         if (!token) {\n> 14 |             setStatus('error');\n     |             ^^^^^^^^^ Avoid calling setState() directly within an effect\n  15 |             setMessage('Link de cancelamento inv치lido. Se o problema persistir, entre em contato com nosso suporte.');\n  16 |             return;\n  17 |         }","line":14,"column":13,"nodeType":null,"endLine":14,"endColumn":22},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1218,1221],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1218,1221],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState, useRef } from 'react';\nimport { useSearchParams, Link } from 'react-router-dom';\nimport axios from 'axios';\n\nconst UnsubscribeNewsletter: React.FC = () => {\n    const [searchParams] = useSearchParams();\n    const [status, setStatus] = useState<'loading' | 'success' | 'error'>('loading');\n    const [message, setMessage] = useState<string>('');\n    const hasAttempted = useRef<boolean>(false);\n\n    useEffect(() => {\n        const token = searchParams.get('token');\n        if (!token) {\n            setStatus('error');\n            setMessage('Link de cancelamento inv치lido. Se o problema persistir, entre em contato com nosso suporte.');\n            return;\n        }\n\n        const unsubscribeToken = async () => {\n            if (hasAttempted.current) return;\n            hasAttempted.current = true;\n\n            try {\n                const response = await axios.post(`${import.meta.env.VITE_API_URL || 'http://localhost:8080'}/api/newsletter/unsubscribe`, { token });\n                setStatus('success');\n                setMessage(response.data.message || 'Inscri칞칚o cancelada com sucesso. Voc칡 n칚o receber치 mais e-mails da nossa Newsletter.');\n            } catch (error: any) {\n                setStatus('error');\n                if (error.response?.data?.message) {\n                    setMessage(error.response.data.message);\n                } else {\n                    setMessage('Ocorreu um erro ao cancelar sua inscri칞칚o. Lamentamos pelo inconveniente.');\n                }\n            }\n        };\n\n        unsubscribeToken();\n    }, [searchParams]);\n\n    return (\n        <div className=\"flex flex-col items-center justify-center py-32 px-4 text-center\">\n            {status === 'loading' && (\n                <div className=\"animate-pulse flex flex-col items-center\">\n                    <div className=\"w-12 h-12 border-4 border-gray-300 border-t-gray-600 rounded-full animate-spin mb-6\"></div>\n                    <h2 className=\"text-2xl font-playfair mb-2\">Processando solicita칞칚o...</h2>\n                </div>\n            )}\n\n            {status === 'success' && (\n                <div className=\"flex flex-col items-center max-w-lg\">\n                    <div className=\"w-16 h-16 bg-gray-100 text-gray-500 flex items-center justify-center rounded-full mb-6\">\n                        <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"></path></svg>\n                    </div>\n                    <h2 className=\"text-3xl font-playfair mb-4 text-[#0f2A44]\">Poxa, que pena que nos deixou!</h2>\n                    <p className=\"font-lato text-gray-600 mb-8\">{message}</p>\n                    <Link to=\"/\" className=\"bg-[#0f2A44] text-white px-8 py-3 tracking-widest text-xs uppercase hover:bg-[#1a4066] transition\">\n                        Voltar para a Loja\n                    </Link>\n                </div>\n            )}\n\n            {status === 'error' && (\n                <div className=\"flex flex-col items-center max-w-lg\">\n                    <div className=\"w-16 h-16 bg-[#fce8e6] text-[#d93025] flex items-center justify-center rounded-full mb-6\">\n                        <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"></path></svg>\n                    </div>\n                    <h2 className=\"text-3xl font-playfair mb-4 text-[#0f2A44]\">Ocorreu um Erro</h2>\n                    <p className=\"font-lato text-gray-600 mb-8\">{message}</p>\n                    <Link to=\"/\" className=\"bg-transparent border border-[#0f2A44] text-[#0f2A44] px-8 py-3 tracking-widest text-xs uppercase hover:bg-gray-50 transition\">\n                        Voltar para a Loja\n                    </Link>\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default UnsubscribeNewsletter;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/UserLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/VerifyNewsletter.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/pages/VerifyNewsletter.tsx:16:13\n  14 |         const token = searchParams.get('token');\n  15 |         if (!token) {\n> 16 |             setStatus('error');\n     |             ^^^^^^^^^ Avoid calling setState() directly within an effect\n  17 |             setMessage('Link de verifica칞칚o inv치lido ou expirado.');\n  18 |             return;\n  19 |         }","line":16,"column":13,"nodeType":null,"endLine":16,"endColumn":22},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1252,1255],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1252,1255],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState, useRef } from 'react';\nimport { useSearchParams, Link } from 'react-router-dom';\nimport axios from 'axios';\n\ntype VerificationStatus = 'loading' | 'success' | 'error';\n\nconst VerifyNewsletter: React.FC = () => {\n    const [searchParams] = useSearchParams();\n    const [status, setStatus] = useState<VerificationStatus>('loading');\n    const [message, setMessage] = useState<string>('');\n    const hasAttempted = useRef<boolean>(false);\n\n    useEffect(() => {\n        const token = searchParams.get('token');\n        if (!token) {\n            setStatus('error');\n            setMessage('Link de verifica칞칚o inv치lido ou expirado.');\n            return;\n        }\n\n        const verifyToken = async () => {\n            if (hasAttempted.current) return;\n            hasAttempted.current = true;\n\n            try {\n                const response = await axios.post<{ message: string }>(\n                    `${import.meta.env.VITE_API_URL || 'http://localhost:8080'}/api/newsletter/verify`,\n                    { token }\n                );\n                setStatus('success');\n                setMessage(response.data.message || 'Inscri칞칚o confirmada com sucesso! Bem-vindo(a) ao Ateli칡.');\n            } catch (error: any) {\n                setStatus('error');\n                if (error.response?.data?.message) {\n                    setMessage(error.response.data.message);\n                } else {\n                    setMessage('Ocorreu um erro ao validar sua inscri칞칚o. Tente novamente mais tarde.');\n                }\n            }\n        };\n\n        verifyToken();\n    }, [searchParams]);\n\n    return (\n        <div className=\"flex flex-col items-center justify-center py-32 px-4 text-center\">\n            {status === 'loading' && (\n                <div className=\"animate-pulse flex flex-col items-center\">\n                    <div className=\"w-12 h-12 border-4 border-[#C9A24D] border-t-transparent rounded-full animate-spin mb-6\"></div>\n                    <h2 className=\"text-2xl font-playfair mb-2\">Verificando sua inscri칞칚o...</h2>\n                    <p className=\"text-gray-500 font-lato\">Aguarde um momento.</p>\n                </div>\n            )}\n\n            {status === 'success' && (\n                <div className=\"flex flex-col items-center max-w-lg\">\n                    <div className=\"w-16 h-16 bg-[#e6f4ea] text-[#1e8e3e] flex items-center justify-center rounded-full mb-6\">\n                        <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M5 13l4 4L19 7\"></path>\n                        </svg>\n                    </div>\n                    <h2 className=\"text-3xl font-playfair mb-4 text-[#0f2A44]\">Inscri칞칚o Confirmada!</h2>\n                    <p className=\"font-lato text-gray-600 mb-8\">{message}</p>\n                    <Link to=\"/\" className=\"bg-[#0f2A44] text-white px-8 py-3 tracking-widest text-xs uppercase hover:bg-[#1a4066] transition\">\n                        Explorar a Loja\n                    </Link>\n                </div>\n            )}\n\n            {status === 'error' && (\n                <div className=\"flex flex-col items-center max-w-lg\">\n                    <div className=\"w-16 h-16 bg-[#fce8e6] text-[#d93025] flex items-center justify-center rounded-full mb-6\">\n                        <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M6 18L18 6M6 6l12 12\"></path>\n                        </svg>\n                    </div>\n                    <h2 className=\"text-3xl font-playfair mb-4 text-[#0f2A44]\">Ops!</h2>\n                    <p className=\"font-lato text-gray-600 mb-8\">{message}</p>\n                    <Link to=\"/\" className=\"bg-transparent border border-[#0f2A44] text-[#0f2A44] px-8 py-3 tracking-widest text-xs uppercase hover:bg-gray-50 transition\">\n                        Voltar para o In칤cio\n                    </Link>\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default VerifyNewsletter;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/services/addressService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/services/api.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":22,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[705,708],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[705,708],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import axios, { AxiosInstance, InternalAxiosRequestConfig, AxiosResponse } from 'axios';\n\nconst api: AxiosInstance = axios.create({\n    baseURL: import.meta.env.VITE_API_URL || 'http://localhost:8080/api',\n    headers: {\n        'Content-Type': 'application/json',\n    },\n});\n\n// Adiciona o Token JWT automaticamente se ele existir\napi.interceptors.request.use((config: InternalAxiosRequestConfig) => {\n    const token = localStorage.getItem('auth_token');\n    if (token && config.headers) {\n        config.headers.Authorization = `Bearer ${token}`;\n    }\n    return config;\n});\n\n// Trata erros de resposta globalmente\napi.interceptors.response.use(\n    (response: AxiosResponse) => response,\n    (error: any) => {\n        // Se o erro for 401 (Unauthorized) e n칚o for uma tentativa de login\n        if (error.response?.status === 401 && error.config?.url && !error.config.url.includes('/auth/login')) {\n            console.warn(\"[API] Sess칚o expirada ou inv치lida. Limpando dados locais...\");\n            localStorage.removeItem('auth_token');\n            localStorage.removeItem('user');\n            window.dispatchEvent(new Event('auth-changed'));\n        }\n        return Promise.reject(error);\n    }\n);\n\nexport default api;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/services/authService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[343,346],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[343,346],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[357,360],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[357,360],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[531,534],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[531,534],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1556,1559],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1556,1559],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":93,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":93,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3162,3165],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3162,3165],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":98,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":98,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3357,3360],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3357,3360],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":107,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":107,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":153,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5205,5208],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5205,5208],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":178,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":178,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6047,6050],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6047,6050],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":184,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":184,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6307,6310],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6307,6310],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\nimport { User, Address, LoginResponse } from '../types';\nimport { TENANT_HEADER } from './productService';\nimport { cartService } from './cartService';\n\n/**\n * Ateli칡 Filhos de Aruanda - Auth & User Service\n * Autentica칞칚o e gest칚o de dados do usu치rio.\n */\n\nexport const authService = {\n    register: async (userData: any): Promise<any> => {\n        const response = await api.post('/auth/register', userData);\n        return response.data;\n    },\n\n    verify: async (email: string, code: string): Promise<any> => {\n        const response = await api.post('/auth/verify', { email, code });\n        return response.data;\n    },\n\n    login: async (email: string, password: string): Promise<User> => {\n        try {\n            const response = await api.post('/auth/login', { email, password });\n            if (response.data?.token) {\n                authService.setSession(response.data);\n\n                // Migrar carrinho de convidado para o usu치rio logado\n                await cartService.migrate(response.data.id);\n\n                window.dispatchEvent(new Event('auth-changed'));\n                return response.data;\n            }\n            throw new Error(\"Resposta de login inv치lida\");\n        } catch (error) {\n            console.error(\"[authService] Erro no login:\", error);\n            throw error;\n        }\n    },\n\n    /**\n     * Login com Google  usa access_token do @react-oauth/google.\n     * O frontend j치 buscou o userInfo do Google e envia ao backend.\n     */\n    googleLoginWithUserInfo: async (userInfo: any, accessToken: string): Promise<User> => {\n        try {\n            const response = await api.post('/auth/google', {\n                email: userInfo.email,\n                name: userInfo.name,\n                picture: userInfo.picture,\n                googleId: userInfo.sub,\n                accessToken,\n            });\n\n            if (response.data.token) {\n                authService.setSession(response.data);\n\n                // Migrar carrinho\n                await cartService.migrate(response.data.id);\n\n                window.dispatchEvent(new Event('auth-changed'));\n                return response.data;\n            }\n            throw new Error(\"Resposta de login Google inv치lida\");\n        } catch (error) {\n            console.error('[authService] Erro no Google Login:', error);\n            throw error;\n        }\n    },\n\n    setSession: (data: LoginResponse): void => {\n        localStorage.setItem('auth_token', data.token);\n        const userObj: User = {\n            id: data.id,\n            name: data.name,\n            email: data.email,\n            role: data.role,\n            emailVerified: data.emailVerified,\n            photoUrl: data.photoUrl,\n            googleId: data.googleId,\n            document: data.document\n        };\n        localStorage.setItem('user', JSON.stringify(userObj));\n    },\n\n    logout: (): void => {\n        localStorage.removeItem('auth_token');\n        localStorage.removeItem('user');\n        window.dispatchEvent(new Event('auth-changed'));\n        window.location.href = '/';\n    },\n\n    requestPasswordReset: async (email: string): Promise<any> => {\n        const response = await api.post('/auth/password-reset', { email });\n        return response.data;\n    },\n\n    resetPassword: async (token: string, newPassword: string): Promise<any> => {\n        const response = await api.post('/auth/password-reset/reset', { token, newPassword });\n        return response.data;\n    },\n\n    getUser: (): User | null => {\n        try {\n            const userStr = localStorage.getItem('user');\n            return userStr ? JSON.parse(userStr) : null;\n        } catch (e) {\n            return null;\n        }\n    },\n\n    isAuthenticated: (): boolean => !!localStorage.getItem('auth_token'),\n\n    // --- ENDERE칂OS ---\n    address: {\n        get: async (userId: string): Promise<Address[]> => {\n            if (!userId) return [];\n            try {\n                const response = await api.get(`/addresses/user/${userId}`, {\n                    headers: TENANT_HEADER\n                });\n                return response.data || [];\n            } catch (e) {\n                console.error(\"[authService] Erro ao buscar endere칞os\", e);\n                return [];\n            }\n        },\n        create: async (userId: string, addressData: Address): Promise<Address> => {\n            try {\n                const response = await api.post(`/addresses/user/${userId}`, addressData, {\n                    headers: TENANT_HEADER\n                });\n                return response.data;\n            } catch (e) {\n                console.error(\"[authService] Erro ao salvar endere칞o\", e);\n                throw e;\n            }\n        },\n        delete: async (userId: string, addressId: string): Promise<void> => {\n            try {\n                await api.delete(`/addresses/${addressId}/user/${userId}`, {\n                    headers: TENANT_HEADER\n                });\n            } catch (e) {\n                console.error(\"[authService] Erro ao excluir endere칞o\", e);\n                throw e;\n            }\n        }\n    },\n\n    // --- CART칏ES ---\n    cards: {\n        get: async (): Promise<any[]> => {\n            try {\n                const response = await api.get('/customer/cards', {\n                    headers: TENANT_HEADER\n                });\n                return Array.isArray(response.data) ? response.data : [];\n            } catch (e) {\n                console.error(\"[authService] Erro ao buscar cart칫es salvos\", e);\n                return [];\n            }\n        },\n        delete: async (cardId: string): Promise<void> => {\n            try {\n                await api.delete(`/customer/cards/${cardId}`, {\n                    headers: TENANT_HEADER\n                });\n            } catch (e) {\n                console.error(\"[authService] Erro ao excluir cart칚o\", e);\n                throw e;\n            }\n        }\n    },\n\n    // --- FAVORITOS ---\n    favorites: {\n        get: async (userId: string): Promise<any[]> => {\n            if (!userId) return [];\n            try {\n                const response = await api.get(`/favorites/user/${userId}`, {\n                    headers: TENANT_HEADER\n                });\n                return (response.data || []).map((f: any) => f.product);\n            } catch (e) {\n                console.error(\"[authService] Erro ao buscar favoritos da API\", e);\n                return [];\n            }\n        },\n        toggle: async (userId: string, productId: string): Promise<boolean> => {\n            if (!userId || !productId) return false;\n            try {\n                const current = await authService.favorites.get(userId);\n                const isFav = current.some(p => p.id === productId);\n\n                if (isFav) {\n                    await api.delete('/favorites', {\n                        params: { userId, productId },\n                        headers: TENANT_HEADER\n                    });\n                } else {\n                    await api.post('/favorites', { userId, productId }, {\n                        headers: TENANT_HEADER\n                    });\n                }\n                return !isFav;\n            } catch (e) {\n                console.error(\"[authService] Erro ao alternar favorito na API\", e);\n                throw e;\n            }\n        }\n    },\n\n    updateProfile: async (userData: { name?: string; document?: string }): Promise<void> => {\n        try {\n            await api.patch('/users/profile', userData, {\n                headers: TENANT_HEADER\n            });\n\n            // Atualizar localStorage\n            const currentUser = authService.getUser();\n            if (currentUser) {\n                const updatedUser = { ...currentUser, ...userData };\n                localStorage.setItem('user', JSON.stringify(updatedUser));\n                window.dispatchEvent(new Event('auth-changed'));\n            }\n        } catch (e) {\n            console.error(\"[authService] Erro ao atualizar perfil\", e);\n            throw e;\n        }\n    }\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/services/cardService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":5,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[125,128],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[125,128],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[257,260],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[257,260],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\nimport { TENANT_HEADER } from './productService';\n\nconst cardService = {\n    listCards: (): Promise<any[]> =>\n        api.get('/customer/cards', { headers: TENANT_HEADER }).then(r => r.data),\n\n    saveCard: (token: string): Promise<any> =>\n        api.post('/customer/cards', { token }, { headers: TENANT_HEADER }).then(r => r.data),\n\n    deleteCard: (cardId: string): Promise<void> =>\n        api.delete(`/customer/cards/${cardId}`, { headers: TENANT_HEADER }).then(r => r.data),\n};\n\nexport default cardService;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/services/cartService.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/services/cartService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":14,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\nimport { User, CartItem, Product } from '../types';\nimport { TENANT_HEADER } from './productService';\n\n/**\n * Ateli칡 Filhos de Aruanda - Cart Service\n * Gerenciamento local e sincroniza칞칚o do carrinho.\n */\n\nconst getAuthUser = (): User | null => {\n    try {\n        const userStr = localStorage.getItem('user');\n        return userStr ? JSON.parse(userStr) : null;\n    } catch (e) {\n        return null;\n    }\n};\n\nexport const cartService = {\n    get: async (): Promise<CartItem[]> => {\n        const user = getAuthUser();\n        const cartKey = user ? `cart_user_${user.id}` : 'cart_guest';\n        const cartData = JSON.parse(localStorage.getItem(cartKey) || '[]');\n        let cart = Array.isArray(cartData) ? cartData : (cartData.items || []);\n\n        if (user) {\n            try {\n                const response = await api.get(`/cart/${user.id}`, {\n                    headers: TENANT_HEADER\n                });\n                const remoteCart = response.data;\n                if (remoteCart.items && remoteCart.items.length > 0) {\n                    cart = remoteCart.items;\n                    localStorage.setItem(cartKey, JSON.stringify(cart));\n                }\n            } catch (error) {\n                console.error('[cartService] Erro ao buscar carrinho remoto:', error);\n            }\n        }\n        return cart;\n    },\n\n    save: async (cart: CartItem[]): Promise<void> => {\n        const user = getAuthUser();\n        const cartKey = user ? `cart_user_${user.id}` : 'cart_guest';\n        localStorage.setItem(cartKey, JSON.stringify(cart));\n\n        if (user) {\n            try {\n                await api.post(`/cart/${user.id}/sync`, cart, {\n                    headers: TENANT_HEADER\n                });\n            } catch (error) {\n                console.error('[cartService] Erro ao sincronizar carrinho:', error);\n            }\n        }\n        window.dispatchEvent(new Event('cart-updated'));\n    },\n\n    add: async (product: Partial<Product> & { id: string; name?: string; title?: string; price: number }, quantity: number = 1, variantId: string | null = null): Promise<CartItem[]> => {\n        const cart = await cartService.get();\n        const vId = variantId || \"\";\n        const existingItem = cart.find(item =>\n            item.id === product.id && item.variantId === vId\n        );\n\n        if (existingItem) {\n            existingItem.quantity += quantity;\n        } else {\n            cart.push({\n                id: product.id,\n                name: product.name || product.title || '',\n                price: product.price,\n                image: product.image || (product.images && product.images[0]) || (product.media && product.media[0]?.url),\n                quantity: quantity,\n                variantId: vId\n            });\n        }\n\n        await cartService.save(cart);\n        return cart;\n    },\n\n    remove: async (productId: string, variantId: string | null = null): Promise<CartItem[]> => {\n        let cart = await cartService.get();\n        const vId = variantId || \"\";\n        cart = cart.filter(item =>\n            !(item.id === productId && item.variantId === vId)\n        );\n        await cartService.save(cart);\n        return cart;\n    },\n\n    updateQuantity: async (productId: string, quantity: number, variantId: string | null = null): Promise<CartItem[]> => {\n        const cart = await cartService.get();\n        const vId = variantId || \"\";\n        const item = cart.find(item =>\n            item.id === productId && item.variantId === vId\n        );\n\n        if (item) {\n            item.quantity = Math.max(1, quantity);\n            await cartService.save(cart);\n        }\n        return cart;\n    },\n\n    clear: async (): Promise<void> => {\n        const user = getAuthUser();\n        const cartKey = user ? `cart_user_${user.id}` : 'cart_guest';\n        localStorage.removeItem(cartKey);\n\n        if (user) {\n            try {\n                await api.delete(`/cart/${user.id}`, {\n                    headers: TENANT_HEADER\n                });\n            } catch (error) {\n                console.error('[cartService] Erro ao limpar carrinho remoto:', error);\n            }\n        }\n        window.dispatchEvent(new Event('cart-updated'));\n    },\n\n    migrate: async (_userId: string): Promise<void> => {\n        try {\n            const guestCartJson = localStorage.getItem('cart_guest');\n            const guestCart: CartItem[] = guestCartJson ? JSON.parse(guestCartJson) : [];\n            if (guestCart.length === 0) return;\n\n            const userCart = await cartService.get();\n\n            guestCart.forEach(guestItem => {\n                const existingItem = userCart.find(item =>\n                    item.id === guestItem.id && item.variantId === guestItem.variantId\n                );\n                if (existingItem) {\n                    existingItem.quantity += guestItem.quantity;\n                } else {\n                    userCart.push(guestItem);\n                }\n            });\n\n            await cartService.save(userCart);\n            localStorage.removeItem('cart_guest');\n        } catch (error) {\n            console.error(\"[cartService] Erro ao migrar carrinho\", error);\n        }\n    }\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/services/contactService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[242,245],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[242,245],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[256,259],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[256,259],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[429,432],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[429,432],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\nimport { TENANT_HEADER } from './productService';\n\nconst contactService = {\n    /**\n     * Envia formul치rio de contato para o backend.\n     * O backend enfileira um e-mail para o admin.\n     */\n    send: async (data: any): Promise<any> => {\n        try {\n            const response = await api.post('/contact', data, { headers: TENANT_HEADER });\n            return response.data;\n        } catch (error: any) {\n            throw error.response?.data || { message: 'Erro ao enviar mensagem' };\n        }\n    },\n};\n\nexport default contactService;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/services/firebaseConfig.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/services/marketingService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[181,184],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[181,184],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[365,368],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[365,368],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[838,841],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[838,841],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1290,1293],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1290,1293],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\nimport { Coupon } from '../types';\nimport { TENANT_HEADER } from './productService';\n\nconst marketingService = {\n    subscribeNewsletter: async (): Promise<any> => {\n        try {\n            const response = await api.post('/newsletter/subscribe', {}, { headers: TENANT_HEADER });\n            return response.data;\n        } catch (error: any) {\n            throw error.response?.data || { message: 'Erro ao assinar newsletter' };\n        }\n    },\n\n    validateCoupon: async (code: string, userId: string, cartTotal: number): Promise<Coupon> => {\n        try {\n            const response = await api.post('/marketing/coupons/validate', {\n                code,\n                userId,\n                cartTotal\n            }, { headers: TENANT_HEADER });\n            return response.data;\n        } catch (error: any) {\n            const msg = error.response?.data?.message || 'Cupom inv치lido';\n            throw new Error(msg);\n        }\n    },\n\n    getAvailableCoupons: async (userId?: string): Promise<Coupon[]> => {\n        try {\n            const response = await api.get('/coupons/my-coupons', {\n                params: userId ? { userId } : {},\n                headers: TENANT_HEADER\n            });\n            return response.data;\n        } catch (error: any) {\n            throw error.response?.data || { message: 'Erro ao buscar cupons' };\n        }\n    }\n};\n\nexport default marketingService;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/services/orderService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":66,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2561,2564],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2561,2564],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":95,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3557,3560],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3557,3560],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":125,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":125,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4601,4604],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4601,4604],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\nimport { CreateOrderData, ShippingOption, CartItem, Order, Product } from '../types';\nimport { TENANT_HEADER } from './productService';\n\n/**\n * Ateli칡 Filhos de Aruanda - Order & Shipping Service\n * Cria칞칚o de pedidos, hist칩rico e c치lculo de frete.\n */\n\nexport const orderService = {\n    createOrder: async (orderData: CreateOrderData): Promise<Order> => {\n        try {\n            const payload = {\n                customerName: orderData.customerName || `${orderData.nome || ''} ${orderData.sobrenome || ''}`.trim(),\n                customerEmail: orderData.customerEmail || orderData.email,\n                items: (orderData.items || []).map(i => ({\n                    productId: i.productId,\n                    variantId: i.variantId || null,\n                    quantity: i.quantity\n                })),\n                shippingAddress: orderData.shippingAddress,\n                paymentMethod: orderData.paymentMethod || 'pix',\n                paymentToken: orderData.paymentToken || null,\n                cardId: orderData.cardId || null,\n                saveCard: orderData.saveCard || false,\n                saveAddress: orderData.saveAddress || false,\n                couponCode: orderData.couponCode || null\n            };\n\n            const response = await api.post('/checkout/process', payload, {\n                headers: TENANT_HEADER\n            });\n            return response.data;\n        } catch (error) {\n            console.error(\"[orderService] Erro ao criar pedido:\", error);\n            throw error;\n        }\n    },\n\n    getOrderById: async (orderId: string): Promise<Order> => {\n        try {\n            const response = await api.get(`/orders/${orderId}`, {\n                headers: TENANT_HEADER\n            });\n            return response.data;\n        } catch (error) {\n            console.error(\"[orderService] Erro ao buscar pedido:\", error);\n            throw error;\n        }\n    },\n\n    calculateShipping: async (cep: string, items: CartItem[] = []): Promise<ShippingOption[]> => {\n        try {\n            const subtotal = items.reduce((acc, item) => acc + (item.price * item.quantity), 0);\n            const payload = {\n                cep,\n                subtotal,\n                items: items.map(i => ({ productId: i.id, quantity: i.quantity }))\n            };\n\n            const response = await api.post('/shipping/quote', payload, {\n                headers: TENANT_HEADER\n            });\n\n            if (response.data?.options) {\n                return response.data.options.map((opt: any) => ({\n                    provider: opt.name,\n                    price: opt.price,\n                    days: opt.delivery_time,\n                    originalPrice: opt.original_price,\n                    free: opt.free_shipping\n                }));\n            }\n\n            return [{\n                provider: response.data.provider,\n                price: response.data.cost,\n                days: response.data.estimatedDays || 5,\n                free: response.data.free_shipping\n            }];\n        } catch (error) {\n            console.error(\"[orderService] Erro ao calcular frete:\", error);\n            return [];\n        }\n    },\n\n    // --- HIST칍RICO ---\n    history: {\n        get: async (userId: string): Promise<Product[]> => {\n            if (!userId) return [];\n            try {\n                const response = await api.get(`/history/user/${userId}`, {\n                    headers: TENANT_HEADER\n                });\n                return (response.data || []).map((h: any) => h.product);\n            } catch (e) {\n                console.error(\"[orderService] Erro ao buscar hist칩rico da API\", e);\n                return [];\n            }\n        },\n        add: async (userId: string, productId: string): Promise<void> => {\n            if (!userId || !productId) return;\n            try {\n                await api.post('/history', { userId, productId }, {\n                    headers: TENANT_HEADER\n                });\n            } catch (e) {\n                console.error(\"[orderService] Erro ao salvar hist칩rico na API\", e);\n            }\n        },\n        clear: async (userId: string): Promise<void> => {\n            if (!userId) return;\n            try {\n                await api.delete(`/history/user/${userId}`, {\n                    headers: TENANT_HEADER\n                });\n            } catch (e) {\n                console.error(\"[orderService] Erro ao limpar hist칩rico na API\", e);\n            }\n        }\n    }\n};\n\nexport const configService = {\n    getMercadoPagoPublicKey: async (): Promise<any> => {\n        try {\n            const response = await api.get('/config/public/mercado-pago/public-key', {\n                headers: TENANT_HEADER\n            });\n            return response.data;\n        } catch (error) {\n            console.error(\"[configService] Erro ao buscar chave p칰blica do Mercado Pago:\", error);\n            return null;\n        }\n    }\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/services/productService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[366,369],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[366,369],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[773,776],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[773,776],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":101,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3324,3327],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3324,3327],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":115,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":115,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3822,3825],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3822,3825],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":115,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":115,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3836,3839],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3836,3839],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\nimport { Product, Category, Variant } from '../types';\n\n/**\n * Ateli칡 Filhos de Aruanda - Product Service\n * L칩gica de busca de produtos e categorias.\n */\n\nexport const TENANT_HEADER = { 'X-Tenant-ID': 'atelie-aruanda' };\n\n/**\n * Normaliza o objeto de produto da API para campos usados pelo frontend.\n */\nexport const normalizeProduct = (p: any): Product => {\n    if (!p) return p;\n    return {\n        ...p,\n        name: p.title || p.name || '',\n        stockQuantity: p.stock ?? p.stockQuantity ?? 0,\n        categoryId: p.categoryId || (typeof p.category === 'string' ? p.category : p.category?.id) || null,\n        averageRating: p.averageRating ?? null,\n        totalReviews: p.totalReviews ?? 0,\n        variants: (p.variants || []).map((v: any): Variant => ({\n            ...v,\n            stockQuantity: v.stockQuantity ?? v.stock ?? 0,\n        }))\n    };\n};\n\nexport interface ProductFilters {\n    categoryId?: string;\n    category?: string;\n    slug?: string;\n    sort?: string;\n    search?: string;\n    marketplace?: string;\n}\n\nexport const productService = {\n    /**\n     * Busca lista de produtos com filtros opcionais.\n     */\n    getProducts: async (filters: ProductFilters = {}): Promise<Product[]> => {\n        try {\n            const params = new URLSearchParams();\n            if (filters.categoryId) params.append('categoryId', filters.categoryId);\n            if (filters.category) params.append('categoryId', filters.category);\n            if (filters.slug) params.append('slug', filters.slug);\n            if (filters.sort) params.append('sort', filters.sort);\n            if (filters.search) params.append('q', filters.search);\n\n            if (!filters.marketplace) params.append('marketplace', 'LOJA_VIRTUAL');\n            else params.append('marketplace', filters.marketplace);\n\n            const response = await api.get('/products', {\n                params,\n                headers: TENANT_HEADER\n            });\n\n            const raw = response.data?.content || (Array.isArray(response.data) ? response.data : []);\n            return raw.map(normalizeProduct);\n        } catch (error) {\n            console.error(\"[productService] Erro ao buscar produtos:\", error);\n            throw error;\n        }\n    },\n\n    /**\n     * Busca os detalhes de um produto espec칤fico pelo ID.\n     */\n    getProductById: async (id: string): Promise<Product> => {\n        try {\n            const response = await api.get(`/products/${id}`, {\n                headers: TENANT_HEADER\n            });\n            return normalizeProduct(response.data);\n        } catch (error) {\n            console.error(`[productService] Erro ao buscar produto ${id}:`, error);\n            throw error;\n        }\n    },\n\n    /**\n     * Busca todas as categorias dispon칤veis.\n     */\n    getCategories: async (): Promise<Category[]> => {\n        try {\n            const response = await api.get('/categories', {\n                headers: TENANT_HEADER\n            });\n            return Array.isArray(response.data) ? response.data : [];\n        } catch (error) {\n            console.error(\"[productService] Erro ao buscar categorias:\", error);\n            return [];\n        }\n    },\n\n    /**\n     * Busca as avalia칞칫es de um produto espec칤fico.\n     */\n    getReviews: async (productId: string): Promise<any[]> => {\n        try {\n            const response = await api.get(`/reviews/product/${productId}`, {\n                headers: TENANT_HEADER\n            });\n            return Array.isArray(response.data) ? response.data : [];\n        } catch (error) {\n            console.error(`[productService] Erro ao buscar reviews do produto ${productId}:`, error);\n            return [];\n        }\n    },\n    /**\n     * Cria uma nova avalia칞칚o para um produto.\n     */\n    createReview: async (reviewData: any): Promise<any> => {\n        try {\n            const response = await api.post('/reviews', reviewData, {\n                headers: TENANT_HEADER\n            });\n            return response.data;\n        } catch (error) {\n            console.error(\"[productService] Erro ao criar review:\", error);\n            throw error;\n        }\n    }\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/services/subscriptionService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[669,672],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[669,672],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[855,858],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[855,858],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1024,1027],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1024,1027],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1193,1196],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1193,1196],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\nimport { SubscriptionPlan, UserSubscription } from '../types';\nimport { TENANT_HEADER } from './productService';\n\nconst subscriptionService = {\n    getPlans: (): Promise<SubscriptionPlan[]> =>\n        api.get('/subscription-plans', { headers: TENANT_HEADER }).then(r => r.data),\n\n    getPlan: (id: string): Promise<SubscriptionPlan> =>\n        api.get(`/subscription-plans/${id}`, { headers: TENANT_HEADER }).then(r => r.data),\n\n    getUserSubscriptions: (userId: string): Promise<UserSubscription[]> =>\n        api.get(`/subscriptions/my?userId=${userId}`, { headers: TENANT_HEADER }).then(r => r.data),\n\n    subscribe: (userId: string, data: any): Promise<UserSubscription> =>\n        api.post(`/subscriptions?userId=${userId}`, data, { headers: TENANT_HEADER }).then(r => r.data),\n\n    pauseSubscription: (id: string): Promise<any> =>\n        api.patch(`/subscriptions/${id}/status?status=PAUSED`, {}, { headers: TENANT_HEADER }).then(r => r.data),\n\n    resumeSubscription: (id: string): Promise<any> =>\n        api.patch(`/subscriptions/${id}/status?status=ACTIVE`, {}, { headers: TENANT_HEADER }).then(r => r.data),\n\n    cancelSubscription: (id: string): Promise<any> =>\n        api.patch(`/subscriptions/${id}/status?status=CANCELLED`, {}, { headers: TENANT_HEADER }).then(r => r.data),\n};\n\nexport default subscriptionService;\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/setupTests.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/test-utils.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Move your component(s) to a separate file.","line":8,"column":7,"nodeType":"Identifier","messageId":"localComponents","endLine":8,"endColumn":22},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"This rule can't verify that `export *` only exports components.","line":23,"column":1,"nodeType":"ExportAllDeclaration","messageId":"exportAll","endLine":23,"endColumn":40}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { ReactElement } from 'react';\nimport { render, RenderOptions } from '@testing-library/react';\nimport { BrowserRouter } from 'react-router-dom';\nimport { HelmetProvider } from 'react-helmet-async';\n// Mock AuthContext if needed or import real one if logic is simple\n// For now, we'll wrap with basic providers\n\nconst AllTheProviders = ({ children }: { children: React.ReactNode }) => {\n    return (\n        <HelmetProvider>\n            <BrowserRouter>\n                {children}\n            </BrowserRouter>\n        </HelmetProvider>\n    );\n};\n\nconst customRender = (\n    ui: ReactElement,\n    options?: Omit<RenderOptions, 'wrapper'>,\n) => render(ui, { wrapper: AllTheProviders, ...options });\n\nexport * from '@testing-library/react';\nexport { customRender as render };\n","usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/types/address.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/types/auth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/types/cart.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/types/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/types/marketing.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/types/order.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/types/payment.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/types/product.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/types/subscription.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/utils/cn.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/utils/fiscal.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/utils/imageUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/utils/nsfwModerator.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/imdias/workspace/AtelieFilhosDeAruanda-/frontend/src/vite-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
