Manual de Prontid√£o para Produ√ß√£o: Ateli√™ Filhos de Aruanda
Data: 05/02/2026 Respons√°vel: Antigravity AI Vers√£o: 1.0 (Pr√©-Produ√ß√£o)

1. Resumo Executivo
O sistema encontra-se est√°vel para a primeira fase de produ√ß√£o. Todas as funcionalidades cr√≠ticas (cat√°logo, checkout, autentica√ß√£o) foram testadas.

Status de Seguran√ßa: üü¢ Seguro Status de M√≠dia: üü° Armazenamento em Disco (Requer volume persistente) Status de Configura√ß√£o: üü¢ Flex√≠vel (JSONB)

2. Funcionalidades do Projeto
O backend oferece uma API REST completa para operar a loja:

Cat√°logo de Produtos
Listagem p√∫blica com filtros (/api/products).
Detalhes d e produto e variantes (/api/products/{id}).
Categorias (/api/categories).
Checkout e Pedidos
Carrinho de compras (gerenciado no front, finalizado no back).
Cria√ß√£o de pedidos com itens, frete e m√©todo de pagamento.
Hist√≥rico de pedidos (Admin).
Agendador de Carrinho Abandonado (recupera√ß√£o de vendas).
Gest√£o de Estoque
Controle autom√°tico de saldo ao criar pedido.
Ajuste manual e movimenta√ß√µes (/api/inventory).
Autentica√ß√£o e Seguran√ßa
Login e Registro de usu√°rios (/api/auth).
Prote√ß√£o via JWT (JSON Web Tokens).
Perfis de acesso (USER / ADMIN).
Integra√ß√µes e Webhooks
Callbacks de pagamento (Mercado Pago).
C√°lculo de frete din√¢mico.
3. Verifica√ß√£o de M√≠dia (Imagens e V√≠deos)
Pergunta: "√â estritamente essencial a confirma√ß√£o de que o db est√° suportando salvamento de imagens e v√≠deos?"

Resposta T√©cnica: O banco de dados (H2/PostgreSQL) N√ÉO armazena o arquivo bin√°rio da imagem/v√≠deo. Ele armazena apenas metadados (nome, tipo, tamanho, quem enviou).

Os arquivos f√≠sicos s√£o salvos no Sistema de Arquivos do Servidor (Disco).

C√≥digo: MediaStorageService.storeImage usa Files.copy(inputStream, target).
Local: Definido pela vari√°vel de ambiente UPLOAD_DIR.
‚ö†Ô∏è Aten√ß√£o para Produ√ß√£o (Docker): Para que as imagens n√£o sumam ao reiniciar o container, voc√™ DEVE configurar um volume no 
docker-compose.yml
:

yaml
volumes:
  - ./uploads_data:/app/uploads
E configurar a vari√°vel: UPLOAD_DIR=/app/uploads

Se essa configura√ß√£o for feita, o sistema suporta perfeitamente o salvamento de milhares de imagens e v√≠deos, limitado apenas pelo espa√ßo em disco do servidor, o que √© mais eficiente do que salvar no banco de dados.

4. Guia de Configura√ß√£o (Frete e Pagamento)
O sistema utiliza uma arquitetura moderna de Configura√ß√£o Din√¢mica (JSONB). Isso significa que voc√™ n√£o precisa alterar c√≥digo para mudar as chaves de API; basta enviar um JSON para o endpoint de administra√ß√£o.

Endpoint de Configura√ß√£o
POST /api/admin/provider-configs Auth: Requer Token JWT de Admin.

Exemplo: Configurar Pagamento (Mercado Pago)
Para configurar as credenciais do Mercado Pago, envie o seguinte JSON:

json
{
  "providerId": "uuid-do-mercado-pago", 
  "configJson": "{\"publicKey\": \"PUB_KEY_123\", \"accessToken\": \"ACCESS_TOKEN_ABC\"}",
  "environment": "PRODUCTION",
  "version": 1
}
Onde pegar as chaves: No painel de desenvolvedor do Mercado Pago.
Provider ID: Consulte na tabela service_providers (busque onde code = MERCADO_PAGO).
Exemplo: Configurar Frete (Melhor Envio / Correios)
Para configurar, o processo √© o mesmo. O conte√∫do do configJson depende do provedor espec√≠fico (ex: Token de API, CEP de origem).

json
{
  "providerId": "uuid-do-melhor-envio",
  "configJson": "{\"apiToken\": \"SEU_TOKEN_AQUI\", \"originCep\": \"01001-000\"}",
  "environment": "PRODUCTION"
}
5. Auditoria de Seguran√ßa (Brechas e Corre√ß√µes)
Realizei uma varredura minuciosa no c√≥digo e configura√ß√µes:

‚úÖ Pontos Fortes (Seguro)
JWT Stateless: N√£o usamos sess√µes no servidor, o que protege contra ataques de sequestro de sess√£o comuns.
CORS Restrito: A configura√ß√£o de 
SecurityConfig
 permite definir origens (ex: https://sualoja.com.br) via vari√°vel de ambiente, bloqueando sites maliciosos.
Senhas: Todas as senhas s√£o hashadas com BCrypt antes de salvar (PasswordEncoder).
Tratamento de Erro: O 
GlobalExceptionHandler
 agora trata BadCredentialsException, evitando vazar stacktraces de erro 500 no login incorreto.
‚ö†Ô∏è Pontos de Aten√ß√£o (A√ß√µes Recomendadas)
Chaves de API em Vari√°veis:
Evite commitar chaves como JWT_SECRET no Git. Em produ√ß√£o, injete-as via 
.env
 ou gerenciador de segredos da nuvem.
HTTPS (SSL):
O backend fala HTTP. O HTTPS deve ser provido pelo Load Balancer (Nginx/Cloudflare) na frente do container Docker. O backend n√£o faz termina√ß√£o SSL nativa.
Limita√ß√£o de Tamanho de Upload:
O sistema respeita MAX_UPLOAD_MB. Certifique-se de configurar esse valor (ex: 10) para evitar ataques de DoS com arquivos gigantes.
Conclus√£o: O sistema est√° pronto tecnicamente. A seguran√ßa depende agora da "higiene" das credenciais (n√£o vazar 
.env
) e da configura√ß√£o correta do servidor (Firewall/HTTPS).
